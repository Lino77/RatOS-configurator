"use strict";exports.id=3762,exports.ids=[3762],exports.modules={43299:(e,r,t)=>{t.d(r,{DN:()=>g,NI:()=>f});var a=t(32322),n=t.n(a),i=t(86896),s=t.n(i),o=t(53217),l=t(33496),u=t.n(l),c=t(32228),d=t.n(c);let m={darkMode:"class",content:["./pages/**/*.{js,ts,jsx,tsx}","./components/**/*.{js,ts,jsx,tsx}","./helpers/**/*.{js,ts,jsx,tsx}","./app/**/*.{js,ts,jsx,tsx}"],theme:{container:{center:!0,padding:"2rem",screens:{"2xl":"1400px"}},extend:{fontFamily:{sans:["var(--inter-font)",...s().fontFamily.sans]},keyframes:{ping:{"0%":{opacity:"100"},"75%, 100%":{transform:"scale(2)",opacity:"0"}},"accordion-down":{from:{height:"0"},to:{height:"var(--radix-accordion-content-height)"}},"accordion-up":{from:{height:"var(--radix-accordion-content-height)"},to:{height:"0"}}},animation:{"spin-fast":"spin 0.5s linear infinite","accordion-down":"accordion-down 0.2s ease-out","accordion-up":"accordion-up 0.2s ease-out"},colors:{brand:{50:"#f2ffe1",100:"#deffcc",200:"#bdff99",300:"#9cff66",400:"#7bff33",500:"#5aff00",600:"#48cc00",700:"#369900",800:"#246600",900:"#123300"},border:"hsl(var(--border))",input:"hsl(var(--input))",ring:"hsl(var(--ring))",background:"hsl(var(--background))",foreground:"hsl(var(--foreground))",primary:{DEFAULT:"hsl(var(--brand-400) / 50%)",foreground:"hsl(var(--white))"},secondary:{DEFAULT:"hsl(var(--secondary))",foreground:"hsl(var(--white))"},destructive:{DEFAULT:"hsl(var(--red-400))",foreground:"hsl(var(--black))"},muted:{DEFAULT:"hsl(var(--muted))",foreground:"hsl(var(--muted-foreground))"},accent:{DEFAULT:"hsl(var(--accent))",foreground:"hsl(var(--white))"},popover:{DEFAULT:"hsl(var(--popover))",foreground:"hsl(var(--popover-foreground))"},card:{DEFAULT:"hsl(var(--card))",foreground:"hsl(var(--card-foreground))"}},borderRadius:{lg:"var(--radius)",md:"calc(var(--radius) - 2px)",sm:"calc(var(--radius) - 4px)"},fontSize:{"2xs":"0.6rem",s:"0.8125rem"},containers:{"screen-sm":"640px","screen-md":"768px","screen-lg":"1024px","screen-xl":"1280px","screen-2xl":"1536px"}}},plugins:[t(56833),t(55827),t(74013),t(30185)({nocompatible:!0}),function({addBase:e,theme:r}){e({":root":Object.fromEntries(Object.entries((0,o.default)(r("colors"))).map(([e,r])=>{let t=u().hex.hsl(r);return[`--${e}`,r.startsWith("#")?`${t[0]} ${t[1]}% ${t[2]}%`:r]}))})},function({matchUtilities:e,theme:r}){e({"bg-grid":e=>({backgroundImage:`url("${d()(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="${e}"><path d="M0 .5H31.5V32"/></svg>`)}")`}),"bg-grid-small":e=>({backgroundImage:`url("${d()(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="8" height="8" fill="none" stroke="${e}"><path d="M0 .5H31.5V32"/></svg>`)}")`}),"bg-dot":e=>({backgroundImage:`url("${d()(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"><circle fill="${e}" id="pattern-circle" cx="10" cy="10" r="1.6257413380501518"></circle></svg>`)}")`})},{values:(0,o.default)(r("backgroundColor")),type:"color"})}]},p=n()(m),f=p.theme.colors,g=Object.fromEntries(Object.keys(f).filter(e=>{let r=f[e];return null!=r&&"string"!=typeof r&&!("DEFAULT"in r)}).map(e=>[e,f[e]]))},26685:(e,r,t)=>{t.d(r,{b:()=>ChartTheme});var a=t(21374);let ChartTheme=class ChartTheme extends a.SciChartJSDarkv2Theme{constructor(){super(),this.sciChartBackground="transparent",this.loadingAnimationBackground="transparent",this.axisBandsFill="#20212333",this.majorGridLineBrush="#AAAAAA37",this.minorGridLineBrush="#77777719",this.strokePalette=["#F48420","#AE408E","#209FD9","#264B93"],this.fillPalette=["#F4842077","#AE408E77","#209FD977","#264B9377"],this.isLightBackground=!1}}},36849:(e,r,t)=>{t.d(r,{GB:()=>x,QR:()=>useADXLSignalChart,ZA:()=>usePSDChart,as:()=>h,ck:()=>g,to:()=>getPSDTooltipLegendTemplate,wx:()=>c});var a=t(21374),n=t(62657),i=t(26685),s=t(61515),o=t.n(s),l=t(43299),u=t(3966);let c=128;a.SciChartSurface.configure({wasmUrl:"/configure/scichart2d.wasm",dataUrl:"/configure/scichart2d.data"}),a.SciChartSurface.UseCommunityLicense();let d=new i.b,m="signal",p="history",f="amplitude",getAxisColorName=e=>{switch(e){case"x":return"yellow";case"y":return"sky";case"z":return"rose";default:return"brand"}},getAxisColor=e=>l.NI[getAxisColorName(e)];new a.NumberRange(-1e4,1e4);let useADXLSignalChart=e=>(0,n.Q8)(null,(0,u.useCallback)(r=>{let t=getAxisColor(e),n=new a.CategoryAxis(r.webAssemblyContext2D,{id:m+e,autoRange:a.EAutoRange.Always,maxAutoTicks:c,drawLabels:!1,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,drawMinorGridLines:!1,drawMajorGridLines:!1});r.xAxes.add(n);let i=new a.CategoryAxis(r.webAssemblyContext2D,{id:p+e,autoRange:a.EAutoRange.Always,drawLabels:!1,drawMinorGridLines:!1,drawMajorTickLines:!1});r.xAxes.add(i);let s=new a.NumericAxis(r.webAssemblyContext2D,{autoRange:a.EAutoRange.Never,visibleRange:new a.NumberRange(-1e3,1e3),drawLabels:!1,id:f+e,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,drawMinorGridLines:!1,drawMajorGridLines:!1,axisAlignment:a.EAxisAlignment.Left});r.yAxes.add(s);let o=new a.XyDataSeries(r.webAssemblyContext2D,{fifoCapacity:c,containsNaN:!1,isSorted:!0,dataSeriesName:e.toLocaleUpperCase(),dataIsSortedInX:!0,xValues:Array(c).fill(0).map((e,r)=>r),yValues:Array(c).fill(0)}),l=new a.FastLineRenderableSeries(r.webAssemblyContext2D,{xAxisId:m+e,yAxisId:f+e,stroke:t[400],strokeThickness:2,dataSeries:o,effect:new a.GlowEffect(r.webAssemblyContext2D,{intensity:1,range:1})});r.renderableSeries.add(l);let u=new a.XyDataSeries(r.webAssemblyContext2D,{fifoCapacity:200*c,containsNaN:!1,isSorted:!0,dataSeriesName:e.toLocaleUpperCase()+" History",dataIsSortedInX:!0,xValues:Array(200*c).fill(0).map((e,r)=>r),yValues:Array(200*c).fill(0)}),d=new a.FastLineRenderableSeries(r.webAssemblyContext2D,{stroke:t[500]+"22",strokeThickness:1,opacity:.6,yAxisId:f+e,xAxisId:p+e,dataSeries:u});return r.renderableSeries.add(d),l.animation=new a.WaveAnimation({duration:500}),d.animation=new a.WaveAnimation({duration:500}),{signalData:o,signalSeries:l,historyData:u,historySeries:d,xAxis:n,xHistoryAxis:i,yAxis:s}},[e])),g="amplitude",h=new a.NumberRange(0,1500),x={surface:{theme:d,padding:a.Thickness.fromNumber(0)},xAxes:[{type:a.EAxisType.NumericAxis,options:{visibleRange:new a.NumberRange(0,200),labelStyle:{...o().style,fontSize:13,fontWeight:"600",padding:new a.Thickness(15,15,15,15)},labelPostfix:"Hz",drawMinorGridLines:!0,minorsPerMajor:10,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1}}],yAxes:[{type:a.EAxisType.NumericAxis,options:{id:g,axisAlignment:a.EAxisAlignment.Left,growBy:new a.NumberRange(0,.1),visibleRange:h,labelFormat:a.ENumericFormat.Exponential,labelStyle:{...o().style,fontSize:13,fontWeight:"600",padding:new a.Thickness(15,15,15,15)},autoRangeAnimation:{duration:140,animateInitialRanging:!1,animateSubsequentRanging:!0,easing:a.easing.inOutCubic},drawMinorGridLines:!0,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,axisTitleStyle:{fontSize:10}}}]},y={...x,series:[{type:a.ESeriesType.MountainSeries,options:{id:"total",yAxisId:g,strokeThickness:3,fill:l.NI.brand[500]+"22",stroke:l.NI.brand[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(131).fill(0).map((e,r)=>Math.floor(r/131*200)),yValues:Array(131).fill(0).map((e,r)=>0)}},{type:a.ESeriesType.LineSeries,options:{id:"z",yAxisId:g,strokeThickness:3,stroke:getAxisColor("z")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(131).fill(0).map((e,r)=>Math.floor(r/131*200)),yValues:Array(131).fill(0).map((e,r)=>0)}},{type:a.ESeriesType.LineSeries,options:{id:"y",yAxisId:g,strokeThickness:3,stroke:getAxisColor("y")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(131).fill(0).map((e,r)=>Math.floor(r/131*200)),yValues:Array(131).fill(0).map((e,r)=>0)}},{type:a.ESeriesType.LineSeries,options:{id:"x",yAxisId:g,strokeThickness:3,stroke:getAxisColor("x")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(131).fill(0).map((e,r)=>Math.floor(r/131*200)),yValues:Array(131).fill(0).map((e,r)=>0)}}]},getPSDTooltipLegendTemplate=(e,r)=>{let t="",n=32,i=[];e.forEach((e,r)=>{let s=e.renderableSeries.rolloverModifierProps.tooltipColor;if(i.push(`${e.renderableSeries.rolloverModifierProps.tooltipTitle}: ${(e.yValue/1e3).toFixed(2)} g^2/Hz @ ${e.formattedXValue}`),t+=`<text x="16" y="${n}" class="text-sm text-medium font-sans" fill="${l.DN[s][400]}">
		<tspan class="font-bold">${e.renderableSeries.rolloverModifierProps.tooltipTitle}</tspan>: ${(e.yValue/1e3).toFixed(2)} g<tspan y="${n-4}" class="sup">2</tspan><tspan y=${n}>/Hz</tspan>@ ${e.formattedXValue}
		</text>`,n+=20,e.dataSeriesType===a.EDataSeriesType.Xyy){let r=e.renderableSeries.rolloverModifierProps1.tooltipColor;i.push(`${e.renderableSeries.rolloverModifierProps1.tooltipTitle}: ${(e.y1Value/1e3).toFixed(2)} g^2/Hz @ ${e.formattedXValue}`),t+=`<text x="16" y="${n}" class="text-sm text-medium font-sans" fill="${l.DN[r][400]}">
				<tspan class="font-bold">${e.renderableSeries.rolloverModifierProps1.tooltipTitle}</tspan>: ${(e.y1Value/1e3).toFixed(2)} g<tspan y="${n-4}" class="sup">2</tspan><tspan y=${n}>/Hz</tspan> @ ${e.formattedXValue}
			</text>`,n+=20,t+=`<text x="16" y="${n}" class="text-sm text-medium font-sans" fill="${l.DN.zinc[400]}">
				<tspan class="font-bold">Amplitude Difference</tspan>: ${Math.abs((e.y1Value-e.yValue)/1e3).toFixed(2)} g<tspan y="${n-4}" class="sup">2</tspan><tspan y=${n}>/Hz</tspan>
			</text>`,n+=20}});let s=0===e.length?0:16+1.7*calcTooltipWidth(i.reduce(function(e,r){return r.length>e?r.length:e},0)),o=0===e.length?0:n;return`<svg width="${s}" height="${o}">
				<rect rx="8" ry="8" width="100%" height="100%" class="stroke-zinc-400/10 fill-zinc-900/70 stroke-1" />
                ${t}
            </svg>`},psdRolloverTooltipTemplate=(e,r,t)=>{let n="",i=t.tooltipProps,s=i.tooltipTitle,o=i.tooltipColor,u=l.NI[o][100],c=(0,a.parseColorToTArgb)(l.NI[o][400]),d=(0,a.parseColorToTArgb)(l.NI[o][600]),m=i.tooltipLabelX,p=i.tooltipLabelY,f=l.NI[o][900];c.opacity=Math.round(204),d.opacity=Math.round(51);let g=t.tooltipProps.tooltipDataTemplate??t.tooltipProps.rolloverModifier.tooltipDataTemplate,h=g(r,s,m,p),x=i.width??calcTooltipWidth(h.reduce(function(e,r){return r.length>e?r.length:e},0)),y=i.height??calcTooltipHeight(h.length);t.updateSize(x,y),h.forEach(function(e,r){n+=`<tspan x="8" dy="1.2em">${e}</tspan>`});let w='<feGaussianBlur result="blurOut" in="offOut" stdDeviation="3" />';if(void 0!==f){var b=(0,a.parseColorToTArgb)(f);w=`
			<feColorMatrix result="matrixOut" in="offOut" type="matrix"
				values="0 0 0 0 
				${b.red/255}
				0 0 0 0
				${b.green/255}
				0 0 0 0
				${b.blue/255}
				0 0 0 
				${b.opacity/255}
				0 0" 
			/>
			<feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="3" />`}return`
		<svg class="scichart__rollover-tooltip transition-all" width="${x}" height="${y}">
			<defs>
				<filter id="${e}" x="0" y="0" width="200%" height="200%">
					<feOffset result="offOut" in="SourceAlpha" dx="3" dy="3" />
						
						${w}
					<feBlend in="SourceGraphic" in2="blurOut" mode="normal" />
				</filter>
			</defs>
			<rect rx="8" ry="8" width="100%" height="100%" fill="${(0,a.parseTArgbToHtmlColor)(d)}" stroke="${(0,a.parseTArgbToHtmlColor)(c)}" stroke-width="2"  filter="url(#${e}" />
			<svg width="100%">
				<text x="8" y="3" class="text-sm font-sans font-semibold" dy="0" fill="${u}">
				${n}
				</text>
			</svg>
		</svg>`},getTooltipDataTemplate=(e,r,t,a)=>{let n=[];return n.push(r),n.push(`<tspan class="opacity-70 font-medium">${e.formattedYValue} @ ${e.formattedXValue}</tspan>`),n},usePSDChart=()=>(0,n.Q8)(y,(0,u.useCallback)(e=>{let r=new a.XyDataSeries(e.webAssemblyContext2D,{id:"xAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(r);let t=new a.XyDataSeries(e.webAssemblyContext2D,{id:"yAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(t);let n=new a.XyDataSeries(e.webAssemblyContext2D,{id:"zAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(n);let i=new a.XyDataSeries(e.webAssemblyContext2D,{id:"totalAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});return e.addDeletable(i),e.renderableSeries.asArray().forEach(r=>{"total"===r.id&&(r.paletteProvider=a.PaletteFactory.createGradient(e.webAssemblyContext2D,new a.GradientParams(new a.Point(0,0),new a.Point(1,1),[{offset:0,color:l.NI.brand[400]},{offset:.8,color:l.NI.brand[600]}]),{enableStroke:!0,enableFill:!0,fillOpacity:.17,pointMarkerOpacity:.5})),r.rolloverModifierProps.tooltipColor=getAxisColorName(r.id),r.rolloverModifierProps.tooltipTemplate=psdRolloverTooltipTemplate,r.rolloverModifierProps.tooltipTitle=r.id.substring(0,1).toUpperCase()+r.id.substring(1)+" Power Spectral Density",r.animation=new a.WaveAnimation({duration:500})}),e.chartModifiers.add(new a.RolloverModifier({showRolloverLine:!0,showTooltip:!1,yAxisId:g,tooltipDataTemplate:getTooltipDataTemplate})),e.chartModifiers.add(new a.CursorModifier({crosshairStroke:l.NI.sky[400],crosshairStrokeThickness:1,showXLine:!0,showYLine:!0,showTooltip:!1,yAxisId:g,axisLabelFill:l.NI.zinc[900],axisLabelStroke:l.NI.zinc[100]})),{animationSeries:{x:r,y:t,z:n,total:i}}},[]));var calcTooltipWidth=function(e=20,r=4){return e*r+20},calcTooltipHeight=function(e=2,r=15){return r*e+16}},62657:(e,r,t)=>{t.d(r,{Dv:()=>useADXLFifoTensor,Gs:()=>useBufferedPSD,O3:()=>useBufferedADXLSignal,Q8:()=>useChart,Tv:()=>useDynamicAxisRange,ag:()=>useAccumulatedPSD,kP:()=>useTicker,ko:()=>useRealtimeADXL});var a=t(28793),n=t(45184),i=t(24874),s=t(3966),o=t(18835),l=t(46557),u=t(21374),c=t(5408),d=t(21827),m=t(36849),p=t(26685),f=t(38143),g=t(57748),h=t(71315),x=t(68455);let getWsURL=()=>{let e=(0,i.X)();return null==e||e.trim(),null},y=0,isSuccessResponse=e=>!("error"in e),useRealtimeADXL=e=>{let[r,t]=(0,s.useState)(getWsURL()),a=(0,s.useRef)({}),i=(0,s.useRef)({}),[u,c]=(0,s.useState)(!1),{onSubscriptionFailure:d,onDataUpdate:m,sensor:p,enabled:g,onSubscriptionSuccess:h}=e,w=(0,s.useRef)(u);w.current=u;let b=(0,l.n)();(0,s.useEffect)(()=>{t(getWsURL())},[]);let{lastJsonMessage:A,sendJsonMessage:S,readyState:T}=(0,n.ZP)(!1===g?null:r,{shouldReconnect:e=>!0,onMessage:e=>{if(m&&w.current)try{let r=JSON.parse(e.data);if(isSuccessResponse(r)&&null!=r.params&&"data"in r.params){let e=f.o5.parse(r.params);m?.(e)}else isSuccessResponse(r)||(0,o.j)().error("Error in response from klipper socket",r)}catch(r){console.warn("OnMessage: Failed to parse message",r,e.data)}},reconnectAttempts:1/0,reconnectInterval:3e3,share:!1}),R=(0,s.useCallback)(async()=>{let e=++y;return new Promise((r,t)=>{a.current[e]=(e,a)=>e?t(e):a&&"object"==typeof a&&"error"in a&&a.error?t(a.error):null==a?t(Error("No result. Unknown response format.")):void r(a),i.current[e]=window.setTimeout(()=>{a.current[e]?.(Error("Request timed out"),null),delete a.current[e],delete i.current[e]},1e4),S({jsonrpc:"2.0",method:"adxl345/dump_adxl345",params:{sensor:p,response_template:{}},id:e})})},[p,S]);return(0,s.useEffect)(()=>{1!==T||"ready"!==b||w.current?w.current&&c(!1):R().then(e=>{let r=f.NI.parse(e);(0,o.j)().info(r,"Subscribed to ADXL345"),c(!0),h?.(r.header)}).catch(e=>{(0,o.j)().error(e),c(!1),d?d(e):x.A.error("Failed to start accelerometer stream",{description:e.message})})},[b,T,R,d,h]),(0,s.useEffect)(()=>{A?.id&&a.current[A.id]&&(window.clearTimeout(i.current[A.id]),isSuccessResponse(A)?a.current[A.id](null,A.result):a.current[A.id](Error(A.error.message),null),delete i.current[A.id],delete a.current[A.id])},[A]),(0,s.useEffect)(()=>()=>{for(let e in w.current=!1,i.current)delete i.current[e],delete a.current[e]},[]),{isSubscribed:u}},w=new p.b,useChart=(e,r,t=!0)=>{let n=(0,s.useRef)(null),[i,o]=(0,s.useState)(!1),l=(0,s.useRef)(null);return(0,s.useMemo)(()=>({forwardProps:{initChart:async a=>{let i=null;if(null!=e){let r=e.surface?.padding,n={...e,surface:{...e.surface,padding:new u.Thickness(r?.top??0,r?.right??0,r?.bottom??0,(r?.left??0)+(t?300:0))}};i=await (0,u.build2DChart)(a,n)}else i=await u.SciChartSurface.create(a,{theme:w,padding:new u.Thickness(0,0,0,t?300:0)});return i.sciChartSurface.watermarkPosition=u.EWatermarkPosition.BottomLeft,i.sciChartSurface.watermarkRelativeToCanvas=!0,n.current=i.sciChartSurface,r&&(l.current=r(i.sciChartSurface)),{sciChartSurface:i.sciChartSurface}},onInit:()=>o(!0),style:{marginLeft:t?-300:0},fallback:a.jsx(h.I,{className:(0,g.d)(t&&"ml-[150px]","bg-zinc-900")})},surface:n,isInitialized:i,data:l}),[t,i,e,r])},b=["time","x_acceleration","y_acceleration","z_acceleration"],useADXLFifoTensor=(e=b,r=8192)=>{let t=(0,s.useRef)(null),a=(0,s.useRef)(0),[n,i]=(0,s.useState)(0),o=(0,s.useCallback)(e=>{if(null==t.current)return null;let r=Math.min(e,t.current.shape[0]),[a,n]=(0,c.Vl2)(t.current,[r,t.current.shape[0]-r],0);return t.current.dispose(),t.current=n,a},[]),l=(0,s.useMemo)(()=>[e.findIndex(e=>e.startsWith("time")),e.findIndex(e=>e.startsWith("x_acceleration")),e.findIndex(e=>e.startsWith("y_acceleration")),e.findIndex(e=>e.startsWith("z_acceleration"))],[e]),u=(0,s.useCallback)(e=>{let n=(0,c.Iqj)(e.data,l,1),s=t.current?(0,c.Izb)([t.current,n],0):n;if(s!==n&&n.dispose(),t.current?.dispose(),t.current=s,a.current=e.data.length/(e.data[e.data.length-1][0]-e.data[0][0]),t.current.shape[0]>r){console.debug("Fifo capacity exceeded, dropping frames",t.current.shape[0]);let e=t.current.shape[0]-r;o(e)?.dispose(),i(r=>r+e)}},[l,r,o]);return(0,s.useEffect)(()=>()=>{t.current?.dispose(),t.current=null},[]),{onData:u,take:o,buffer:t,dropped:n,sampleRate:a}},useBufferedADXLSignal=(e,r)=>{let t=(0,s.useRef)(new Date().getTime()),a=(0,s.useRef)(r);a.current=r;let n=(0,s.useCallback)(async()=>{if(new Date().getTime(),t.current,null==e.buffer.current||e.buffer.current.shape[0]<m.wx/2)return;let r=m.wx/2;e.buffer.current.shape[0]>12*m.wx&&(r+=m.wx);let n=e.take(r);if(null==n)return;let[i,s,o,l]=(0,c.Vl2)(n,4,1);a.current?.(c.XLQ(i,[i.shape[0]]),c.XLQ(s,[s.shape[0]]),c.XLQ(o,[o.shape[0]]),c.XLQ(l,[l.shape[0]])),i.dispose(),n.dispose(),s.dispose(),o.dispose(),l.dispose()},[e]);return n},useBufferedPSD=(e,r)=>{let t=(0,s.useRef)((0,c.RRF)([])),a=(0,s.useRef)((0,c.RRF)([])),n=(0,s.useRef)((0,c.RRF)([])),i=(0,s.useRef)(r);i.current=r;let o=(0,s.useCallback)(async(r,s,o,l,u)=>{let m=e.current,p=(0,c.zoF)([s,t.current]),f=(0,c.zoF)([o,a.current]),g=(0,c.zoF)([l,n.current]);if(s.dispose(),o.dispose(),l.dispose(),r.dispose(),t.current.dispose(),a.current.dispose(),n.current.dispose(),t.current=p,a.current=f,n.current=g,t.current.shape[0]>m){let e=t.current.clone(),r=a.current.clone(),s=n.current.clone(),o=(0,c.QBD)([e,r,s]);t.current.dispose(),a.current.dispose(),n.current.dispose(),t.current=(0,c.RRF)([]),a.current=(0,c.RRF)([]),n.current=(0,c.RRF)([]);let[l,p,f]=await Promise.all([(0,d.i2)(e,m,{isDetrended:u}),(0,d.i2)(r,m,{isDetrended:u}),(0,d.i2)(s,m,{isDetrended:u})]),g=(0,d.L)([l,p,f]);e.dispose(),r.dispose(),s.dispose(),o.dispose(),i.current?.(l,p,f,g)}},[e]);return o},useAccumulatedPSD=e=>{let[r,t]=(0,s.useState)(!1),a=(0,s.useRef)({x:[],y:[],z:[],total:[]}),n=(0,s.useRef)(e);n.current=e;let i=(0,s.useCallback)(async()=>{a.current={x:[],y:[],z:[],total:[]},t(!0)},[]),o=(0,s.useCallback)(async()=>{let e=a.current,[r,n,i,s]=await Promise.all([(0,d.r5)(e.x),(0,d.r5)(e.y),(0,d.r5)(e.z),(0,d.r5)(e.total)]);return a.current={x:[],y:[],z:[],total:[]},t(!1),{x:r,y:n,z:i,total:s,source:e}},[]),l=(0,s.useCallback)(async(e,t,i,s)=>{if(!r){let r={x:e,y:t,z:i,total:s,source:{x:[e],y:[t],z:[i],total:[s]}};return n.current?.(r),r}a.current.x.push(e),a.current.y.push(t),a.current.z.push(i),a.current.total.push(s);let[o,l,u,c]=await Promise.all([(0,d.r5)(a.current.x),(0,d.r5)(a.current.y),(0,d.r5)(a.current.z),(0,d.r5)(a.current.total)]),m={x:o,y:l,z:u,total:c,source:a.current};return n.current?.(m),m},[r]);return(0,s.useMemo)(()=>({startAccumulation:i,stopAccumulation:o,onData:l,isAccumulating:r}),[r,l,i,o])};function useTicker(e,r){if(null==e)throw Error("Tick function is required");let t=(0,s.useRef)(e);t.current=e;let a=Math.floor(1e3/("function"==typeof e?50:e));(0,s.useEffect)(()=>{let e=0,update=async()=>{await t.current(),e=window.setTimeout(update,a)};return e=window.setTimeout(update,a),()=>{window.clearTimeout(e)}},[a])}let maximumRangeUnion=e=>Array.isArray(e)?e.reduce((e,r)=>{if(null==r)return e;let t=r.getMaximumRange();return e.union(t)},new u.NumberRange):e.getMaximumRange(),visibleRangeUnion=e=>Array.isArray(e)?e.reduce((e,r)=>{if(null==r)return e;let t=r.visibleRange;return e.union(t)},new u.NumberRange):e.visibleRange,growByUnion=e=>Array.isArray(e)?e.reduce((e,r)=>{if(null==r)return e;let t=r.growBy??new u.NumberRange;return e.union(t)},new u.NumberRange):e.growBy;function useDynamicAxisRange(e,r=new u.NumberRange(0,0)){let t=(0,s.useRef)(e?maximumRangeUnion(e):null),a=(0,s.useRef)(new Date().getTime()),n=(0,s.useRef)(new Date().getTime()),i=(0,s.useCallback)((i=r)=>{if(null==e)return;let s=Array.isArray(e)?e:[e];null==t.current&&(t.current=visibleRangeUnion(e));let o=new Date().getTime()-a.current,l=new Date().getTime()-n.current;a.current=new Date().getTime();let c=maximumRangeUnion(e);i&&(c=c.union(i));let d=growByUnion(e);d&&c.growBy(d);let m=null,p=null;if(c.max>t.current.max&&(m=c.max),c.min<t.current.min&&(p=c.min),null!=m||null!=p){s.forEach(e=>{null!=t.current&&null!=e&&e.animateVisibleRange(new u.NumberRange(Math.min(p??t.current.min,r.min),Math.max(m??t.current.max,r.max)),o,u.easing.inOutCirc)}),n.current=new Date().getTime();return}if(l>3*o&&(c.max<t.current.max&&(m=t.current.max-(t.current.max-c.max)),c.min>t.current.min&&(p=t.current.min+(c.min-t.current.min)),null!=m||null!=p)){s.forEach(e=>{null!=t.current&&null!=e&&e.animateVisibleRange(new u.NumberRange(Math.min(p??t.current.min,r.min),Math.max(m??t.current.max,r.max)),o/2,u.easing.inOutCirc)}),n.current=new Date().getTime();return}},[e,r]);return i}},21827:(e,r,t)=>{t.d(r,{L:()=>sumPSDs,i2:()=>powerSpectralDensity,iQ:()=>detrendSignal,r5:()=>welch});var a=t(5408),n=t(21374);let detrendSignal=e=>(0,a.lub)(()=>(0,a.luU)(e,(0,a.J69)(e,0,!0)));async function powerSpectralDensity(e,r,t){let{fftSize:i,_scaling:s}=Object.assign({fftSize:1<<Math.ceil(Math.log2(Math.abs(.5*r-1))),_scaling:"psd"},t);if("psd"!=s&&"none"!=s)throw Error("Unknown scaling");let o="none"===s?1:2,l=a.tdS.hannWindow(i),u=await (0,a.lub)(()=>(0,a.hiC)((0,a.hiC)(1,(0,a.Smz)((0,a.sQ3)(l,2))),r)).array(),c=t?.isDetrended?e:detrendSignal(e),d=a.tdS.stft(c,i,Math.floor(i/2),i,a.tdS.hannWindow),m=await d.array();return d.dispose(),c.dispose(),l.dispose(),welch(m.map(e=>{let t=[],a=[],l=0,c=0;for(var d=0;d<e.length-1;d+=2){let n=(0===d?0:d/2)*(r/i);if(n>200)continue;let m=(d+2)/2*(r/i),p=e[d]**2+e[d+1]**2;p*=u,"psd"==s&&d>0&&m<200&&(p*=o),p>l&&(l=p),p<c&&(c=p),t.push(p),a.push(n)}return{estimates:t,frequencies:a,powerRange:new n.NumberRange(c,l)}}))}let welch=async e=>{if(0==e.length)throw Error("Unable to calculate any PSD estimates");if(1==e.length)return console.warn("Not enough data to compute more than one segment, returning single modified periodogram."),e[0];let r=e[0].estimates.length,t=Array(r).fill(0);for(let a=0;a<e.length;a++)for(let n=0;n<r;n++)t[n]+=e[a].estimates[n];let a=0,i=0;for(let n=0;n<r;n++)t[n]=t[n]/e.length,t[n]>a&&(a=t[n]),t[n]<i&&(i=t[n]);return{estimates:t,frequencies:e[0].frequencies,powerRange:new n.NumberRange(i,a)}},sumPSDs=e=>{let r=e[0].estimates.length,t=Array(r).fill(0);for(let a=0;a<e.length;a++)for(let n=0;n<r;n++)t[n]+=e[a].estimates[n];let{minPower:a,maxPower:i}=e.reduce((e,r)=>(r.powerRange.min<e.minPower&&(e.minPower=r.powerRange.min),r.powerRange.max>e.maxPower&&(e.maxPower=r.powerRange.max),e),{minPower:0,maxPower:0});return{estimates:t,frequencies:e[0].frequencies,powerRange:new n.NumberRange(a,i)}}},38143:(e,r,t)=>{t.d(r,{NI:()=>s,Xz:()=>y,o5:()=>o});var a=t(13728);let n=a.z.union([a.z.literal("toolboard_t0"),a.z.literal("toolboard_t1"),a.z.literal("controlboard"),a.z.literal("rpi")]),i=a.z.union([a.z.literal("time"),a.z.literal("x_acceleration"),a.z.literal("y_acceleration"),a.z.literal("z_acceleration")]),s=a.z.object({header:a.z.tuple([i,i,i,i])}),o=a.z.object({data:a.z.array(a.z.tuple([a.z.number(),a.z.number(),a.z.number(),a.z.number()])),overflows:a.z.number().optional()}),l=a.z.object({frequencies:a.z.array(a.z.number()),estimates:a.z.array(a.z.number()),powerRange:a.z.object({max:a.z.number(),min:a.z.number()})}),u=a.z.object({x:l,y:l,z:l,total:l,source:a.z.object({x:a.z.array(l),y:a.z.array(l),z:a.z.array(l),total:a.z.array(l)})}),c=a.z.string().brand("MacroID"),d=a.z.string().brand("MacroSequenceID"),m=a.z.string().brand("MacroRecordingID"),p=a.z.string().brand("MacroRecordingRunID"),f=a.z.object({capturePSD:a.z.boolean().default(!1),accelerometer:n.optional(),color:a.z.string().optional()}).superRefine((e,r)=>(e.capturePSD&&null==e.accelerometer&&r.addIssue({code:a.z.ZodIssueCode.custom,message:"Required when recording resonance data",path:["accelerometer"]}),e)),g=a.z.object({id:m,macroRecordingRunId:p,macroId:c,sequenceId:d,startTimeStamp:a.z.number(),endTimeStamp:a.z.number(),accelerometer:n,recordingHardwareName:a.z.string(),psd:u,name:a.z.string()});g.extend({psd:u.omit({source:!0})});let h=a.z.object({id:d,name:a.z.string(),recording:f.nullable(),gcode:a.z.string().min(2)}),x=a.z.object({id:c,name:a.z.string(),description:a.z.string(),createdAtTimeStamp:a.z.number(),updatedAtTimeStamp:a.z.number().nullable(),recordingCount:a.z.record(d,a.z.number()),sequences:a.z.array(h)}),y=x.omit({recordingCount:!0,createdAtTimeStamp:!0,updatedAtTimeStamp:!0})}};