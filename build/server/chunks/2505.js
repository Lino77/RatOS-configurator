"use strict";exports.id=2505,exports.ids=[2505],exports.modules={98826:(e,t,o)=>{o.d(t,{Jt:()=>l,uo:()=>xEndstopOptions});var r=o(83908);let xEndstopOptions=(e,t)=>{let o=[];return t?.toolboard!=null&&o.push({id:"endstop-toolboard",title:"Physical Endstop (toolboard)"}),t?.axis===r.po.x&&(o.push({id:"endstop",title:"Physical Endstop"}),o.push({id:"sensorless",title:"Sensorless Homing"})),o},l={id:"endstop",title:"Physical Endstop"}},42505:(e,t,o)=>{o.d(t,{YC:()=>useToolheads,yk:()=>useToolheadConfiguration});var r=o(58307),l=o(50294),n=o(64554),s=o(3966),i=o(5951),d=o(26596),u=o(32327),a=o(98826),h=o(23036);let useToolheads=()=>{let e=(0,n.useRecoilValue)(d.$T),t=(0,s.useMemo)(()=>e?.filter(Boolean).map(e=>new r.D(e)),[e]);return t},useToolheadConfiguration=(e,t=!0)=>{let o=(0,n.useRecoilValue)(d.wm),p=(0,s.useRef)(o);p.current!==o&&o.length>0&&(p.current=o.slice());let f=(0,s.useMemo)(()=>{let o=p.current?.filter(Boolean).map(e=>new r.D(e)),l=o?.find(t=>t.getTool()===e||t.getMotionAxis()===e||t.getExtruderAxis()===e);if(null==l&&t)throw Error(`Toolhead with number or axis ${e} not found`);return l??null},[t,e,p.current]),[c,m]=(0,s.useState)(!1),x=(0,n.useRecoilCallback)(({set:e,snapshot:t})=>async o=>{let n=new r.D(o),s=await t.getPromise((0,d.AF)(n.getTool()));if(null==s)throw Error(`Toolhead ${n.getToolCommand()} not found`);let p=new r.D(s);if(o.extruder.id!=p.getExtruder().id&&null!=o.extruder.stepper){let t=(0,l.WZ)(o.extruder.stepper);null!=t&&e((0,i.ew)(n.getExtruderAxis()),e=>null==e?null:{...e,stepper:t.id,current:o.extruder.current??.71*t.maxPeakCurrent})}if(o.toolboard?.id!==p.getToolboard()?.id){if(null==o.toolboard&&"endstop-toolboard"===o.xEndstop.id&&(o.xEndstop=a.Jt),o.partFan?.id.endsWith("-toolboard")){let e=(0,h.gL)(null,o).shift();if(null==e)throw Error(`No part fan options available for current T${o.toolNumber} configuration`);o.partFan=e}if(o.hotendFan?.id.endsWith("-toolboard")){let e=(0,h.Yo)(null,o).shift();if(null==e)throw Error(`No hotend fan options available for current T${o.toolNumber} configuration`);o.hotendFan=e}}o.thermistor!==p.getThermistor()&&o.thermistor!==o.hotend.thermistor?m(!0):o.hotend.id==p.getHotend().id||c||(o.thermistor=o.hotend.thermistor);let f=u.PY.extend({toolNumber:u.Qr}).nullable().safeParse({...o,toolNumber:p.getTool()});return f.success&&e((0,d.AF)(p.getTool()),f.data),f},[c]);return{toolhead:f,setToolhead:x}}}};