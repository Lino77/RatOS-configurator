(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2345],{65660:function(){},98948:function(e,r,t){"use strict";t.d(r,{j:function(){return getLogger}});var n=t(74958),o=t.n(n),i=t(75061),a=t(10187),l=t(31354);let send=async function(e,r){a.u.clientLog.mutate({level:e,logEvent:l.s.parse(r)})},s=null,getLogger=()=>null!=s?s:s=o()({...i.N,browser:{transmit:{send}}})},39634:function(e,r,t){"use strict";t.d(r,{Bd:function(){return l},Ct:function(){return Badge},_1:function(){return s},iA:function(){return u},xU:function(){return d}});var n=t(72612),o=t(73918),i=t(63278),a=t(94594);let l=a.z.union([a.z.literal("rose"),a.z.literal("red"),a.z.literal("yellow"),a.z.literal("orange"),a.z.literal("green"),a.z.literal("lime"),a.z.literal("blue"),a.z.literal("sky"),a.z.literal("indigo"),a.z.literal("purple"),a.z.literal("pink"),a.z.literal("brand"),a.z.literal("gray"),a.z.literal("plain")]),s=(0,o.j)("",{variants:{color:{rose:"text-rose-700 dark:text-rose-400",red:"text-red-700 dark:text-red-400",yellow:"text-yellow-800 dark:text-yellow-500",orange:"text-orange-800 dark:text-orange-500",green:"text-green-700 dark:text-green-400",lime:"text-lime-700 dark:text-lime-400",blue:"text-blue-700 dark:text-blue-400",sky:"text-sky-700 dark:text-sky-400",indigo:"text-indigo-700 dark:text-indigo-400",purple:"text-purple-700 dark:text-purple-400",pink:"text-pink-700 dark:text-pink-400",brand:"text-brand-700 dark:text-brand-400",gray:"text-zinc-600 dark:text-zinc-400",plain:"text-zinc-900 dark:text-zinc-100"}}}),d=(0,o.j)("",{variants:{color:{rose:"bg-rose-50 dark:bg-rose-400/10",red:"bg-red-50 dark:bg-red-400/10",yellow:"bg-yellow-50 dark:bg-yellow-400/10",orange:"bg-orange-50 dark:bg-orange-400/10",green:"bg-green-50 dark:bg-green-500/10",lime:"bg-lime-50 dark:bg-lime-500/10",blue:"bg-blue-50 dark:bg-blue-400/10",sky:"bg-sky-50 dark:bg-sky-400/10",indigo:"bg-indigo-50 dark:bg-indigo-400/10",purple:"bg-purple-50 dark:bg-purple-400/10",pink:"bg-pink-50 dark:bg-pink-400/10",brand:"bg-brand-100 dark:bg-brand-400/10",gray:"bg-zinc-50 dark:bg-zinc-400/10",plain:"bg-zinc-900/10 dark:bg-zinc-100/10"}}}),u=(0,o.j)("",{variants:{color:{rose:"border-rose-600/10 dark:border-rose-400/20 ring-rose-600/10 dark:ring-rose-400/20",red:"border-red-600/10 dark:border-red-400/20 ring-red-600/10 dark:ring-red-400/20",yellow:"border-yellow-600/20 dark:border-yellow-400/20 ring-yellow-600/20 dark:ring-yellow-400/20",orange:"border-orange-600/20 dark:border-orange-400/20 ring-orange-600/20 dark:ring-orange-400/20",green:"border-green-600/20 dark:border-green-500/20 ring-green-600/20 dark:ring-green-500/20",lime:"border-lime-600/20 dark:border-lime-500/20 ring-lime-600/20 dark:ring-lime-500/20",blue:"border-blue-700/10 dark:border-blue-400/30 ring-blue-700/10 dark:ring-blue-400/30",sky:"border-sky-700/10 dark:border-sky-400/30 ring-sky-700/10 dark:ring-sky-400/30",indigo:"border-indigo-700/10 dark:border-indigo-400/30 ring-indigo-700/10 dark:ring-indigo-400/30",purple:"border-purple-700/10 dark:border-purple-400/30 ring-purple-700/10 dark:ring-purple-400/30",pink:"border-pink-700/10 dark:border-pink-400/20 ring-pink-700/10 dark:ring-pink-400/20",brand:"border-brand-600/40 dark:border-brand-400/30 ring-brand-600/40 dark:ring-brand-400/30",gray:"border-zinc-500/10 dark:border-zinc-400/20 ring-zinc-500/10 dark:ring-zinc-400/20",plain:"border-zinc-900 dark:border-zinc-100 ring-zinc-900 dark:ring-zinc-100"}}}),c=(0,o.j)("flex-0 inline-flex w-auto items-center rounded-md font-medium ring-1 ring-inset",{variants:{size:{sm:"px-1.5 gap-1.5 py-1 text-2xs leading-3",md:"px-2 gap-2 py-1 text-xs leading-4",lg:"px-2 gap-2 py-1 text-xs leading-6"},color:{rose:[d({color:"rose"}),u({color:"rose"}),s({color:"rose"})],red:[d({color:"red"}),u({color:"red"}),s({color:"red"})],yellow:[d({color:"yellow"}),u({color:"yellow"}),s({color:"yellow"})],orange:[d({color:"orange"}),u({color:"orange"}),s({color:"orange"})],green:[d({color:"green"}),u({color:"green"}),s({color:"green"})],lime:[d({color:"lime"}),u({color:"lime"}),s({color:"lime"})],blue:[d({color:"blue"}),u({color:"blue"}),s({color:"blue"})],sky:[d({color:"sky"}),u({color:"sky"}),s({color:"sky"})],indigo:[d({color:"indigo"}),u({color:"indigo"}),s({color:"indigo"})],purple:[d({color:"purple"}),u({color:"purple"}),s({color:"purple"})],pink:[d({color:"pink"}),u({color:"pink"}),s({color:"pink"})],brand:[d({color:"brand"}),u({color:"brand"}),s({color:"brand"})],gray:[d({color:"gray"}),u({color:"gray"}),s({color:"gray"})],plain:[d({color:"plain"}),u({color:"plain"}),s({color:"plain"})]}},defaultVariants:{size:"md",color:"gray"}}),Badge=e=>{let{size:r,color:t,className:o,children:a,...l}=e;return(0,n.jsx)("span",{className:(0,i.m6)(c({size:r,color:t}),o),...l,children:a})}},54939:function(e,r,t){"use strict";t.d(r,{YG:function(){return SyncWithMoonraker},rR:function(){return moonrakerWriteEffect}});var n=t(72612),o=t(39164),i=t(96886),a=t(79535),l=t(96588);let s=new EventTarget,DispatchSaveAtomEvent=(e,r)=>{s.dispatchEvent(new CustomEvent("saveAtom",{detail:{itemKey:e,value:r}}))},moonrakerWriteEffect=()=>e=>{e.onSet(r=>{DispatchSaveAtomEvent(e.node.key,null==r?"null":r)})},SyncWithMoonraker=e=>{let{children:r}=e,t=(0,i.oK)(),d=(0,o.useCallback)(async e=>{let r=await t.getItem("RatOS",e);return null!=r&&"null"!=r?r:new l.nY},[t]),u=(0,o.useCallback)(async e=>{let{itemKey:r,value:n}=e.detail;await t.saveItem("RatOS",r,n)},[t]);return(0,o.useEffect)(()=>(s.addEventListener("saveAtom",u),()=>{s.removeEventListener("saveAtom",u)}),[u]),(0,n.jsx)(a.J1,{read:d,children:r})}},37231:function(e,r,t){"use strict";t.d(r,{N:function(){return i}});var n=t(94594),o=t(1314);let i=n.z.array(o.HB).parse([{id:"LDO-TMC2209",title:"TMC2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"BTT-KRAKEN-2160-PLUS",title:"BTT TMC2160",type:"TMC5160",protocol:"SPI",senseResistor:.022,voltages:[24,36,48,56,60],maxCurrent:8,coolingCurrentThreshold:3},{id:"BTT-KRAKEN-2160",title:"BTT TMC2160",type:"TMC5160",protocol:"SPI",senseResistor:.075,voltages:[24,36,48,56,60],maxCurrent:3,coolingCurrentThreshold:1.5},{id:"BTT-TMC2209-13",title:"BTT TMC2209 v1.3",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"BTT-TMC2226-10",title:"BTT TMC2226 v1.0",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"BTT-TMC5160-PRO-11",title:"BTT TMC5160(T) Pro v1.1",type:"TMC5160",protocol:"SPI",senseResistor:.075,voltages:[24,36,48,56],maxCurrent:3,coolingCurrentThreshold:1.5},{id:"BTT-TMC5160T-PLUS-10",title:"BTT TMC5160T Plus v1.0",type:"TMC5160",protocol:"SPI",senseResistor:.022,voltages:[24,36,48,56,60],maxCurrent:10.6,coolingCurrentThreshold:3,external:!0},{id:"BTT-EZ2209",title:"BTT EZ2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.3,voltages:[24],maxCurrent:2},{id:"BTT-EZ2226",title:"BTT EZ2226",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.3,voltages:[24],maxCurrent:2},{id:"BTT-EZ2130",title:"BTT EZ2130",type:"TMC2130",protocol:"SPI",senseResistor:.11,coolingCurrentThreshold:.9,voltages:[24],maxCurrent:2},{id:"BTT-EZ5160-PRO",title:"BTT EZ5160 Pro",type:"TMC5160",protocol:"SPI",senseResistor:.075,coolingCurrentThreshold:1.6,voltages:[24,36,48],maxCurrent:2.5},{id:"BTT-EZ5160-RGB",title:"BTT EZ5160 RGB",type:"TMC5160",protocol:"SPI",senseResistor:.05,coolingCurrentThreshold:3,voltages:[24,48,36,56],maxCurrent:4.7},{id:"MELLOW-FLY-HV-TMC5160-PRO-12",title:"Mellow FLY HV TMC5160 Pro v1.2",type:"TMC5160",protocol:"SPI",senseResistor:.033,coolingCurrentThreshold:3,voltages:[24,36,48],maxCurrent:4.25,external:!0},{id:"MELLOW-FLY-TMC2209",title:"Mellow FLY TMC2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"PRUSA-EINSY-RAMBO-TMC2130",title:"Prusa Einsy Rambo TMC2130",type:"TMC2130",protocol:"SPI",senseResistor:.22,coolingCurrentThreshold:.9,voltages:[24],maxCurrent:2},{id:"PRUSA-BUDDY-TMC2209",title:"Prusa Buddy TMC2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2}])},4840:function(e,r,t){"use strict";t.d(r,{z2:function(){return d},Ie:function(){return s},Yo:function(){return hotendFanOptions},gL:function(){return partFanOptions}});var n=t(72612),o=t(1314),i=t(64929),a=t(39164);let l=a.forwardRef((e,r)=>{let{className:t,...o}=e;return(0,n.jsx)("strong",{ref:r,className:(0,i.cn)("font-semibold",t),...o})});(0,i.h)(l,"Strong");let s=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:[(0,n.jsx)(l,{className:"dark:text-sky-300/70",children:"Input Voltage PWM"})," is used on fans that have no dedicated pwm pin (2 and 3-pin fans)."]}),(0,n.jsxs)("p",{children:[(0,n.jsx)(l,{className:"dark:text-sky-300/70",children:"Digital PWM"})," is used for fans that have a dedicated PWM signal wire (requires a 4-pin fan)."]})]}),partFanOptions=(e,r)=>{var t,n,i,a,l;let s=[];return(null==r||(null==r?void 0:r.axis)===o.po.x||(null==r?void 0:r.axis)===null)&&(s.push({id:"2pin",title:"Input Voltage PWM",badge:[{color:"purple",children:null!==(a=null==e?void 0:null===(n=e.controlboard)||void 0===n?void 0:n.name)&&void 0!==a?a:"Control Board"}]}),s.push({id:"4pin",title:"Digital PWM on 2-pin port",badge:[{color:"purple",children:null!==(l=null==e?void 0:null===(i=e.controlboard)||void 0===i?void 0:i.name)&&void 0!==l?l:"Control Board"}]})),(null==e?void 0:null===(t=e.controlboard)||void 0===t?void 0:t.fourPinFanConnectorCount)!=null&&e.controlboard.fourPinFanConnectorCount>0&&s.push({id:"4pin-dedicated",title:"Digital PWM on 4-pin port",badge:[{color:"purple",children:e.controlboard.name}]}),(null==r?void 0:r.toolboard)!=null&&(s.push({id:"2pin-toolboard",title:"Input Voltage PWM",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]}),s.push({id:"4pin-toolboard",title:"Digital PWM on 2-pin port",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]}),(null==r?void 0:r.toolboard.fourPinFanConnectorCount)!=null&&r.toolboard.fourPinFanConnectorCount>0&&s.push({id:"4pin-dedicated-toolboard",title:"Digital PWM on 4-pin port",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]})),s},hotendFanOptions=(e,r)=>{var t,n,i,a,l,s,d,u,c;let p=[];return(null==r||(null==r?void 0:r.axis)===o.po.x)&&(p.push({id:"2pin",title:"Input Voltage PWM",badge:[{color:"purple",children:null!==(s=null==e?void 0:null===(a=e.controlboard)||void 0===a?void 0:a.name)&&void 0!==s?s:"Control Board"}]}),p.push({id:"4pin",title:"Digital PWM on 2-pin port",badge:[{color:"purple",children:null!==(d=null==e?void 0:null===(l=e.controlboard)||void 0===l?void 0:l.name)&&void 0!==d?d:"Control Board"}]})),((null==e?void 0:null===(t=e.controlboard)||void 0===t?void 0:t.fourPinFanConnectorCount)!=null&&e.controlboard.fourPinFanConnectorCount>2||(null==e?void 0:null===(n=e.controlboard)||void 0===n?void 0:n.fourPinFanConnectorCount)!=null&&e.controlboard.fourPinFanConnectorCount>1&&(null===(i=e.controllerFan)||void 0===i?void 0:i.id)!=="4pin-dedicated")&&p.push({id:"4pin-dedicated",title:"Digital PWM on 4-pin port",badge:[{color:"purple",children:null!==(c=null==e?void 0:null===(u=e.controlboard)||void 0===u?void 0:u.name)&&void 0!==c?c:"Control Board"}]}),(null==r?void 0:r.toolboard)!=null&&(p.push({id:"2pin-toolboard",title:"Input Voltage PWM",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]}),p.push({id:"4pin-toolboard",title:"Digital PWM on 2-pin port",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]}),(null==r?void 0:r.toolboard.fourPinFanConnectorCount)!=null&&r.toolboard.fourPinFanConnectorCount>1&&p.push({id:"4pin-dedicated-toolboard",title:"Digital PWM on 4-pin port",badge:[{color:"sky",children:"".concat(r.toolboard.name).concat(null!=r.toolNumber&&" T".concat(r.toolNumber))}]})),p},d={id:"2pin",title:"Input Voltage PWM",badge:[{color:"purple",children:"Control Board"}]}},65878:function(e,r,t){"use strict";t.d(r,{S:function(){return getDefaultNozzle}});let getDefaultNozzle=()=>({diameter:.4,type:"Regular"})},18311:function(e,r,t){"use strict";t.d(r,{B:function(){return i},a:function(){return findPreset}});var n=t(94594),o=t(1314);let findPreset=(e,r,t,n,o)=>{var i;return null===(i=e.presets)||void 0===i?void 0:i.slice().sort((e,r)=>o?r.run_current-e.run_current:e.run_current-r.run_current).find(e=>e.driver===r.type&&e.voltage===t&&e.sense_resistor===r.senseResistor&&(null==n||e.run_current===n))},i=n.z.array(o.vF).parse([{id:"generic",title:"Generic Stepper",maxPeakCurrent:2.8},{id:"BONDTECH-42H025H-0704-002",title:"Bondtech LGX Stepper",maxPeakCurrent:.7},{id:"LDO-42STH48-2504AC",title:"LDO-42STH48-2504AC",maxPeakCurrent:2.5,presets:[{run_current:1.1,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:1,driver_TOFF:3,driver_HEND:0,driver_HSTRT:0},{run_current:1.6,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:2,driver_TOFF:3,driver_HEND:0,driver_HSTRT:6},{run_current:1.6,voltage:24,driver:"TMC5160",sense_resistor:.075,driver_TBL:2,driver_TOFF:3,driver_HEND:0,driver_HSTRT:6},{run_current:1.768,voltage:48,driver:"TMC5160",sense_resistor:.075,driver_TBL:0,driver_TOFF:4,driver_HEND:0,driver_HSTRT:4}]},{id:"LDO-42STH40-1684AC",title:"LDO-42STH40-1684AC",maxPeakCurrent:1.68,presets:[{run_current:.4,voltage:24,driver:"TMC2130",sense_resistor:.22,driver_IHOLDDELAY:8,driver_TPOWERDOWN:0,driver_TBL:2,driver_TOFF:3,driver_HEND:1,driver_HSTRT:5,driver_PWM_FREQ:2,driver_PWM_GRAD:2,driver_PWM_AMPL:230,driver_PWM_AUTOSCALE:!0,driver_SGT:5},{run_current:.52,voltage:24,driver:"TMC2130",sense_resistor:.22,driver_IHOLDDELAY:8,driver_TPOWERDOWN:0,driver_TBL:2,driver_TOFF:3,driver_HEND:1,driver_HSTRT:5,driver_PWM_FREQ:2,driver_PWM_GRAD:4,driver_PWM_AMPL:240,driver_PWM_AUTOSCALE:!0,driver_SGT:3},{run_current:.8,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:1,driver_TOFF:3,driver_HEND:3,driver_HSTRT:0},{run_current:1.188,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:0,driver_TOFF:3,driver_HEND:0,driver_HSTRT:0}]},{id:"LDO-42STH48-2004MAH",title:"LDO-42STH48-2004MAH",maxPeakCurrent:2,fullStepsPerRotation:400},{id:"LDO-42STH48-2004AC",title:"LDO-42STH48-2004AC",maxPeakCurrent:2},{id:"LDO-42STH25-1404MAC",title:"LDO-42STH25-1404MAC",maxPeakCurrent:1.4,fullStepsPerRotation:400,presets:[{voltage:24,driver:"TMC2209",sense_resistor:.11,run_current:.85,driver_TBL:1,driver_TOFF:3,driver_HEND:2,driver_HSTRT:0}]},{id:"LDO-42STH25-1004CL200E",title:"LDO-42STH25-1004CL200E",maxPeakCurrent:1},{id:"LDO-36STH20-1004AHG",title:"LDO-36STH20-1004AHG",maxPeakCurrent:1,presets:[{voltage:24,driver:"TMC2209",sense_resistor:.11,run_current:.707,driver_TBL:0,driver_HEND:6,driver_HSTRT:7,driver_TOFF:4}]},{id:"LDO-36STH17-1004AHG",title:"LDO-36STH17-1004AHG",maxPeakCurrent:1},{id:"LDO-35STH48-1684AH",title:"LDO-35STH48-1684AH",maxPeakCurrent:1.68}])},75061:function(e,r,t){"use strict";t.d(r,{N:function(){return n}});let n={timestamp:!0,level:"info"}},11974:function(e,r,t){"use strict";t.d(r,{D:function(){return ToolheadHelper}});var n=t(21264),o=t(1314),i=t(22595),a=t(65878),l=t(86736),s=t.n(l);let ToolheadHelper=class ToolheadHelper{hasToolboard(){return null!=this.config.toolboard}getToolboard(){return this.config.toolboard}getMotionStepperName(){return this.config.axis===o.po.dual_carriage?"dual_carriage":"stepper_".concat(this.getMotionAxis())}getToolboardName(){if(null==this.config.toolboard)throw Error("Toolhead T".concat(this.getTool()," does not have a toolboard"));return"toolboard_".concat(this.getShortToolName())}getShortToolName(){return"t".concat(this.getTool())}getDescription(){var e;return null!==(e=this.config.description)&&void 0!==e?e:"the printer's toolhead"}getMotionAxis(){return this.config.axis===o.po.dual_carriage?o.po.dual_carriage:o.po.x}getExtruderAxis(){return this.config.axis===o.po.dual_carriage?o.po.extruder1:o.po.extruder}getToolCommand(){return"T".concat(this.getTool())}getTool(){return this.config.axis===o.po.dual_carriage?1:0}getSerialSuffix(){return"t".concat(this.getTool())}getExtruder(){return this.config.extruder}getHotend(){return this.config.hotend}getNozzle(){var e;return null!==(e=this.config.nozzle)&&void 0!==e?e:(0,a.S)()}getThermistor(){return this.config.thermistor}getXEndstop(){return this.config.xEndstop}getYEndstop(){return this.config.yEndstop}getXAccelerometer(){return this.config.xAccelerometer}getYAccelerometer(){return this.config.yAccelerometer}getXAccelerometerName(){var e;switch(null===(e=this.getXAccelerometer())||void 0===e?void 0:e.id){case"controlboard":return"controlboard";case"toolboard":if(this.hasToolboard())return this.getToolboardName();case"sbc":return"rpi";case"beacon":return"beacon";default:return"controlboard"}}getYAccelerometerName(){var e;switch(null===(e=this.getYAccelerometer())||void 0===e?void 0:e.id){case"controlboard":return"controlboard";case"toolboard":if(this.hasToolboard())return this.getToolboardName();case"sbc":return"rpi";case"beacon":return"beacon";default:return"controlboard"}}getChangeSet(e){if(null==e)return null;let r={};Object.keys(e).forEach(t=>{let n=this.getConfig()[t],o=e[t];if(null!=n&&null==o||null==n&&null!=o){r[t]=o;return}n&&o&&("object"==typeof n&&"id"in n&&"object"==typeof o&&"id"in o?n.id!==o.id&&(r[t]=o):s()(n,o)||(r[t]=o))});let t=i.b2.safeParse(r);return t}getProbe(){return this.config.probe}getPartFan(){return this.config.partFan}getHotendFan(){return this.config.hotendFan}serialize(){return(0,n.m6)(this.config)}getConfig(){return{...this.config}}constructor(e){this.config=e}}},10187:function(e,r,t){"use strict";t.d(r,{S:function(){return n.SX},u:function(){return n.uF}});var n=t(79293)},81446:function(e,r,t){"use strict";t.d(r,{X:function(){return getHost}});let getHost=()=>{var e;return""!="".trim()?"":(null===(e=window.location)||void 0===e?void 0:e.hostname)!=null?window.location.hostname:null}},64929:function(e,r,t){"use strict";t.d(r,{cn:function(){return cn},h:function(){return setDisplayName}});var n=t(35209),o=t(63278);function cn(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.m6)((0,n.W)(r))}function setDisplayName(e,r){e.displayName=r}},37652:function(e,r,t){"use strict";t.r(r),t.d(r,{ControllerFanState:function(){return h},LoadablePrinterConfigurationState:function(){return y},PerformanceModeState:function(){return _},PrinterConfigurationState:function(){return v},StandstillStealthState:function(){return m},StealthchopState:function(){return b},serializePartialPrinterConfiguration:function(){return serializePartialPrinterConfiguration},serializePrinterConfiguration:function(){return serializePrinterConfiguration},usePrinterConfiguration:function(){return usePrinterConfiguration},useSerializedPrinterConfiguration:function(){return useSerializedPrinterConfiguration}});var n=t(96588),o=t(94594),i=t(18954),a=t(61968),l=t(79535),s=t(79807),d=t(39164),u=t(21264),c=t(32342),p=t(65667),g=t(4840),f=t(54939),z=t(98948);let _=(0,n.cn)({key:"PerformanceMode",default:!1,effects:[(0,f.rR)(),(0,l.ok)({refine:(0,s.getRefineCheckerForZodSchema)(o.z.boolean().optional().nullable())})]}),b=(0,n.cn)({key:"Stealchop",default:!1,effects:[(0,f.rR)(),(0,l.ok)({refine:(0,s.getRefineCheckerForZodSchema)(o.z.boolean().optional().nullable())})]}),m=(0,n.cn)({key:"StandstillStealth",default:!1,effects:[(0,f.rR)(),(0,l.ok)({refine:(0,s.getRefineCheckerForZodSchema)(o.z.boolean().optional().nullable())})]}),h=(0,n.cn)({key:"ControllerFan",default:g.z2,effects:[(0,f.rR)(),(0,l.ok)({refine:(0,s.getRefineCheckerForZodSchema)(i.XG.nullable())})]}),v=(0,n.nZ)({key:"PrinterConfiguration",get:async e=>{let{get:r}=e,{printer:t,printerSize:o,performanceMode:i,stealthchop:l,standstillStealth:s,rails:d,controlboard:g,controllerFan:f,toolheads:v}=r((0,n.k9)({printer:c.H6,printerSize:c.hq,performanceMode:_,stealthchop:b,standstillStealth:m,rails:c.q7,controlboard:c.OS,controllerFan:h,toolheads:p.$T})),y={printer:null==t?null:{...t,defaults:{...t.defaults,toolheads:null==t?void 0:t.defaults.toolheads.map(e=>(0,u.m6)(e))}},size:o,performanceMode:i,stealthchop:l,standstillStealth:s,rails:d,controlboard:g,controllerFan:f,toolheads:v.length>0?v:void 0},T=a.jz.safeParse(y);return!1===T.success&&(0,z.j)().error({errors:T.error.flatten().fieldErrors,data:y},"Couldn't parse printer configuration"),T.success?T.data:null}}),y=(0,n.nZ)({key:"LoadablePrinterConfigurationState",get:async e=>{let{get:r}=e,t=r((0,n.Qv)(v));return({hasValue:()=>t.contents,hasError:()=>null,loading:()=>null})[t.state]()}}),serializePrinterConfiguration=e=>{let r={printer:e.printer.id,toolheads:e.toolheads.map(e=>(0,u.m6)(e)),size:e.size,controlboard:e.controlboard.id,controllerFan:e.controllerFan.id,performanceMode:e.performanceMode,stealthchop:e.stealthchop,standstillStealth:e.standstillStealth,rails:e.rails.map(e=>(0,u.Yz)(e))};return a.q_.parse(r)},serializePartialPrinterConfiguration=e=>{var r,t,n,o;let i=null==e?void 0:null===(r=e.toolheads)||void 0===r?void 0:r.map(e=>(0,u.od)(e)),l={printer:null==e?void 0:null===(t=e.printer)||void 0===t?void 0:t.id,toolheads:i,size:null==e?void 0:e.size,controlboard:null==e?void 0:null===(n=e.controlboard)||void 0===n?void 0:n.id,controllerFan:null==e?void 0:null===(o=e.controllerFan)||void 0===o?void 0:o.id,performanceMode:null==e?void 0:e.performanceMode,stealthchop:null==e?void 0:e.stealthchop,standstillStealth:null==e?void 0:e.standstillStealth};return a.NN.parse(l)},useSerializedPrinterConfiguration=()=>{let e=(0,n.sJ)(v),r=(0,d.useMemo)(()=>serializePartialPrinterConfiguration(null!=e?e:{}),[e]);return r},usePrinterConfiguration=()=>{let[e,r]=(0,n.FV)(c.H6),[t,o]=(0,n.FV)(c.hq),[i,l]=(0,n.FV)(c.OS),[s,d]=(0,n.FV)(_),[u,p]=(0,n.FV)(b),[g,f]=(0,n.FV)(m),[z,y]=(0,n.FV)(h),T=(0,n.sJ)(c.q7),x=(0,n.sJ)(v),C=useSerializedPrinterConfiguration(),S=a.dl.safeParse(x);return{selectedPrinter:e,setSelectedPrinter:r,selectedPrinterOption:t,setSelectedPrinterOption:o,selectedBoard:i,setSelectedBoard:l,performanceMode:s,setPerformanceMode:d,stealthchop:u,setStealthchop:p,standstillStealth:g,setStandstillStealth:f,selectedPrinterRails:T,selectedControllerFan:z,setSelectedControllerFan:y,partialPrinterConfiguration:x,serializedPrinterConfiguration:C,parsedPrinterConfiguration:S}}},96886:function(e,r,t){"use strict";t.d(r,{oK:function(){return useMoonraker},xH:function(){return useMoonrakerMutation},DS:function(){return useMoonrakerQuery},Fu:function(){return useMoonrakerState},A4:function(){return useNamespacedItemQuery},hS:function(){return usePrinterObjectQuery},Q:function(){return usePrinterObjectSubscription}});var n=t(39164),o=t(9948),i=t(65339),a=t(84634),l=t(81446);let s=[{version:1,description:"Undo double JSON encoding of RatOS's data",up:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(!e.ok)return{result:"Nothing to migrate"};{let r=await e.json();if("error"in r)throw Error(r.error.message);let t=[];if(null==r.result.value)return{result:"Nothing to migrate"};for await(let[e,t]of Object.entries(r.result.value))try{let r=JSON.parse(t);console.log("Migrating",e,"from",t,"to",r),await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:e,value:r})})}catch(r){console.error("Error migrating",e,t,"clearing key"),await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS&key=").concat(encodeURIComponent(e)),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:e})});continue}return{result:"Succesfully decoded ".concat(t.length," keys.\n").concat(t.join("\n"))}}},down:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(e.ok){let r=await e.json();if("error"in r)throw Error(r.error.message);if(null==r.result.value)return{result:"Nothing to migrate"};let t=[];for await(let[e,n]of Object.entries(r.result.value)){let r=JSON.stringify(n);await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:e,value:r})}),t.push("Re-encoded ".concat(e))}return{result:"Succesfully re-encoded ".concat(t.length," keys.\n").concat(t.join("\n"))}}return{result:"Nothing to migrate"}}},{version:2,description:"Change caramba printers to v-core-4 / v-chonk",up:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(!e.ok)return{result:"Nothing to migrate"};{let r=await e.json();if("error"in r)throw Error(r.error.message);let t=[];if(null==r.result.value)return{result:"Nothing to migrate"};for await(let[e,n]of Object.entries(r.result.value))if("Printer"===e&&"string"==typeof n){let e=n.replace(/caramba-chonk/g,"v-chonk").replace(/caramba/g,"v-core-4");if(e===n)continue;await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:"Printer",value:e})}),t.push("Migrated ".concat(n," to ").concat(e))}return{result:"Succesfully migrated ".concat(t.length," keys.\n").concat(t.join("\n"))}}},down:async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS"));if(!e.ok)return{result:"Nothing to migrate"};{let r=await e.json();if("error"in r)throw Error(r.error.message);let t=[];if(null==r.result.value)return{result:"Nothing to migrate"};for await(let[e,n]of Object.entries(r.result.value))if("Printer"===e&&"string"==typeof n){let e=n.replace(/v-chonk/g,"caramba-chonk").replace(/v-core-4/g,"caramba");if(e===n)continue;await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:"Printer",value:e})}),t.push("Migrated ".concat(n," to ").concat(e))}return{result:"Succesfully migrated ".concat(t.length," keys.\n").concat(t.join("\n"))}}}}],getCurrentVersion=async()=>{let e=await window.fetch("http://".concat((0,l.X)(),"/server/database/item?namespace=RatOS&key=__db_version"));if(e.ok){let r=await e.json();return"error"in r?0:r.result.value}return 0},setCurrentVersion=async e=>{await window.fetch("http://".concat((0,l.X)(),"/server/database/item"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({namespace:"RatOS",key:"__db_version",value:e})})},d=!1,migrate=async(e,r)=>{if(d)return console.log("Already migrating, ignoring..");if(e===r)return console.log("Already at target version");d=!0;try{let t=s.filter(t=>t.version>e&&t.version<=r).sort((t,n)=>e<=r?t.version-n.version:n.version-t.version);for await(let n of t){let t=await (e<r?n.up():n.down());console.log("Migrated to version ".concat(n.version,": ").concat(t.result))}await setCurrentVersion(r)}finally{d=!1}},u=!1,migrateToLatest=async()=>{if(u)return console.log("Already migrated, ignoring..");let e=await getCurrentVersion(),r=Math.max(...s.map(e=>e.version));if(e===r){console.log("Already at latest version");return}if(d){console.log("Already migrating, ignoring..");return}console.log("Migrating to latest version...",e,r),await migrate(e,r),u=!0,console.log("Migration complete.")};var c=t(52540),p=t(86736),g=t.n(p),f=t(98948);let z=0,getWsURL=()=>{let e=(0,l.X)();return null==e||""==e.trim()?null:"ws://".concat(e,"/websocket")},_={},useMoonraker=e=>{let r=(0,n.useRef)({}),t=(0,n.useRef)({}),o=(0,n.useRef)([]),i=(0,n.useRef)([]),[l,s]=(0,n.useState)(getWsURL());(0,n.useEffect)(()=>{s(getWsURL())},[]);let d=(0,n.useCallback)(e=>{if("error"in e)return!1;if("notify_status_update"===e.method&&null!=e.params){let r=e.params[0];if(null!=r)for(let e of o.current){let t=_[e];if(null!=t){for(let e in t)if(null!=r[e])return!0}}}return!1},[]),{lastJsonMessage:u,sendJsonMessage:c,readyState:p}=(0,a.ZP)(l,{filter:t=>{if("connected"!==b)return!0;try{var n;let o=JSON.parse(t.data);if(null!=r.current[o.id]||(null==e?void 0:null===(n=e.passThroughUpdateMethods)||void 0===n?void 0:n.length)&&"method"in o&&e.passThroughUpdateMethods.includes(o.method))return!0}catch(e){(0,f.j)().warn({e,messageData:t.data},"Filter: Failed to parse message")}return!1},onMessage:r=>{if(null==e?void 0:e.onStatusUpdate)try{let n=JSON.parse(r.data);if(d(n)){var t;let r=n.params[0];null===(t=e.onStatusUpdate)||void 0===t||t.call(e,r)}}catch(e){(0,f.j)().warn({e,messageData:r.data},"OnMessage: Failed to parse message")}},shouldReconnect:e=>!0,reconnectAttempts:1/0,reconnectInterval:3e3,share:!0}),g=(0,n.useRef)(p);g.current=p;let[b,m]=(0,n.useState)(1===p?"connected":"connecting"),h=(0,n.useCallback)((e,r)=>{1===g.current?e():i.current.push({resolve:e,reject:r})},[]),v=(0,n.useCallback)(()=>new Promise((e,r)=>{h(e,r)}),[h]),y=(0,n.useCallback)(async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=++z;return await v(),new Promise((i,a)=>{r.current[o]=(e,r)=>e?a(e):r&&"object"==typeof r&&"error"in r&&r.error?a(r.error):null==r?a(Error("No result. Unknown response format.")):void i(r);let l=1e4;"printer.gcode.script"===e&&(l=6e5),t.current[o]=window.setTimeout(()=>{var e,n;null===(e=(n=r.current)[o])||void 0===e||e.call(n,Error("Request timed out"),null),delete r.current[o],delete t.current[o]},l),c({jsonrpc:"2.0",method:e,params:n,id:o})})},[v,c]),T=(0,n.useCallback)(async function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];let n=Object.fromEntries(r.map(e=>[e,null])),i=Object.assign({},n,...Object.values(_).filter(e=>null!=e)),a=y("printer.objects.subscribe",{objects:i}),l=z;_[l]=n,o.current.push(l);let s=(await a).status;return{res:s,unsuscribe:async()=>{if(o.current=o.current.filter(e=>e!==l),null==_[l]){delete _[l];let e=Object.assign({},...Object.values(_).filter(e=>null!=e));await y("printer.objects.subscribe",{objects:e})}}}},[y]),x=(0,n.useCallback)(async(e,r,t)=>(await v(),await y("server.database.post_item",{namespace:e,key:r,value:t})),[y,v]),C=(0,n.useCallback)(async(e,r)=>{await v();try{var t;let n=await y("server.database.get_item",{namespace:e,key:r});return null!==(t=null==n?void 0:n.value)&&void 0!==t?t:null}catch(e){return(0,f.j)().warn(e),null}},[y,v]);return(0,n.useEffect)(()=>{1===p?(async()=>{await migrateToLatest(),i.current.forEach(e=>e.resolve()),i.current=[],m("connected")})():m("connecting")},[p]),(0,n.useEffect)(()=>{(null==u?void 0:u.id)&&r.current[u.id]&&(window.clearTimeout(t.current[u.id]),"error"in u?r.current[u.id](Error(u.error.message),null):r.current[u.id](null,u.result),delete t.current[u.id],delete r.current[u.id])},[u]),(0,n.useEffect)(()=>()=>{for(let e in t.current)delete t.current[e],delete r.current[e];if(o.current.length>0){o.current.forEach(e=>{delete _[e]}),o.current=[];let e=Object.assign({},...Object.values(_).filter(e=>null!=e));y("printer.objects.subscribe",{objects:Object.keys(e).length>0?e:null}).catch(e=>{})}i.current.forEach(e=>e.reject()),i.current=[]},[]),{query:y,saveItem:x,getItem:C,subscribeToObject:T,status:b,lastMessage:u,isReady:1===p}},useNamespacedItemQuery=(e,r,t)=>{let{getItem:n}=useMoonraker();return(0,o.a)({...t,queryKey:[e,r],queryFn:async()=>n(e,r)})},useMoonrakerQuery=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];let{query:n}=useMoonraker(),i=3===r.length?r[2]:r[1],a=3===r.length?r[1]:void 0,l=r[0],s=3===r.length?[l,a]:[l];return(0,o.a)({...null!=i?i:{},queryKey:[r[0]],queryFn:async()=>n(...s)})},useMoonrakerMutation=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];let{query:n}=useMoonraker(),o=r[1],a=r[0];return(0,i.D)({...o,mutationKey:[r[0]],mutationFn:async e=>{let r=e?[a,e]:[a];return n(...r)}})},usePrinterObjectQuery=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];let{query:n}=useMoonraker();return(0,o.a)({queryKey:r,queryFn:async()=>{let e=Object.fromEntries(r.map(e=>[e,null]));return(await n("printer.objects.query",{objects:e})).status}})},usePrinterObjectSubscription=function(e){for(var r=arguments.length,t=Array(r>1?r-1:0),o=1;o<r;o++)t[o-1]=arguments[o];let[i,a]=(0,n.useState)(null),l=(0,n.useRef)(i);l.current=i;let s=(0,n.useRef)(e);s.current=e;let d=(0,n.useCallback)(e=>{var r;return null==s.current?e:null===(r=s.current)||void 0===r?void 0:r.call(s,e)},[]),u=(0,n.useMemo)(()=>Object.fromEntries(t.map(e=>[e,null])),[JSON.stringify(t.sort())]),{subscribeToObject:p}=useMoonraker({onStatusUpdate:(0,n.useCallback)(e=>{let r={};for(let t in u)null!=e[t]&&(r[t]=e[t]);let t=d(r);if(null==t||"object"!=typeof t)throw Error("Invalid selection function, must return object, got "+typeof t);Object.keys(r).length>0&&!1===g()(t,l.current)&&a(e=>(0,c.T)(null!=e?e:{},t))},[d,u])});return(0,n.useEffect)(()=>{let e=p(...Object.keys(u));return e.then(e=>{a(d(e.res))}).catch(e=>{e instanceof Error&&(0,f.j)().error(e)}),()=>{e.then(e=>e.unsuscribe()).catch(e=>{e instanceof Error&&(0,f.j)().error(e)})}},[d,u,p]),i},useNamespacedItemMutation=(e,r,t)=>{let{saveItem:n}=useMoonraker();return(0,i.D)({...t,mutationKey:[e,r],mutationFn:t=>n(e,r,t)})},useMoonrakerState=function(e,r){var t;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=useNamespacedItemQuery(e,r,{initialData:o}),a=useNamespacedItemMutation(e,r),l=(0,n.useCallback)(async e=>{var r;let t="function"==typeof e?e(null!==(r=i.data)&&void 0!==r?r:o):e;await a.mutateAsync(t,{onSuccess:()=>{i.refetch()}})},[o,a,i]);return[null!==(t=i.data)&&void 0!==t?t:o,l,i,a]}},32342:function(e,r,t){"use strict";t.d(r,{H6:function(){return z},OS:function(){return m},Xu:function(){return _},ew:function(){return h},hq:function(){return b},q7:function(){return v}});var n=t(79535),o=t(91831),i=t(10187),a=t(96588),l=t(94594),s=t(79807),d=t(21264),u=t(1314),c=t(83907),p=t(54939),g=t(61968);let f={},readPrinterAtom=async e=>{let{read:r}=e,t=await r(z.key);if(null!=t){let e=l.z.object({id:o.Ox.shape.id}).safeParse(t);if(e.success||(e=l.z.object({id:o.Ox.shape.id}).safeParse({id:t})),e.success){let r=f[e.data.id];return null==r&&(r=await i.u.printer.printer.query(e.data.id,{}))&&(f[e.data.id]=r),null!=r?r:null}}return null},readPrinterRailAtom=e=>async r=>{let{read:t}=r,n=await t(h(e).key);if(null!=n){let r=u.Ah.safeParse(n);if(r.success)return r.data;let o=await readPrinterAtom({read:t}),i=null==o?void 0:o.defaults.rails.find(r=>r.axis===e);if(null!=i){let e=u.Ah.safeParse({...i,...n});if(e.success)return e.data}}return null},z=(0,a.cn)({key:"Printer",default:null,effects:[(0,p.rR)(),(0,n.ok)({read:readPrinterAtom,write:async(e,r)=>{let{write:t}=e;await new Promise(e=>{r instanceof a.nY?t(z.key,null):t(z.key,null!=r?r:null),setTimeout(()=>{},500)})},refine:(0,s.getRefineCheckerForZodSchema)(o.Ox.nullable())})]}),_=(0,a.nZ)({key:"LoadablePrinterState",get:async e=>{let{get:r}=e,t=r((0,a.Qv)(z));return({hasValue:()=>t.contents,hasError:()=>[],loading:()=>[]})[t.state]()}}),b=(0,a.cn)({key:"PrinterOption",default:null,effects:[(0,p.rR)(),(0,n.ok)({refine:(0,s.getRefineCheckerForZodSchema)(g.LN.nullable())})]}),m=(0,a.cn)({key:"Controlboard",default:null,effects:[(0,p.rR)(),(0,n.ok)({read:async e=>{let{read:r}=e,t=await r(m.key);if(null!=t){let e=l.z.object({id:c.WQ}).safeParse(t);if(e.success){let r=await i.u.mcu.boards.query({boardFilters:{toolboard:!1}}),t=r.find(r=>r.id===e.data.id);return null!=t?t:null}}return null},refine:(0,s.getRefineCheckerForZodSchema)(c.$l.nullable())})]}),h=(0,a.xu)({key:"PrinterRail",default:null,effects:e=>[(0,p.rR)(),(0,n.ok)({read:readPrinterRailAtom(e),refine:(0,s.getRefineCheckerForZodSchema)(u.Ah.nullable())})]}),v=(0,a.nZ)({key:"PrinterRails",get:e=>{let{get:r}=e,t=r(z),n=null==t?void 0:t.defaults.rails.map(e=>{let t=r(h(e.axis));return(0,d.Ak)(null!=t?t:e)});return null!=n?n:[]},set:(e,r)=>{let{set:t}=e;if(r instanceof a.nY){Object.values(u.po).forEach(e=>{t(h(e),null)});return}r.forEach(e=>{t(h(e.axis),(0,d.Yz)(e))})}});(0,a.nZ)({key:"LoadablePrinterRailsState",get:async e=>{let{get:r}=e,t=r((0,a.Qv)(v));return({hasValue:()=>t.contents,hasError:()=>[],loading:()=>[]})[t.state]()}})},65667:function(e,r,t){"use strict";t.d(r,{$T:function(){return f},AF:function(){return g},wm:function(){return z}});var n=t(96588),o=t(79535),i=t(94594),a=t(79807),l=t(10187),s=t(83907);t(1314);var d=t(22595),u=t(32342),c=t(54939),p=t(98948);let g=(0,n.xu)({key:"PrinterToolhead",default:null,effects:e=>[(0,c.rR)(),(0,o.ok)({read:async r=>{let{read:t}=r,n=await t(g(e).key);if("object"!=typeof n||null==n)return null;let{toolNumber:o,...a}=n;if(null!=a){let r=d.x8.safeParse(a);if(r.success){let t=r.data.toolboard;if(t&&null!=t){let e=i.z.object({id:s.WQ}).safeParse(t);if(e.success){let r=await l.u.mcu.boards.query({boardFilters:{toolboard:!0}}),n=r.find(r=>r.id===e.data.id);n&&(t=s.MG.parse(n))}}return{...r.data,toolboard:t,toolNumber:e}}(0,p.j)().debug("RecoilSync: failed to read toolhead!",g(e).key,r.error,a)}return null},refine:(0,a.getRefineCheckerForZodSchema)(d.PY.extend({toolNumber:d.Qr}).nullable())})]});(0,n.CG)({key:"DeserializeToolheadQuery",get:e=>async r=>{let{get:t}=r,n=d.x8.safeParse(await l.u.printer.deserializeToolheadConfiguration.query({config:e.th,printerConfig:{controlboard:e.boardId}}));return n.success?{...n.data,toolNumber:e.toolNumber}:null}});let f=(0,n.nZ)({key:"PrinterToolheadsState",get:e=>{let{get:r}=e,t=r(u.H6);return null==t?[]:r((0,n.k9)(t.defaults.toolheads.map((e,r)=>g(r)))).filter(Boolean)},set:(e,r)=>{let{set:t,reset:o}=e;if(r instanceof n.nY)throw Error("ToolheadsState cannot be reset, please reset the individual ToolheadState instead");r.forEach(e=>{t(g(e.toolNumber),{...e,toolNumber:e.toolNumber})})}}),z=(0,n.nZ)({key:"LoadablePrinterToolheadsState",get:async e=>{let{get:r}=e,t=r((0,n.Qv)(f));return({hasValue:()=>t.contents,hasError:()=>[],loading:()=>[]})[t.state]()}})},21264:function(e,r,t){"use strict";t.d(r,{Ak:function(){return deserializePrinterRail},DX:function(){return stringToTitleObject},Df:function(){return deserializeDriver},Oj:function(){return deserializePrinterRailDefinition},WZ:function(){return deserializeStepper},Yz:function(){return serializePrinterRail},m6:function(){return serializeToolheadConfiguration},od:function(){return serializePartialToolheadConfiguration}});var n=t(37231),o=t(1314),i=t(18311);t(22595),t(11974);let deserializeDriver=e=>{var r;return null!==(r=n.N.find(r=>r.id===e))&&void 0!==r?r:null},deserializeStepper=e=>{var r;return null!==(r=i.B.find(r=>r.id===e))&&void 0!==r?r:null},deserializePrinterRail=e=>{let r=deserializeStepper(e.stepper),t=deserializeDriver(e.driver);if(null==r)throw Error("Stepper ".concat(e.stepper," not found in database"));if(null==t)throw Error("Driver ".concat(e.driver," not found in database"));return o.g6.parse({...e,stepper:r,driver:t})},deserializePrinterRailDefinition=e=>{let r=deserializeStepper(e.stepper),t=deserializeDriver(e.driver);if(null==r)throw Error("Stepper ".concat(e.stepper," not found in database"));if(null==t)throw Error("Driver ".concat(e.driver," not found in database"));return o.P6.parse({...e,stepper:r,driver:t})},stringToTitleObject=e=>({id:e,title:e}),serializePrinterRail=e=>o.Ah.parse({...e,driver:e.driver.id,stepper:e.stepper.id}),serializeToolheadConfiguration=e=>{var r,t,n,o;return{...e,toolboard:null===(r=e.toolboard)||void 0===r?void 0:r.id,hotend:e.hotend.id,thermistor:e.thermistor,extruder:e.extruder.id,probe:null===(t=e.probe)||void 0===t?void 0:t.id,xEndstop:e.xEndstop.id,yEndstop:e.yEndstop.id,partFan:e.partFan.id,hotendFan:e.hotendFan.id,xAccelerometer:null===(n=e.xAccelerometer)||void 0===n?void 0:n.id,yAccelerometer:null===(o=e.yAccelerometer)||void 0===o?void 0:o.id}},serializePartialToolheadConfiguration=e=>{var r,t,n,o,i,a,l,s,d,u;return null==e?void 0:{...e,toolboard:null===(r=e.toolboard)||void 0===r?void 0:r.id,hotend:null===(t=e.hotend)||void 0===t?void 0:t.id,thermistor:e.thermistor,extruder:null===(n=e.extruder)||void 0===n?void 0:n.id,probe:null===(o=e.probe)||void 0===o?void 0:o.id,xEndstop:null===(i=e.xEndstop)||void 0===i?void 0:i.id,yEndstop:null===(a=e.yEndstop)||void 0===a?void 0:a.id,partFan:null===(l=e.partFan)||void 0===l?void 0:l.id,hotendFan:null===(s=e.hotendFan)||void 0===s?void 0:s.id,xAccelerometer:null===(d=e.xAccelerometer)||void 0===d?void 0:d.id,yAccelerometer:null===(u=e.yAccelerometer)||void 0===u?void 0:u.id}}},79293:function(e,r,t){"use strict";t.d(r,{SX:function(){return i},uF:function(){return a}});var n=t(67763),o=t(61863);function getBaseUrl(){return"/configure"}t(28070);let i=(0,o.t)({config:()=>({links:[(0,n.N8)({url:"".concat(getBaseUrl(),"/api/trpc"),maxURLLength:2083})]}),overrides:{useMutation:{async onSuccess(e){await e.originalFn(),await e.queryClient.invalidateQueries()}}},ssr:!1}),a=(0,n.K5)({links:[(0,n.N8)({url:"".concat(getBaseUrl(),"/api/trpc"),maxURLLength:2083})]})},83907:function(e,r,t){"use strict";t.d(r,{$l:function(){return v},MG:function(){return y},WQ:function(){return z}});var n,o,i=t(94594),a=t(1314);let l={x_step_pin:i.z.string().optional(),x_dir_pin:i.z.string().optional(),x_enable_pin:i.z.string().optional(),x_uart_pin:i.z.string().optional(),x_diag_pin:i.z.string().optional(),x_endstop_pin:i.z.string().optional(),x1_step_pin:i.z.string().optional(),x1_dir_pin:i.z.string().optional(),x1_enable_pin:i.z.string().optional(),x1_uart_pin:i.z.string().optional(),x1_diag_pin:i.z.string().optional(),x1_endstop_pin:i.z.string().optional(),dual_carriage_step_pin:i.z.string().optional(),dual_carriage_dir_pin:i.z.string().optional(),dual_carriage_enable_pin:i.z.string().optional(),dual_carriage_uart_pin:i.z.string().optional(),dual_carriage_diag_pin:i.z.string().optional(),dual_carriage_endstop_pin:i.z.string().optional(),y_step_pin:i.z.string().optional(),y_dir_pin:i.z.string().optional(),y_enable_pin:i.z.string().optional(),y_uart_pin:i.z.string().optional(),y_diag_pin:i.z.string().optional(),y_endstop_pin:i.z.string().optional(),y1_step_pin:i.z.string().optional(),y1_dir_pin:i.z.string().optional(),y1_enable_pin:i.z.string().optional(),y1_uart_pin:i.z.string().optional(),y1_diag_pin:i.z.string().optional(),y1_endstop_pin:i.z.string().optional(),y2_step_pin:i.z.string().optional(),y2_dir_pin:i.z.string().optional(),y2_enable_pin:i.z.string().optional(),y2_uart_pin:i.z.string().optional(),y2_diag_pin:i.z.string().optional(),y2_endstop_pin:i.z.string().optional(),z0_step_pin:i.z.string().optional(),z0_dir_pin:i.z.string().optional(),z0_enable_pin:i.z.string().optional(),z0_uart_pin:i.z.string().optional(),z0_diag_pin:i.z.string().optional(),z1_step_pin:i.z.string().optional(),z1_dir_pin:i.z.string().optional(),z1_enable_pin:i.z.string().optional(),z1_uart_pin:i.z.string().optional(),z1_diag_pin:i.z.string().optional(),z2_step_pin:i.z.string().optional(),z2_dir_pin:i.z.string().optional(),z2_enable_pin:i.z.string().optional(),z2_uart_pin:i.z.string().optional(),z2_diag_pin:i.z.string().optional(),z3_step_pin:i.z.string().optional(),z3_dir_pin:i.z.string().optional(),z3_enable_pin:i.z.string().optional(),z3_uart_pin:i.z.string().optional(),z3_diag_pin:i.z.string().optional(),e_step_pin:i.z.string().optional(),e_dir_pin:i.z.string().optional(),e_enable_pin:i.z.string().optional(),e_uart_pin:i.z.string().optional(),e_diag_pin:i.z.string().optional(),e_heater_pin:i.z.string().optional(),e_sensor_pin:i.z.string().optional(),stepper_spi_mosi_pin:i.z.string().optional(),stepper_spi_miso_pin:i.z.string().optional(),stepper_spi_sclk_pin:i.z.string().optional(),adxl345_cs_pin:i.z.string().optional(),bltouch_sensor_pin:i.z.string().optional(),bltouch_control_pin:i.z.string().optional(),probe_pin:i.z.string().optional(),fan_part_cooling_pin:i.z.string().optional(),fan_toolhead_cooling_pin:i.z.string().optional(),fan_controller_board_pin:i.z.string().optional(),heater_bed_heating_pin:i.z.string().optional(),heater_bed_sensor_pin:i.z.string().optional(),"4p_fan_part_cooling_pin":i.z.string().optional(),"4p_fan_part_cooling_tach_pin":i.z.string().optional(),"4p_toolhead_cooling_pin":i.z.string().optional(),"4p_toolhead_cooling_tach_pin":i.z.string().optional(),"4p_controller_board_pin":i.z.string().optional(),"4p_controller_board_tach_pin":i.z.string().optional()},s=i.z.object(l);(n=o||(o={})).x="x",n.x1="x1",n.y="y",n.y1="y1",n.y2="y2",n.z0="z0",n.z1="z1",n.z2="z2",n.z3="z3",n.e="e",n.e1="e1",n.dual_carriage="dual_carriage";let d={x:a.po.x,x1:a.po.x1,y:a.po.y,y1:a.po.y1,y2:a.po.y2,z0:a.po.z,z1:a.po.z1,z2:a.po.z2,z3:a.po.z3,e:a.po.extruder,e1:a.po.extruder1,dual_carriage:a.po.dual_carriage};i.z.nativeEnum(o).transform(e=>{var r;return null!==(r=d[e])&&void 0!==r?r:null}),i.z.nativeEnum(a.po).transform(e=>{var r;return null!==(r=Object.keys(d).find(r=>d[r]===e))&&void 0!==r?r:null}),s.extend({x_step_pin:i.z.string(),x_dir_pin:i.z.string(),x_enable_pin:i.z.string(),x_uart_pin:i.z.string(),x_endstop_pin:i.z.string(),y_step_pin:i.z.string(),y_dir_pin:i.z.string(),y_enable_pin:i.z.string(),y_uart_pin:i.z.string(),y_endstop_pin:i.z.string(),z0_step_pin:i.z.string(),z0_dir_pin:i.z.string(),z0_enable_pin:i.z.string(),z0_uart_pin:i.z.string(),e_step_pin:i.z.string(),e_dir_pin:i.z.string(),e_enable_pin:i.z.string(),e_uart_pin:i.z.string(),e_heater_pin:i.z.string(),e_sensor_pin:i.z.string(),probe_pin:i.z.string(),heater_bed_heating_pin:i.z.string(),heater_bed_sensor_pin:i.z.string()}).and(i.z.object({fan_part_cooling_pin:i.z.string(),fan_toolhead_cooling_pin:i.z.string()}).or(i.z.object({"4p_fan_part_cooling_pin":i.z.string(),"4p_fan_part_cooling_tach_pin":i.z.string(),"4p_toolhead_cooling_pin":i.z.string(),"4p_toolhead_cooling_tach_pin":i.z.string()}))),s.extend({x_step_pin:i.z.string(),x_dir_pin:i.z.string(),x_enable_pin:i.z.string(),x_uart_pin:i.z.string(),x_endstop_pin:i.z.string(),y_step_pin:i.z.string(),y_dir_pin:i.z.string(),y_enable_pin:i.z.string(),y_uart_pin:i.z.string(),y_endstop_pin:i.z.string(),z0_step_pin:i.z.string(),z0_dir_pin:i.z.string(),z0_enable_pin:i.z.string(),z0_uart_pin:i.z.string(),z1_step_pin:i.z.string(),z1_dir_pin:i.z.string(),z1_enable_pin:i.z.string(),z1_uart_pin:i.z.string(),z2_step_pin:i.z.string(),z2_dir_pin:i.z.string(),z2_enable_pin:i.z.string(),z2_uart_pin:i.z.string(),probe_pin:i.z.string(),heater_bed_heating_pin:i.z.string(),heater_bed_sensor_pin:i.z.string()}).and(i.z.object({fan_part_cooling_pin:i.z.string(),fan_toolhead_cooling_pin:i.z.string()}).or(i.z.object({"4p_fan_part_cooling_pin":i.z.string(),"4p_fan_part_cooling_tach_pin":i.z.string(),"4p_toolhead_cooling_pin":i.z.string(),"4p_toolhead_cooling_tach_pin":i.z.string()}))),s.extend({e_step_pin:i.z.string(),e_dir_pin:i.z.string(),e_enable_pin:i.z.string(),e_uart_pin:i.z.string(),e_heater_pin:i.z.string(),e_sensor_pin:i.z.string(),adxl345_cs_pin:i.z.string(),probe_pin:i.z.string()}).and(i.z.object({fan_part_cooling_pin:i.z.string(),fan_toolhead_cooling_pin:i.z.string()}).or(i.z.object({"4p_fan_part_cooling_pin":i.z.string(),"4p_fan_part_cooling_tach_pin":i.z.string(),"4p_toolhead_cooling_pin":i.z.string(),"4p_toolhead_cooling_tach_pin":i.z.string()})));let u=i.z.object({uart_pin:i.z.string(),uart_address:i.z.string().optional(),rx_pin:i.z.string().optional(),tx_pin:i.z.string().optional()}),c=i.z.object({cs_pin:i.z.string()}).and(i.z.object({spi_bus:i.z.string()}).or(i.z.object({spi_software_mosi_pin:i.z.string().optional(),spi_software_miso_pin:i.z.string().optional(),spi_software_sclk_pin:i.z.string().optional()}))),hasSPI=e=>c.safeParse(e).success,hasUART=e=>u.safeParse(e).success,p=i.z.object({step_pin:i.z.string(),dir_pin:i.z.string(),enable_pin:i.z.string(),diag_pin:i.z.string().optional(),endstop_pin:i.z.string().optional(),uart_pin:i.z.string().optional(),rx_pin:i.z.string().optional(),tx_pin:i.z.string().optional(),cs_pin:i.z.string().optional()}),g=p.extend({title:i.z.string(),uart_address:i.z.string().optional(),spi_bus:i.z.string().optional(),spi_software_mosi_pin:i.z.string().optional(),spi_software_miso_pin:i.z.string().optional(),spi_software_sclk_pin:i.z.string().optional()}).refine(e=>hasSPI(e)||hasUART(e),{message:"Motor slot must have either SPI or UART pins"});g.innerType().omit({title:!0}).partial();let f=i.z.string(),z=i.z.string().brand("BoardID"),_=i.z.string().brand("BoardPath"),b=i.z.string().brand("BoardSerialPath"),m=i.z.record(i.z.nativeEnum(a.po).or(i.z.string()),i.z.string()),h=i.z.record(f,g),v=i.z.object({id:z,isToolboard:i.z.boolean().optional(),isHost:i.z.boolean().optional(),serialPath:b.optional(),boardImageFileName:i.z.string().optional(),manualFileName:i.z.string().optional(),wireDiagramFileName:i.z.string().optional(),name:i.z.string(),manufacturer:i.z.string(),firmwareBinaryName:i.z.string(),compileScript:i.z.string(),flashScript:i.z.string().optional(),flashInstructions:i.z.string().optional(),disableAutoFlash:i.z.boolean().optional(),documentationLink:i.z.string().optional(),hasQuirksFiles:i.z.boolean().optional(),driverCount:i.z.number(),integratedDrivers:m.optional(),extruderlessConfig:i.z.string().optional(),fourPinFanConnectorCount:i.z.number().optional(),driverVoltages:a.v6.array().default([24]),hasMcuTempSensor:i.z.boolean().default(!0),alternativePT1000Resistor:i.z.number().optional(),motorSlots:i.z.record(f,g).optional(),outputPins:i.z.array(i.z.object({pin:i.z.string(),name:i.z.string(),value:i.z.number().min(0).max(1)})).optional(),dfu:i.z.object({dfuBootImage:i.z.string(),flashDevice:i.z.string(),instructions:i.z.array(i.z.string()),reminder:i.z.string().optional(),hasBoot0Jumper:i.z.boolean()}).optional(),stepperSPI:i.z.object({software:i.z.object({sclk:i.z.string(),mosi:i.z.string(),miso:i.z.string()})}).or(i.z.object({hardware:i.z.object({bus:i.z.string()})})).optional(),ADXL345SPI:i.z.object({cs_pin:i.z.string()}).and(i.z.object({software:i.z.object({sclk:i.z.string(),mosi:i.z.string(),miso:i.z.string()})}).or(i.z.object({hardware:i.z.object({bus:i.z.string()})}))).optional(),LIS2DW:i.z.object({cs_pin:i.z.string()}).and(i.z.object({software:i.z.object({sclk:i.z.string(),mosi:i.z.string(),miso:i.z.string()})}).or(i.z.object({hardware:i.z.object({bus:i.z.string()})}))).optional(),path:_}).and(i.z.object({isToolboard:i.z.literal(!0),motorSlots:i.z.undefined()}).or(i.z.object({motorSlots:h})).or(i.z.object({isHost:i.z.literal(!0),motorSlots:i.z.undefined()})));v.and(i.z.object({detected:i.z.boolean()})),i.z.object({id:i.z.string(),disableAutoFlash:i.z.literal(!1).optional(),isToolboard:i.z.boolean().optional(),compileScript:i.z.string(),flashScript:i.z.string(),path:_});let y=v.and(i.z.object({isToolboard:i.z.literal(!0),isHost:i.z.literal(!1).optional(),integratedDrivers:m.and(i.z.object({[a.po.extruder]:i.z.string()}))}));y.and(i.z.object({detected:i.z.boolean()}))},18954:function(e,r,t){"use strict";t.d(r,{M3:function(){return h},Mf:function(){return c},U3:function(){return f},U9:function(){return v},Uy:function(){return p},XG:function(){return y},Yx:function(){return b},lV:function(){return z},ow:function(){return g},ws:function(){return _}});var n=t(94594),o=t(64475),i=t(1314),a=t(39634),l=t(28070);let s=["EPCOS 100K B57560G104F","ATC Semitec 104GT-2","ATC Semitec 104NT-4-R025H42G","Generic 3950","Honeywell 100K 135-104LAG-J01","NTC 100K MGB18-104F39050L32","SliceEngineering 450","TDK NTCG104LH104JT1","PT1000"],d="";if(l.env.RATOS_CONFIGURATION_PATH){let e=o.Rz.parse(l.env);d=e.RATOS_CONFIGURATION_PATH}let u=n.z.object({path:n.z.string().startsWith(d).endsWith(".cfg"),id:n.z.string()}),c=n.z.enum(s),p=u.extend({type:n.z.literal("hotend"),title:n.z.string(),thermistor:n.z.enum(s),flowType:n.z.union([n.z.literal("sf"),n.z.literal("hf"),n.z.literal("uhf")])}),g=n.z.object({type:n.z.enum(["Regular","CHT"]),diameter:n.z.number().min(.2).max(1.8)}),f=u.extend({type:n.z.literal("extruder"),stepper:i.vF.shape.id.optional(),current:i.P6.shape.current.optional(),title:n.z.string()}),z=u.extend({type:n.z.literal("static-probe").or(n.z.literal("stowable-probe")),title:n.z.string()}),_=n.z.object({id:n.z.enum(["endstop","endstop-toolboard","sensorless"]),title:n.z.string(),badge:n.z.array(n.z.object({children:n.z.string(),color:a.Bd})).optional()}),b=n.z.union([n.z.literal("toolboard_t0"),n.z.literal("toolboard_t1"),n.z.literal("controlboard"),n.z.literal("rpi"),n.z.literal("beacon")]),m=n.z.union([n.z.literal("adxl345"),n.z.literal("lis2dw"),n.z.literal("beacon")]),h=n.z.object({id:n.z.enum(["toolboard","controlboard","sbc","none","beacon"]),title:n.z.string(),accelerometerType:m.default("adxl345").optional()}),v=n.z.object({name:b,type:m});h.extend({accelerometerType:m});let y=n.z.object({id:n.z.enum(["2pin","4pin","4pin-dedicated","2pin-toolboard","4pin-toolboard","4pin-dedicated-toolboard","none"]),title:n.z.string(),badge:n.z.array(n.z.object({children:n.z.string(),color:a.Bd})).optional()})},1314:function(e,r,t){"use strict";t.d(r,{Ah:function(){return b},HB:function(){return u},JQ:function(){return _},P6:function(){return f},R_:function(){return matchesDefaultRail},Wx:function(){return getSupportedVoltages},g6:function(){return g},po:function(){return a},r:function(){return z},v6:function(){return d},vF:function(){return p}});var n,o,i,a,l=t(94594);(n=i||(i={}))[n["24V"]=24]="24V",n[n["36V"]=36]="36V",n[n["48V"]=48]="48V",n[n["56V"]=56]="56V",n[n["60V"]=60]="60V";let s=[{id:24,title:"24V"},{id:36,title:"36V"},{id:48,title:"48V"},{id:56,title:"56V"},{id:60,title:"60V"}],getSupportedVoltages=(e,r)=>(null==r?void 0:r.external)?s.filter(e=>{var t;return(null==r?void 0:null===(t=r.voltages)||void 0===t?void 0:t.includes(e.id))||24===e.id}):s.filter(r=>{var t;return(null==e?void 0:null===(t=e.driverVoltages)||void 0===t?void 0:t.includes(r.id))||24===r.id}).filter(e=>{var t;return(null==r?void 0:null===(t=r.voltages)||void 0===t?void 0:t.includes(e.id))||24===e.id}),matchesDefaultRail=(e,r,t)=>{var n,o;return e.axis===r.axis&&e.driver.id===r.driver.id&&e.stepper.id===r.stepper.id&&(t&&r.performanceMode&&e.voltage===(null===(n=r.performanceMode)||void 0===n?void 0:n.voltage)&&e.current===(null===(o=r.performanceMode)||void 0===o?void 0:o.current)||!t&&e.voltage===r.voltage&&e.current===r.current)},d=l.jb(i),u=l.Ry({id:l.Z_(),title:l.Z_(),type:l.Km(["TMC2209","TMC2226","TMC5160","TMC2130","TMC2240"]),protocol:l.Km(["SPI","UART"]),senseResistor:l.Rx().min(0),coolingCurrentThreshold:l.Rx(),voltages:d.array(),maxCurrent:l.Rx().min(0),external:l.O7().optional()}),c=l.Ry({voltage:d,run_current:l.Rx(),driver:u.shape.id,sense_resistor:l.Rx()}),p=l.Ry({id:l.Z_(),title:l.Z_(),fullStepsPerRotation:l.Rx().default(200),maxPeakCurrent:l.Rx().min(0),presets:l.IX(l.VK("driver",[c.extend({driver:l.Km(["TMC2130","TMC5160","TMC2240"]),driver_MSLUT0:l.Rx().optional(),driver_MSLUT1:l.Rx().optional(),driver_MSLUT2:l.Rx().optional(),driver_MSLUT3:l.Rx().optional(),driver_MSLUT4:l.Rx().optional(),driver_MSLUT5:l.Rx().optional(),driver_MSLUT6:l.Rx().optional(),driver_MSLUT7:l.Rx().optional(),driver_W0:l.Rx().optional(),driver_W1:l.Rx().optional(),driver_W2:l.Rx().optional(),driver_W3:l.Rx().optional(),driver_X1:l.Rx().optional(),driver_X2:l.Rx().optional(),driver_X3:l.Rx().optional(),driver_START_SIN:l.Rx().optional(),driver_START_SIN90:l.Rx().optional(),driver_IHOLDDELAY:l.Rx().optional(),driver_TPOWERDOWN:l.Rx().optional(),driver_TBL:l.Rx().optional(),driver_TOFF:l.Rx().optional(),driver_HEND:l.Rx().optional(),driver_HSTRT:l.Rx().optional(),driver_PWM_AUTOSCALE:l.O7().optional(),driver_PWM_FREQ:l.Rx().optional(),driver_PWM_GRAD:l.Rx().optional(),driver_PWM_AMPL:l.Rx().optional(),driver_SGT:l.Rx().optional()}),c.extend({driver:l.Km(["TMC2209"]),driver_TBL:l.Rx().optional(),driver_TOFF:l.Rx().optional(),driver_HEND:l.Rx().optional(),driver_HSTRT:l.Rx().optional()})])).optional().describe("Stepper presets are tightly coupled to the driver type, sense_resistor, stepper, voltage and current.")});(o=a||(a={})).x="x",o.dual_carriage="dual_carriage",o.x1="x1",o.y="y",o.y1="y1",o.y2="y2",o.z="z",o.z1="z1",o.z2="z2",o.z3="z3",o.extruder="extruder",o.extruder1="extruder1";let g=l.Ry({axis:l.jb(a).describe("Axis of the rail"),axisDescription:l.Z_().optional().describe("Description of the axis"),driver:u.describe("Stepper driver used on this axis"),voltage:d.default(24).describe("Voltage of the stepper driver"),stepper:p.describe("Stepper motor connected to this axis"),invertStepperDirection:l.O7().default(!1).describe("Invert the default direction of the stepper motor"),axisMinimum:l.Rx().optional().describe("Minimum position of the axis in mm"),axisMaximum:l.Rx().optional().describe("Maximum position of the axis in mm"),axisEndstop:l.Rx().optional().describe("Endstop position of the axis in mm"),motorSlot:l.Z_().optional().describe("Optional board motor slot of the stepper driver"),current:l.Rx().min(0),rotationDistance:l.Rx().min(0).describe("Distance in mm the axis travels per stepper rotation"),gearRatio:l.Z_().regex(/^\d+:\d+$/).optional().describe("Optional gear ratio of the axis"),homingSpeed:l.Rx().min(0).default(10).describe("Axis speed during homing in mm/s"),microstepping:l.Rx().min(16).max(256).default(64).describe("Microstepping of the stepper driver, higher values increase resolution and lower noise but increases load on the MCU")}),f=g.extend({motorSlot:l.S1(),performanceMode:l.Ry({current:l.Rx().min(0),voltage:d.default(24).describe("Voltage of the stepper driver in performance mode"),homingSpeed:l.Rx().min(0).optional().describe("Axis speed during homing in mm/s in performance mode")}).optional()}),z=f.extend({driver:u.shape.id,stepper:p.shape.id}),_=g.refine(e=>e.current<=e.driver.maxCurrent,"Current must be less than max current of the driver"),b=g.extend({driver:u.shape.id,stepper:p.shape.id});l.Ry({min:l.Rx(),max:l.Rx(),endstop:l.Rx()})},61968:function(e,r,t){"use strict";t.d(r,{LN:function(){return u},NN:function(){return z},dl:function(){return p},jz:function(){return f},q_:function(){return g}});var n=t(83907),o=t(18954),i=t(91831),a=t(1314),l=t(22595),s=t(11974),d=t(94594);let u=d.z.union([i.A5,d.z.number(),d.z.string()]).nullable().optional(),c=d.z.object({printer:i.Qu,controlboard:n.$l,toolheads:d.z.array(l.x8).min(1).max(2),size:u,controllerFan:o.XG,performanceMode:d.z.boolean().default(!1),stealthchop:d.z.boolean().default(!1),standstillStealth:d.z.boolean().default(!1),rails:d.z.array(a.JQ)}).strict().transform((e,r)=>{if(null==e.size)e.size=e.printer.sizes[Object.keys(e.printer.sizes)[0]];else if("number"==typeof e.size||"string"==typeof e.size){let t=e.printer.sizes[e.size.toString()];if(null==t)return r.addIssue({code:d.z.ZodIssueCode.custom,message:"Size ".concat(e.size," is not a valid size for a ").concat(e.printer.name," config")}),d.z.NEVER;e.size=t}return e}),p=c.superRefine((e,r)=>{let t=e.toolheads.map(e=>e.toolboard).filter(Boolean).length;t+e.controlboard.driverCount<e.printer.driverCountRequired&&r.addIssue({code:d.z.ZodIssueCode.too_small,message:"Your combination of controlboard and toolboards do not have enough stepper drivers for a ".concat(e.printer.name," config"),minimum:e.printer.driverCountRequired,inclusive:!0,type:"number"})}).superRefine((e,r)=>{let t=e.toolheads.map(e=>new s.D(e)),n=e.rails.map((n,o)=>{let i=t.find(e=>e.getExtruderAxis()===n.axis);if(null!=n.motorSlot){let l=e.rails.filter(e=>{let r=t.find(r=>r.getExtruderAxis()===e.axis);return e.axis!==n.axis&&(null==i?void 0:i.hasToolboard())==null&&(null==r?void 0:r.hasToolboard)==null&&e.motorSlot===n.motorSlot}),railName=e=>"extruder"===e?"Extruder T0":e===a.po.extruder1?"Extruder T1":"Stepper "+e.toLocaleUpperCase();return 1===l.length?r.addIssue({code:d.z.ZodIssueCode.custom,message:"Motor slot ".concat(n.motorSlot," is already in use on ").concat(railName(l[0].axis)),path:["rails",o,"motorSlot"]}):l.length>1&&r.addIssue({code:d.z.ZodIssueCode.custom,message:"Motor slot ".concat(n.motorSlot," is already in use on ").concat(l.slice(0,-1).map(e=>railName(e.axis)).join(", ")," and ").concat(railName(l[l.length-1].axis)),path:["rails",o,"motorSlot"]}),l.length>0?{rail:n,conflicts:l}:0}return null}).filter(Boolean);n.length>0&&r.addIssue({code:d.z.ZodIssueCode.custom,message:"Motor slot conflicts detected"})}),g=c.innerType().extend({printer:i.Qu.shape.id,controlboard:n.WQ,toolheads:d.z.array(l.Qk).min(1).max(2),controllerFan:o.XG.shape.id,rails:d.z.array(a.Ah)}).strict(),f=c.innerType().extend({toolheads:d.z.array(l.b2).min(1).max(2)}).strict().partial().optional(),z=g.extend({toolheads:d.z.array(l.ZF).min(1).max(2)}).strict().partial()},91831:function(e,r,t){"use strict";t.d(r,{A5:function(){return f},Ox:function(){return _},Qu:function(){return z}});var n=t(94594),o=t(64475),i=t(82211),a=t.n(i),l=t(1314),s=t(22595),d=t(18954),u=t(83907),c=t(28070);let p="";if(c.env.RATOS_CONFIGURATION_PATH){let e=o.Rz.parse(c.env);p=a().join(e.RATOS_CONFIGURATION_PATH,"printers")}let g=n.z.object({velocity:n.z.number().min(0).describe("Maximum velocity for this printer"),accel:n.z.number().min(0).describe("Maximum acceleration for this printer"),z_velocity:n.z.number().min(0).describe("Maximum z velocity for this printer"),z_accel:n.z.number().min(0).describe("Maximum z acceleration for this printer"),square_corner_velocity:n.z.number().min(0).default(5).describe("Maximum square corner velocity for this printer"),travel_velocity:n.z.number().min(0).default(200).describe("Maximum travel velocity for this printer"),travel_accel:n.z.number().min(0).default(3e3).describe("Maximum travel velocity for this printer")}).strict(),f=n.z.object({x:n.z.number().min(0).describe("The print volume in X"),y:n.z.number().min(0).describe("The print volume in Y"),z:n.z.number().min(0).describe("The print volume in Z")}).describe("The print volume of a printer"),z=n.z.object({id:n.z.string().transform(e=>"caramba-chonk"===e?"v-chonk":e.startsWith("caramba-")?e.replace("caramba-","v-core-4-"):e),name:n.z.string().describe("The name of the printer"),releaseDate:n.z.string().optional().describe("The release date of the printer in ISO 8601/RFC3339 eg. 2023-12-31"),description:n.z.string().describe("A description of the printer"),manufacturer:n.z.string().describe("The name of the manufacturer of this printer"),documentationLink:n.z.string().describe("Link to the RatOS documentation for this printer"),image:n.z.string().describe("Link to an image of the printer"),sizes:n.z.record(n.z.string(),f).describe("Size options for this printer"),template:n.z.string().describe("Printer.cfg template for this printer"),path:n.z.string().startsWith(p),driverCountRequired:n.z.number().describe("Number of drivers required for this printer"),kinematics:n.z.union([n.z.literal("cartesian"),n.z.literal("corexy"),n.z.literal("hybrid-corexy"),n.z.literal("hybrid-corexy-idex")]).optional(),bedMargin:n.z.object({x:n.z.tuple([n.z.number().default(0),n.z.number().default(0)]),y:n.z.tuple([n.z.number().default(0),n.z.number().default(0)])}).describe("Margin of available movement around the bed for this printer").default({x:[0,0],y:[0,0]}),speedLimits:n.z.object({basic:g,performance:g.optional()}).strict().describe("Speed limits for this printer"),defaults:n.z.object({toolheads:n.z.array(s.Qk).describe("Default toolheads for this printer"),board:u.WQ.describe("Default board for this printer. Should be the name of the board directory."),rails:n.z.array(l.r).describe("Default rails for this printer"),controllerFan:d.XG.shape.id.optional().describe("Default controller fan for this printer")}).strict().describe("Default hardware for this printer")}).describe("A RatOS supported 3d printer"),_=z.extend({defaults:z.shape.defaults.extend({toolheads:n.z.array(s.x8)}).strict()})},22595:function(e,r,t){"use strict";t.d(r,{PY:function(){return s},Qk:function(){return g},Qr:function(){return d},ZF:function(){return f},b2:function(){return p},x8:function(){return c}});var n=t(94594),o=t(83907),i=t(18954),a=t(1314),l=t(65878);let s=n.z.object({hotend:i.Uy,thermistor:i.Mf,extruder:i.U3,xEndstop:i.ws,yEndstop:i.ws,hotendFan:i.XG,partFan:i.XG,nozzle:i.ow.default((0,l.S)()),xAccelerometer:i.M3.optional().nullable(),yAccelerometer:i.M3.optional().nullable(),toolboard:o.MG.nullable(),probe:i.lV.optional(),axis:n.z.literal(a.po.x).or(n.z.literal(a.po.dual_carriage)),description:n.z.string().optional(),toolNumber:n.z.number().optional()}).strict(),d=n.z.union([n.z.literal(0),n.z.literal(1)]),u=n.z.union([n.z.literal(a.po.x),n.z.literal(a.po.dual_carriage),n.z.literal(a.po.extruder),n.z.literal(a.po.extruder1)]);n.z.union([u,d]);let c=s.refine(e=>null!==e.toolboard||"endstop-toolboard"!==e.xEndstop.id,"Cannot use toolboard endstop without a toolboard").refine(e=>null!==e.toolboard||!["2pin-toolboard","4pin-toolboard","4pin-dedicated-toolboard"].includes(e.hotendFan.id),"Cannot use toolboard hotend fan without a toolboard").refine(e=>null!==e.toolboard||!["2pin-toolboard","4pin-toolboard","4pin-dedicated-toolboard"].includes(e.partFan.id),"Cannot use toolboard part cooling fan without a toolboard"),p=s.partial().optional(),g=s.extend({hotend:i.Uy.shape.id,extruder:i.U3.shape.id,thermistor:i.Mf,xEndstop:i.ws.shape.id,yEndstop:i.ws.shape.id,hotendFan:i.XG.shape.id,partFan:i.XG.shape.id,xAccelerometer:i.M3.shape.id.optional().nullable(),yAccelerometer:i.M3.shape.id.optional().nullable(),toolboard:o.WQ.optional().nullable(),probe:i.lV.shape.id.optional().nullable()}).strict(),f=g.partial().optional()},31354:function(e,r,t){"use strict";t.d(r,{s:function(){return i}});var n=t(94594);let o=n.z.enum(["trace","debug","info","warn","error","fatal"]),i=n.z.object({ts:n.z.number(),messages:n.z.array(n.z.any()),bindings:n.z.array(n.z.record(n.z.string(),n.z.any())),level:n.z.object({label:o,value:n.z.number()})})},64475:function(e,r,t){"use strict";t.d(r,{Rz:function(){return o}});var n=t(94594);let o=n.z.object({NODE_ENV:n.z.enum(["development","test","production"]),RATOS_CONFIGURATION_PATH:n.z.string(),RATOS_SCRIPT_DIR:n.z.string(),KLIPPER_CONFIG_PATH:n.z.string(),KLIPPER_DIR:n.z.string(),KLIPPER_ENV:n.z.string(),MOONRAKER_DIR:n.z.string(),LOG_FILE:n.z.string(),RATOS_DATA_DIR:n.z.string()});n.z.object({NEXT_PUBLIC_KLIPPER_HOSTNAME:n.z.string().optional()})}}]);
//# sourceMappingURL=2345-ef26f4512ecf2c98.js.map