(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{65660:function(){},87473:function(e,t,r){"use strict";r.r(t),r.d(t,{Redirecter:function(){return Redirecter},useIsRouteActive:function(){return useIsRouteActive},useLocalPathname:function(){return useLocalPathname},useNavigation:function(){return useNavigation}});var n=r(61405),i=r(67492),o=r(15933),a=r(33760),l=r(49738);let useLocalPathname=()=>{var e;let t=(null!==(e=(0,a.usePathname)())&&void 0!==e?e:"/").replace("/configure","");return t},useIsRouteActive=()=>{let e=useLocalPathname();return(0,l.useCallback)(t=>e===t,[e])},s=[{name:"Setup Wizard",href:"/wizard",current:!1,icon:n},{name:"Dashboard",href:"/",current:!1,icon:i},{name:"Visual Calibration",href:"/calibration",current:!1,icon:o}],useNavigation=()=>{let e=useIsRouteActive();return s.map(t=>(t.current=e(t.href),t))},Redirecter=e=>{let t=(0,a.useRouter)(),r=useIsRouteActive();if(e.hasLastPrinterSettings||r("/wizard"))return e.children;t.replace("/wizard")}},72931:function(e,t,r){"use strict";r.d(t,{YG:function(){return SyncWithMoonraker},rR:function(){return moonrakerWriteEffect}});var n=r(26248),i=r(49738),o=r(61352),a=r(83587),l=r(55797);let s=new EventTarget,DispatchSaveAtomEvent=(e,t)=>{s.dispatchEvent(new CustomEvent("saveAtom",{detail:{itemKey:e,value:t}}))},moonrakerWriteEffect=()=>e=>{e.onSet(t=>{console.debug('RatOS Atom Sync Effect: new value was saved to moonraker "'.concat(e.trigger,'"'),e.node.key,t),DispatchSaveAtomEvent(e.node.key,null==t?"null":t)})},SyncWithMoonraker=e=>{let{children:t}=e,r=(0,o.oK)(),d=(0,i.useCallback)(async e=>{let t=await r.getItem("RatOS",e);return null!=t&&"null"!=t?t:new l.nY},[r]),u=(0,i.useCallback)(async e=>{let{itemKey:t,value:n}=e.detail;await r.saveItem("RatOS",t,n)},[r]);return(0,i.useEffect)(()=>(s.addEventListener("saveAtom",u),()=>{s.removeEventListener("saveAtom",u)}),[u]),(0,n.jsx)(a.J1,{read:d,children:t})}},96099:function(e,t,r){"use strict";r.d(t,{N:function(){return o}});var n=r(94594),i=r(78185);let o=n.z.array(i.HB).parse([{id:"BTT-TMC2209-13",title:"BTT TMC2209 v1.3",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"BTT-TMC2226-10",title:"BTT TMC2226 v1.0",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"BTT-TMC5160-PRO-11",title:"BTT TMC5160(T) Pro v1.1",type:"TMC5160",protocol:"SPI",senseResistor:.075,voltages:[24,36,48,56],maxCurrent:3,coolingCurrentThreshold:1.5},{id:"BTT-TMC5160T-PLUS-10",title:"BTT TMC5160T Plus v1.0",type:"TMC5160",protocol:"SPI",senseResistor:.022,voltages:[24,36,48,56,60],maxCurrent:10.6,coolingCurrentThreshold:3,external:!0},{id:"BTT-EZ2209",title:"BTT EZ2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.3,voltages:[24],maxCurrent:2},{id:"BTT-EZ2226",title:"BTT EZ2226",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.3,voltages:[24],maxCurrent:2},{id:"BTT-EZ2130",title:"BTT EZ2130",type:"TMC2130",protocol:"SPI",senseResistor:.11,coolingCurrentThreshold:.9,voltages:[24],maxCurrent:2},{id:"BTT-EZ5160-PRO",title:"BTT EZ5160 Pro",type:"TMC5160",protocol:"SPI",senseResistor:.075,coolingCurrentThreshold:1.6,voltages:[24,36,48],maxCurrent:2.5},{id:"BTT-EZ5160-RGB",title:"BTT EZ5160 RGB",type:"TMC5160",protocol:"SPI",senseResistor:.05,coolingCurrentThreshold:3,voltages:[24,48,36,56],maxCurrent:4.7},{id:"MELLOW-FLY-HV-TMC5160-PRO-12",title:"Mellow FLY HV TMC5160 Pro v1.2",type:"TMC5160",protocol:"SPI",senseResistor:.033,coolingCurrentThreshold:3,voltages:[24,36,48],maxCurrent:4.25,external:!0},{id:"MELLOW-FLY-TMC2209",title:"Mellow FLY TMC2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2},{id:"PRUSA-EINSY-RAMBO-TMC2130",title:"Prusa Einsy Rambo TMC2130",type:"TMC2130",protocol:"SPI",senseResistor:.22,coolingCurrentThreshold:.9,voltages:[24],maxCurrent:2},{id:"PRUSA-BUDDY-TMC2209",title:"Prusa Buddy TMC2209",type:"TMC2209",protocol:"UART",senseResistor:.11,coolingCurrentThreshold:1.1,voltages:[24],maxCurrent:2}])},31667:function(e,t,r){"use strict";r.d(t,{Yo:function(){return hotendFanOptions},gL:function(){return partFanOptions},z2:function(){return i}});var n=r(78185);let partFanOptions=(e,t)=>{var r;let i=[];return(null==t||(null==t?void 0:t.axis)===n.po.x||(null==t?void 0:t.axis)===null)&&(i.push({id:"2pin",title:"2-pin fan"}),i.push({id:"4pin",title:"4-pin fan"})),(null==e?void 0:null===(r=e.controlboard)||void 0===r?void 0:r.fourPinFanConnectorCount)!=null&&e.controlboard.fourPinFanConnectorCount>0&&i.push({id:"4pin-dedicated",title:"4-pin fan (dedicated 4-pin header)"}),(null==t?void 0:t.toolboard)!=null&&(i.push({id:"2pin-toolboard",title:"2-pin toolboard fan"}),i.push({id:"4pin-toolboard",title:"4-pin toolboard fan"}),(null==t?void 0:t.toolboard.fourPinFanConnectorCount)!=null&&t.toolboard.fourPinFanConnectorCount>0&&i.push({id:"4pin-dedicated-toolboard",title:"4-pin fan (dedicated 4-pin header on toolboard)"})),i},hotendFanOptions=(e,t)=>{var r,i,o;let a=[];return(null==t||(null==t?void 0:t.axis)===n.po.x)&&(a.push({id:"2pin",title:"2-pin fan"}),a.push({id:"4pin",title:"4-pin fan"})),((null==e?void 0:null===(r=e.controlboard)||void 0===r?void 0:r.fourPinFanConnectorCount)!=null&&e.controlboard.fourPinFanConnectorCount>2||(null==e?void 0:null===(i=e.controlboard)||void 0===i?void 0:i.fourPinFanConnectorCount)!=null&&e.controlboard.fourPinFanConnectorCount>1&&(null===(o=e.controllerFan)||void 0===o?void 0:o.id)!=="4pin-dedicated")&&a.push({id:"4pin-dedicated",title:"4-pin fan (dedicated 4-pin header)"}),(null==t?void 0:t.toolboard)!=null&&(a.push({id:"2pin-toolboard",title:"2-pin toolboard fan"}),a.push({id:"4pin-toolboard",title:"4-pin toolboard fan"}),(null==t?void 0:t.toolboard.fourPinFanConnectorCount)!=null&&t.toolboard.fourPinFanConnectorCount>0&&a.push({id:"4pin-dedicated-toolboard",title:"4-pin fan (dedicated 4-pin header on toolboard)"})),a},i={id:"2pin",title:"2-pin fan"}},12064:function(e,t,r){"use strict";r.d(t,{S:function(){return getDefaultNozzle}});let getDefaultNozzle=()=>({diameter:.4,type:"Regular"})},39140:function(e,t,r){"use strict";r.d(t,{B:function(){return o},a:function(){return findPreset}});var n=r(94594),i=r(78185);let findPreset=(e,t,r,n,i)=>{var o;return null===(o=e.presets)||void 0===o?void 0:o.slice().sort((e,t)=>i?t.run_current-e.run_current:e.run_current-t.run_current).find(e=>e.driver===t.type&&e.voltage===r&&e.sense_resistor===t.senseResistor&&(null==n||e.run_current===n))},o=n.z.array(i.vF).parse([{id:"generic",title:"Generic Stepper",maxPeakCurrent:2.8},{id:"BONDTECH-42H025H-0704-002",title:"Bondtech LGX Stepper",maxPeakCurrent:.7},{id:"LDO-42STH48-2504AC",title:"LDO-42STH48-2504AC",maxPeakCurrent:2.5,presets:[{run_current:1.1,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:1,driver_TOFF:3,driver_HEND:0,driver_HSTRT:0},{run_current:1.6,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:2,driver_TOFF:3,driver_HEND:0,driver_HSTRT:6},{run_current:1.6,voltage:24,driver:"TMC5160",sense_resistor:.075,driver_TBL:2,driver_TOFF:3,driver_HEND:0,driver_HSTRT:6},{run_current:1.768,voltage:48,driver:"TMC5160",sense_resistor:.075,driver_TBL:0,driver_TOFF:4,driver_HEND:0,driver_HSTRT:4}]},{id:"LDO-42STH40-1684AC",title:"LDO-42STH40-1684AC",maxPeakCurrent:1.68,presets:[{run_current:.4,voltage:24,driver:"TMC2130",sense_resistor:.22,driver_IHOLDDELAY:8,driver_TPOWERDOWN:0,driver_TBL:2,driver_TOFF:3,driver_HEND:1,driver_HSTRT:5,driver_PWM_FREQ:2,driver_PWM_GRAD:2,driver_PWM_AMPL:230,driver_PWM_AUTOSCALE:!0,driver_SGT:5},{run_current:.52,voltage:24,driver:"TMC2130",sense_resistor:.22,driver_IHOLDDELAY:8,driver_TPOWERDOWN:0,driver_TBL:2,driver_TOFF:3,driver_HEND:1,driver_HSTRT:5,driver_PWM_FREQ:2,driver_PWM_GRAD:4,driver_PWM_AMPL:240,driver_PWM_AUTOSCALE:!0,driver_SGT:3},{run_current:.8,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:1,driver_TOFF:3,driver_HEND:3,driver_HSTRT:0},{run_current:1.188,voltage:24,driver:"TMC2209",sense_resistor:.11,driver_TBL:0,driver_TOFF:3,driver_HEND:0,driver_HSTRT:0}]},{id:"LDO-42STH48-2004MAH",title:"LDO-42STH48-2004MAH",maxPeakCurrent:2,fullStepsPerRotation:400},{id:"LDO-42STH48-2004AC",title:"LDO-42STH48-2004AC",maxPeakCurrent:2},{id:"LDO-42STH25-1404MAC",title:"LDO-42STH25-1404MAC",maxPeakCurrent:1.4,fullStepsPerRotation:400,presets:[{voltage:24,driver:"TMC2209",sense_resistor:.11,run_current:.85,driver_TBL:1,driver_TOFF:3,driver_HEND:2,driver_HSTRT:0}]},{id:"LDO-42STH25-1004CL200E",title:"LDO-42STH25-1004CL200E",maxPeakCurrent:1},{id:"LDO-36STH20-1004AHG",title:"LDO-36STH20-1004AHG",maxPeakCurrent:1,presets:[{voltage:24,driver:"TMC2209",sense_resistor:.11,run_current:.707,driver_TBL:0,driver_HEND:6,driver_HSTRT:7,driver_TOFF:4}]},{id:"LDO-36STH17-1004AHG",title:"LDO-36STH17-1004AHG",maxPeakCurrent:1},{id:"LDO-35STH48-1684AH",title:"LDO-35STH48-1684AH",maxPeakCurrent:1.68}])},51758:function(e,t,r){"use strict";r.d(t,{D:function(){return ToolheadHelper}});var n=r(97370),i=r(78185),o=r(89553),a=r(12064),l=r(86736),s=r.n(l);let ToolheadHelper=class ToolheadHelper{hasToolboard(){return null!=this.config.toolboard}getToolboard(){return this.config.toolboard}getMotionStepperName(){return this.config.axis===i.po.dual_carriage?"dual_carriage":"stepper_".concat(this.getMotionAxis())}getToolboardName(){if(null==this.config.toolboard)throw Error("Toolhead T".concat(this.getTool()," does not have a toolboard"));return"toolboard_".concat(this.getShortToolName())}getShortToolName(){return"t".concat(this.getTool())}getDescription(){var e;return null!==(e=this.config.description)&&void 0!==e?e:"the printer's toolhead"}getMotionAxis(){return this.config.axis===i.po.dual_carriage?i.po.dual_carriage:i.po.x}getExtruderAxis(){return this.config.axis===i.po.dual_carriage?i.po.extruder1:i.po.extruder}getToolCommand(){return"T".concat(this.getTool())}getTool(){return this.config.axis===i.po.dual_carriage?1:0}getSerialSuffix(){return"t".concat(this.getTool())}getExtruder(){return this.config.extruder}getHotend(){return this.config.hotend}getNozzle(){var e;return null!==(e=this.config.nozzle)&&void 0!==e?e:(0,a.S)()}getThermistor(){return this.config.thermistor}getXEndstop(){return this.config.xEndstop}getYEndstop(){return this.config.yEndstop}getXAccelerometer(){return this.config.xAccelerometer}getYAccelerometer(){return this.config.yAccelerometer}getXAccelerometerName(){var e;switch(null===(e=this.getXAccelerometer())||void 0===e?void 0:e.id){case"controlboard":return"controlboard";case"toolboard":if(this.hasToolboard())return this.getToolboardName();case"sbc":return"rpi";default:return"controlboard"}}getYAccelerometerName(){var e;switch(null===(e=this.getYAccelerometer())||void 0===e?void 0:e.id){case"controlboard":return"controlboard";case"toolboard":if(this.hasToolboard())return this.getToolboardName();case"sbc":return"rpi";default:return"controlboard"}}getChangeSet(e){if(null==e)return null;let t={};Object.keys(e).forEach(r=>{let n=this.getConfig()[r],i=e[r];if(null!=n&&null==i||null==n&&null!=i){t[r]=i;return}n&&i&&("object"==typeof n&&"id"in n&&"object"==typeof i&&"id"in i?n.id!==i.id&&(t[r]=i):s()(n,i)||(t[r]=i))});let r=o.b2.safeParse(t);return r}getProbe(){return this.config.probe}getPartFan(){return this.config.partFan}getHotendFan(){return this.config.hotendFan}serialize(){return(0,n.m6)(this.config)}getConfig(){return{...this.config}}constructor(e){this.config=e}}},29565:function(e,t,r){"use strict";r.d(t,{S:function(){return n.SX},u:function(){return n.uF}});var n=r(64918)},85954:function(e,t,r){"use strict";r.r(t),r.d(t,{ControllerFanState:function(){return P},LoadablePrinterConfigurationState:function(){return M},PerformanceModeState:function(){return R},PrinterConfigurationState:function(){return A},StandstillStealthState:function(){return y},StealthchopState:function(){return S},serializePartialPrinterConfiguration:function(){return serializePartialPrinterConfiguration},serializePrinterConfiguration:function(){return serializePrinterConfiguration},usePrinterConfiguration:function(){return usePrinterConfiguration},useSerializedPrinterConfiguration:function(){return useSerializedPrinterConfiguration}});var n=r(55797),i=r(94594),o=r(21899),a=r(79438),l=r(2134),s=r(78185),d=r(89553),u=r(51758);let p=i.z.object({printer:l.Q,controlboard:a.$l,toolheads:i.z.array(d.x8).min(1).max(2),size:i.z.number().optional().nullable(),controllerFan:o.XG,performanceMode:i.z.boolean().default(!1),stealthchop:i.z.boolean().default(!1),standstillStealth:i.z.boolean().default(!1),rails:i.z.array(s.JQ)}).strict(),c=p.superRefine((e,t)=>{if(null!=e.size){var r;let n=null!==(r=e.printer.sizes)&&void 0!==r?r:[];n.includes(e.size)||t.addIssue({code:i.z.ZodIssueCode.custom,message:"Size ".concat(e.size," is not a valid size for a ").concat(e.printer.name," config")})}else null!=e.printer.sizes&&e.printer.sizes.length>0&&t.addIssue({code:i.z.ZodIssueCode.custom,message:"Size is required for a ".concat(e.printer.name," config")})}).superRefine((e,t)=>{let r=e.toolheads.map(e=>e.toolboard).filter(Boolean).length;r+e.controlboard.driverCount<e.printer.driverCountRequired&&t.addIssue({code:i.z.ZodIssueCode.too_small,message:"Your combination of controlboard and toolboards do not have enough stepper drivers for a ".concat(e.printer.name," config"),minimum:e.printer.driverCountRequired,inclusive:!0,type:"number"})}).superRefine((e,t)=>{let r=e.toolheads.map(e=>new u.D(e)),n=e.rails.map((n,o)=>{let a=r.find(e=>e.getExtruderAxis()===n.axis);if(null!=n.motorSlot){let l=e.rails.filter(e=>{let t=r.find(t=>t.getExtruderAxis()===e.axis);return e.axis!==n.axis&&(null==a?void 0:a.hasToolboard())==null&&(null==t?void 0:t.hasToolboard)==null&&e.motorSlot===n.motorSlot}),railName=e=>"extruder"===e?"Extruder T0":e===s.po.extruder1?"Extruder T1":"Stepper "+e.toLocaleUpperCase();return 1===l.length?t.addIssue({code:i.z.ZodIssueCode.custom,message:"Motor slot ".concat(n.motorSlot," is already in use on ").concat(railName(l[0].axis)),path:["rails",o,"motorSlot"]}):l.length>1&&t.addIssue({code:i.z.ZodIssueCode.custom,message:"Motor slot ".concat(n.motorSlot," is already in use on ").concat(l.slice(0,-1).map(e=>railName(e.axis)).join(", ")," and ").concat(railName(l[l.length-1].axis)),path:["rails",o,"motorSlot"]}),l.length>0?{rail:n,conflicts:l}:0}return null}).filter(Boolean);n.length>0&&t.addIssue({code:i.z.ZodIssueCode.custom,message:"Motor slot conflicts detected"})}),_=p.extend({printer:l.Q.shape.id,controlboard:a.WQ,toolheads:i.z.array(d.Qk).min(1).max(2),controllerFan:o.XG.shape.id,rails:i.z.array(s.Ah)}).strict(),g=p.extend({toolheads:i.z.array(d.b2).min(1).max(2)}).strict().partial().optional(),z=_.extend({toolheads:i.z.array(d.ZF).min(1).max(2)}).strict().partial();var f=r(83587),h=r(85582),v=r(49738),b=r(97370),m=r(48418),T=r(57674),x=r(31667),C=r(72931);let R=(0,n.cn)({key:"PerformanceMode",default:!1,effects:[(0,C.rR)(),(0,f.ok)({refine:(0,h.getRefineCheckerForZodSchema)(i.z.boolean().optional().nullable())})]}),S=(0,n.cn)({key:"Stealchop",default:!1,effects:[(0,C.rR)(),(0,f.ok)({refine:(0,h.getRefineCheckerForZodSchema)(i.z.boolean().optional().nullable())})]}),y=(0,n.cn)({key:"StandstillStealth",default:!1,effects:[(0,C.rR)(),(0,f.ok)({refine:(0,h.getRefineCheckerForZodSchema)(i.z.boolean().optional().nullable())})]}),P=(0,n.cn)({key:"ControllerFan",default:x.z2,effects:[(0,C.rR)(),(0,f.ok)({refine:(0,h.getRefineCheckerForZodSchema)(o.XG.nullable())})]}),A=(0,n.nZ)({key:"PrinterConfiguration",get:async e=>{let{get:t}=e,{printer:r,printerSize:i,performanceMode:o,stealthchop:a,standstillStealth:l,rails:s,controlboard:d,controllerFan:u,toolheads:p}=t((0,n.k9)({printer:m.H6,printerSize:m.hq,performanceMode:R,stealthchop:S,standstillStealth:y,rails:m.q7,controlboard:m.OS,controllerFan:P,toolheads:T.$T})),c=g.safeParse({printer:null==r?null:{...r,defaults:{...r.defaults,toolheads:null==r?void 0:r.defaults.toolheads.map(e=>(0,b.m6)(e))}},size:i,performanceMode:o,stealthchop:a,standstillStealth:l,rails:s,controlboard:d,controllerFan:u,toolheads:p});return!1===c.success&&console.error(c.error.flatten().fieldErrors),c.success?c.data:null}}),M=(0,n.nZ)({key:"LoadablePrinterConfigurationState",get:async e=>{let{get:t}=e,r=t((0,n.Qv)(A));return({hasValue:()=>r.contents,hasError:()=>null,loading:()=>null})[r.state]()}}),serializePrinterConfiguration=e=>{let t={printer:e.printer.id,toolheads:e.toolheads.map(e=>(0,b.m6)(e)),size:e.size,controlboard:e.controlboard.id,controllerFan:e.controllerFan.id,performanceMode:e.performanceMode,stealthchop:e.stealthchop,standstillStealth:e.standstillStealth,rails:e.rails.map(e=>(0,b.Yz)(e))};return _.parse(t)},serializePartialPrinterConfiguration=e=>{var t,r,n,i;let o=null==e?void 0:null===(t=e.toolheads)||void 0===t?void 0:t.map(e=>(0,b.od)(e)),a={printer:null==e?void 0:null===(r=e.printer)||void 0===r?void 0:r.id,toolheads:o,size:null==e?void 0:e.size,controlboard:null==e?void 0:null===(n=e.controlboard)||void 0===n?void 0:n.id,controllerFan:null==e?void 0:null===(i=e.controllerFan)||void 0===i?void 0:i.id,performanceMode:null==e?void 0:e.performanceMode,stealthchop:null==e?void 0:e.stealthchop,standstillStealth:null==e?void 0:e.standstillStealth};return z.parse(a)},useSerializedPrinterConfiguration=()=>{let e=(0,n.sJ)(M),t=(0,v.useMemo)(()=>serializePartialPrinterConfiguration(null!=e?e:{}),[e]);return t},usePrinterConfiguration=()=>{let[e,t]=(0,n.FV)(m.H6),[r,i]=(0,n.FV)(m.hq),[o,a]=(0,n.FV)(m.OS),[l,s]=(0,n.FV)(R),[d,u]=(0,n.FV)(S),[p,_]=(0,n.FV)(y),[g,z]=(0,n.FV)(P),f=(0,n.sJ)(m.Om),h=(0,n.sJ)(M),v=useSerializedPrinterConfiguration(),b=c.safeParse(h);return{selectedPrinter:e,setSelectedPrinter:t,selectedPrinterOption:r,setSelectedPrinterOption:i,selectedBoard:o,setSelectedBoard:a,performanceMode:l,setPerformanceMode:s,stealthchop:d,setStealthchop:u,standstillStealth:p,setStandstillStealth:_,selectedPrinterRails:f,selectedControllerFan:g,setSelectedControllerFan:z,partialPrinterConfiguration:h,serializedPrinterConfiguration:v,parsedPrinterConfiguration:b}}},48418:function(e,t,r){"use strict";r.d(t,{H6:function(){return g},OS:function(){return h},Om:function(){return m},Xu:function(){return z},ew:function(){return v},hq:function(){return f},q7:function(){return b}});var n=r(83587),i=r(2134),o=r(29565),a=r(55797),l=r(94594),s=r(85582),d=r(97370),u=r(78185),p=r(79438),c=r(72931);let _={},readPrinterAtom=async e=>{let{read:t}=e,r=await t(g.key);if(null!=r){let e=l.z.object({id:i.O.shape.id}).safeParse(r);if(e.success){let t=_[e.data.id];return null==t&&(t=await o.u.printer.printer.query(e.data.id,{}))&&(_[e.data.id]=t),null!=t?t:null}}return null},readPrinterRailAtom=e=>async t=>{let{read:r}=t,n=await r(v(e).key);if(null!=n){let t=u.Ah.safeParse(n);if(t.success)return t.data;let i=await readPrinterAtom({read:r}),o=null==i?void 0:i.defaults.rails.find(t=>t.axis===e);if(null!=o){let e=u.Ah.safeParse({...o,...n});if(e.success)return e.data}}return null},g=(0,a.cn)({key:"Printer",default:null,effects:[(0,c.rR)(),(0,n.ok)({read:readPrinterAtom,write:async(e,t)=>{let{write:r}=e;await new Promise(e=>{t instanceof a.nY?r(g.key,null):r(g.key,null!=t?t:null),setTimeout(()=>{},500)})},refine:(0,s.getRefineCheckerForZodSchema)(i.O.nullable())})]}),z=(0,a.nZ)({key:"LoadablePrinterState",get:async e=>{let{get:t}=e,r=t((0,a.Qv)(g));return({hasValue:()=>r.contents,hasError:()=>[],loading:()=>[]})[r.state]()}}),f=(0,a.cn)({key:"PrinterOption",default:null,effects:[(0,c.rR)(),(0,n.ok)({refine:(0,s.getRefineCheckerForZodSchema)(i.Q.shape.sizes.unwrap().element.nullable())})]}),h=(0,a.cn)({key:"Controlboard",default:null,effects:[(0,c.rR)(),(0,n.ok)({read:async e=>{let{read:t}=e,r=await t(h.key);if(null!=r){let e=l.z.object({path:p.Ui}).safeParse(r);if(e.success){let t=await o.u.mcu.boards.query({boardFilters:{toolboard:!1}}),r=t.find(t=>t.path===e.data.path);return null!=r?r:null}}return null},refine:(0,s.getRefineCheckerForZodSchema)(p.$l.nullable())})]}),v=(0,a.xu)({key:"PrinterRail",default:null,effects:e=>[(0,c.rR)(),(0,n.ok)({read:readPrinterRailAtom(e),refine:(0,s.getRefineCheckerForZodSchema)(u.Ah.nullable())})]}),b=(0,a.nZ)({key:"PrinterRails",get:e=>{let{get:t}=e,r=t(g),n=null==r?void 0:r.defaults.rails.map(e=>{let r=t(v(e.axis));return(0,d.Ak)(null!=r?r:e)});return null!=n?n:[]},set:(e,t)=>{let{set:r}=e;if(t instanceof a.nY){Object.values(u.po).forEach(e=>{r(v(e),null)});return}t.forEach(e=>{r(v(e.axis),(0,d.Yz)(e))})}}),m=(0,a.nZ)({key:"LoadablePrinterRailsState",get:async e=>{let{get:t}=e,r=t((0,a.Qv)(b));return({hasValue:()=>r.contents,hasError:()=>[],loading:()=>[]})[r.state]()}})},57674:function(e,t,r){"use strict";r.d(t,{$T:function(){return _},AF:function(){return c},wm:function(){return g}});var n=r(55797),i=r(83587),o=r(94594),a=r(85582),l=r(29565),s=r(79438);r(78185);var d=r(89553),u=r(48418),p=r(72931);let c=(0,n.xu)({key:"PrinterToolhead",default:null,effects:e=>[(0,p.rR)(),(0,i.ok)({read:async t=>{let{read:r}=t,n=await r(c(e).key);if("object"!=typeof n||null==n)return null;let{toolNumber:i,...a}=n;if(null!=a){let t=d.x8.safeParse(a);if(t.success){let r=t.data.toolboard;if(r&&null!=r){let e=o.z.object({path:s.Ui}).safeParse(r);if(e.success){let t=await l.u.mcu.boards.query({boardFilters:{toolboard:!0}}),n=t.find(t=>t.path===e.data.path);n&&(r=s.MG.parse(n))}}return{...t.data,toolboard:r,toolNumber:e}}console.debug("RecoilSync: failed to read toolhead!",c(e).key,t.error,a)}return null},refine:(0,a.getRefineCheckerForZodSchema)(d.PY.extend({toolNumber:d.Qr}).nullable())})]});(0,n.CG)({key:"DeserializeToolheadQuery",get:e=>async t=>{let{get:r}=t,n=d.x8.safeParse(await l.u.printer.deserializeToolheadConfiguration.query({config:e.th,printerConfig:{controlboard:e.boardId}}));return n.success?{...n.data,toolNumber:e.toolNumber}:null}});let _=(0,n.nZ)({key:"PrinterToolheadsState",get:e=>{let{get:t}=e,r=t(u.H6);return null==r?[]:t((0,n.k9)(r.defaults.toolheads.map((e,t)=>c(t)))).filter(Boolean)},set:(e,t)=>{let{set:r,reset:i}=e;if(t instanceof n.nY)throw Error("ToolheadsState cannot be reset, please reset the individual ToolheadState instead");t.forEach(e=>{r(c(e.toolNumber),{...e,toolNumber:e.toolNumber})})}}),g=(0,n.nZ)({key:"LoadablePrinterToolheadsState",get:async e=>{let{get:t}=e,r=t((0,n.Qv)(_));return({hasValue:()=>r.contents,hasError:()=>[],loading:()=>[]})[r.state]()}})},97370:function(e,t,r){"use strict";r.d(t,{Ak:function(){return deserializePrinterRail},DX:function(){return stringToTitleObject},Df:function(){return deserializeDriver},Oj:function(){return deserializePrinterRailDefinition},WZ:function(){return deserializeStepper},Yz:function(){return serializePrinterRail},m6:function(){return serializeToolheadConfiguration},od:function(){return serializePartialToolheadConfiguration}});var n=r(96099),i=r(78185),o=r(39140);r(89553),r(51758);let deserializeDriver=e=>{var t;return null!==(t=n.N.find(t=>t.id===e))&&void 0!==t?t:null},deserializeStepper=e=>{var t;return null!==(t=o.B.find(t=>t.id===e))&&void 0!==t?t:null},deserializePrinterRail=e=>{let t=deserializeStepper(e.stepper),r=deserializeDriver(e.driver);if(null==t)throw Error("Stepper ".concat(e.stepper," not found in database"));if(null==r)throw Error("Driver ".concat(e.driver," not found in database"));return i.g6.parse({...e,stepper:t,driver:r})},deserializePrinterRailDefinition=e=>{let t=deserializeStepper(e.stepper),r=deserializeDriver(e.driver);if(null==t)throw Error("Stepper ".concat(e.stepper," not found in database"));if(null==r)throw Error("Driver ".concat(e.driver," not found in database"));return i.P6.parse({...e,stepper:t,driver:r})},stringToTitleObject=e=>({id:e,title:e}),serializePrinterRail=e=>i.Ah.parse({...e,driver:e.driver.id,stepper:e.stepper.id}),serializeToolheadConfiguration=e=>{var t,r,n,i;return{...e,toolboard:null===(t=e.toolboard)||void 0===t?void 0:t.id,hotend:e.hotend.id,thermistor:e.thermistor,extruder:e.extruder.id,probe:null===(r=e.probe)||void 0===r?void 0:r.id,xEndstop:e.xEndstop.id,yEndstop:e.yEndstop.id,partFan:e.partFan.id,hotendFan:e.hotendFan.id,xAccelerometer:null===(n=e.xAccelerometer)||void 0===n?void 0:n.id,yAccelerometer:null===(i=e.yAccelerometer)||void 0===i?void 0:i.id}},serializePartialToolheadConfiguration=e=>{var t,r,n,i,o,a,l,s,d,u;return null==e?void 0:{...e,toolboard:null===(t=e.toolboard)||void 0===t?void 0:t.id,hotend:null===(r=e.hotend)||void 0===r?void 0:r.id,thermistor:e.thermistor,extruder:null===(n=e.extruder)||void 0===n?void 0:n.id,probe:null===(i=e.probe)||void 0===i?void 0:i.id,xEndstop:null===(o=e.xEndstop)||void 0===o?void 0:o.id,yEndstop:null===(a=e.yEndstop)||void 0===a?void 0:a.id,partFan:null===(l=e.partFan)||void 0===l?void 0:l.id,hotendFan:null===(s=e.hotendFan)||void 0===s?void 0:s.id,xAccelerometer:null===(d=e.xAccelerometer)||void 0===d?void 0:d.id,yAccelerometer:null===(u=e.yAccelerometer)||void 0===u?void 0:u.id}}},64918:function(e,t,r){"use strict";r.d(t,{SX:function(){return o},uF:function(){return a}});var n=r(67763),i=r(21067);function getBaseUrl(){return"/configure"}r(28070);let o=(0,i.t)({config:()=>({links:[(0,n.N8)({url:"".concat(getBaseUrl(),"/api/trpc"),maxURLLength:2083})]}),ssr:!1}),a=(0,n.K5)({links:[(0,n.N8)({url:"".concat(getBaseUrl(),"/api/trpc"),maxURLLength:2083})]})},79438:function(e,t,r){"use strict";r.d(t,{$l:function(){return z},MG:function(){return f},Ui:function(){return p},WQ:function(){return u}});var n=r(94594),i=r(78185);let o=n.z.object({x_step_pin:n.z.string().optional(),x_dir_pin:n.z.string().optional(),x_enable_pin:n.z.string().optional(),x_uart_pin:n.z.string().optional(),x_diag_pin:n.z.string().optional(),x_endstop_pin:n.z.string().optional(),x1_step_pin:n.z.string().optional(),x1_dir_pin:n.z.string().optional(),x1_enable_pin:n.z.string().optional(),x1_uart_pin:n.z.string().optional(),x1_diag_pin:n.z.string().optional(),x1_endstop_pin:n.z.string().optional(),dual_carriage_step_pin:n.z.string().optional(),dual_carriage_dir_pin:n.z.string().optional(),dual_carriage_enable_pin:n.z.string().optional(),dual_carriage_uart_pin:n.z.string().optional(),dual_carriage_diag_pin:n.z.string().optional(),dual_carriage_endstop_pin:n.z.string().optional(),y_step_pin:n.z.string().optional(),y_dir_pin:n.z.string().optional(),y_enable_pin:n.z.string().optional(),y_uart_pin:n.z.string().optional(),y_diag_pin:n.z.string().optional(),y_endstop_pin:n.z.string().optional(),y1_step_pin:n.z.string().optional(),y1_dir_pin:n.z.string().optional(),y1_enable_pin:n.z.string().optional(),y1_uart_pin:n.z.string().optional(),y1_diag_pin:n.z.string().optional(),y1_endstop_pin:n.z.string().optional(),y2_step_pin:n.z.string().optional(),y2_dir_pin:n.z.string().optional(),y2_enable_pin:n.z.string().optional(),y2_uart_pin:n.z.string().optional(),y2_diag_pin:n.z.string().optional(),y2_endstop_pin:n.z.string().optional(),z0_step_pin:n.z.string().optional(),z0_dir_pin:n.z.string().optional(),z0_enable_pin:n.z.string().optional(),z0_uart_pin:n.z.string().optional(),z0_diag_pin:n.z.string().optional(),z1_step_pin:n.z.string().optional(),z1_dir_pin:n.z.string().optional(),z1_enable_pin:n.z.string().optional(),z1_uart_pin:n.z.string().optional(),z1_diag_pin:n.z.string().optional(),z2_step_pin:n.z.string().optional(),z2_dir_pin:n.z.string().optional(),z2_enable_pin:n.z.string().optional(),z2_uart_pin:n.z.string().optional(),z2_diag_pin:n.z.string().optional(),z3_step_pin:n.z.string().optional(),z3_dir_pin:n.z.string().optional(),z3_enable_pin:n.z.string().optional(),z3_uart_pin:n.z.string().optional(),z3_diag_pin:n.z.string().optional(),e_step_pin:n.z.string().optional(),e_dir_pin:n.z.string().optional(),e_enable_pin:n.z.string().optional(),e_uart_pin:n.z.string().optional(),e_diag_pin:n.z.string().optional(),e_heater_pin:n.z.string().optional(),e_sensor_pin:n.z.string().optional(),stepper_spi_mosi_pin:n.z.string().optional(),stepper_spi_miso_pin:n.z.string().optional(),stepper_spi_sclk_pin:n.z.string().optional(),adxl345_cs_pin:n.z.string().optional(),bltouch_sensor_pin:n.z.string().optional(),bltouch_control_pin:n.z.string().optional(),probe_pin:n.z.string().optional(),fan_part_cooling_pin:n.z.string().optional(),fan_toolhead_cooling_pin:n.z.string().optional(),fan_controller_board_pin:n.z.string().optional(),heater_bed_heating_pin:n.z.string().optional(),heater_bed_sensor_pin:n.z.string().optional(),"4p_fan_part_cooling_pin":n.z.string().optional(),"4p_fan_part_cooling_tach_pin":n.z.string().optional(),"4p_toolhead_cooling_pin":n.z.string().optional(),"4p_toolhead_cooling_tach_pin":n.z.string().optional(),"4p_controller_board_pin":n.z.string().optional(),"4p_controller_board_tach_pin":n.z.string().optional()});o.extend({x_step_pin:n.z.string(),x_dir_pin:n.z.string(),x_enable_pin:n.z.string(),x_uart_pin:n.z.string(),x_endstop_pin:n.z.string(),y_step_pin:n.z.string(),y_dir_pin:n.z.string(),y_enable_pin:n.z.string(),y_uart_pin:n.z.string(),y_endstop_pin:n.z.string(),z0_step_pin:n.z.string(),z0_dir_pin:n.z.string(),z0_enable_pin:n.z.string(),z0_uart_pin:n.z.string(),e_step_pin:n.z.string(),e_dir_pin:n.z.string(),e_enable_pin:n.z.string(),e_uart_pin:n.z.string(),e_heater_pin:n.z.string(),e_sensor_pin:n.z.string(),probe_pin:n.z.string(),heater_bed_heating_pin:n.z.string(),heater_bed_sensor_pin:n.z.string()}).and(n.z.object({fan_part_cooling_pin:n.z.string(),fan_toolhead_cooling_pin:n.z.string()}).or(n.z.object({"4p_fan_part_cooling_pin":n.z.string(),"4p_fan_part_cooling_tach_pin":n.z.string(),"4p_toolhead_cooling_pin":n.z.string(),"4p_toolhead_cooling_tach_pin":n.z.string()}))),o.extend({x_step_pin:n.z.string(),x_dir_pin:n.z.string(),x_enable_pin:n.z.string(),x_uart_pin:n.z.string(),x_endstop_pin:n.z.string(),y_step_pin:n.z.string(),y_dir_pin:n.z.string(),y_enable_pin:n.z.string(),y_uart_pin:n.z.string(),y_endstop_pin:n.z.string(),z0_step_pin:n.z.string(),z0_dir_pin:n.z.string(),z0_enable_pin:n.z.string(),z0_uart_pin:n.z.string(),z1_step_pin:n.z.string(),z1_dir_pin:n.z.string(),z1_enable_pin:n.z.string(),z1_uart_pin:n.z.string(),z2_step_pin:n.z.string(),z2_dir_pin:n.z.string(),z2_enable_pin:n.z.string(),z2_uart_pin:n.z.string(),probe_pin:n.z.string(),heater_bed_heating_pin:n.z.string(),heater_bed_sensor_pin:n.z.string()}).and(n.z.object({fan_part_cooling_pin:n.z.string(),fan_toolhead_cooling_pin:n.z.string()}).or(n.z.object({"4p_fan_part_cooling_pin":n.z.string(),"4p_fan_part_cooling_tach_pin":n.z.string(),"4p_toolhead_cooling_pin":n.z.string(),"4p_toolhead_cooling_tach_pin":n.z.string()}))),o.extend({e_step_pin:n.z.string(),e_dir_pin:n.z.string(),e_enable_pin:n.z.string(),e_uart_pin:n.z.string(),e_heater_pin:n.z.string(),e_sensor_pin:n.z.string(),adxl345_cs_pin:n.z.string(),probe_pin:n.z.string()}).and(n.z.object({fan_part_cooling_pin:n.z.string(),fan_toolhead_cooling_pin:n.z.string()}).or(n.z.object({"4p_fan_part_cooling_pin":n.z.string(),"4p_fan_part_cooling_tach_pin":n.z.string(),"4p_toolhead_cooling_pin":n.z.string(),"4p_toolhead_cooling_tach_pin":n.z.string()})));let a=n.z.object({uart_pin:n.z.string(),uart_address:n.z.string().optional(),rx_pin:n.z.string().optional(),tx_pin:n.z.string().optional()}),l=n.z.object({cs_pin:n.z.string()}).and(n.z.object({spi_bus:n.z.string()}).or(n.z.object({spi_software_mosi_pin:n.z.string().optional(),spi_software_miso_pin:n.z.string().optional(),spi_software_sclk_pin:n.z.string().optional()}))),hasSPI=e=>l.safeParse(e).success,hasUART=e=>a.safeParse(e).success,s=n.z.object({title:n.z.string(),step_pin:n.z.string(),dir_pin:n.z.string(),enable_pin:n.z.string(),diag_pin:n.z.string().optional(),endstop_pin:n.z.string().optional(),uart_pin:n.z.string().optional(),uart_address:n.z.string().optional(),rx_pin:n.z.string().optional(),tx_pin:n.z.string().optional(),cs_pin:n.z.string().optional(),spi_bus:n.z.string().optional(),spi_software_mosi_pin:n.z.string().optional(),spi_software_miso_pin:n.z.string().optional(),spi_software_sclk_pin:n.z.string().optional()}).refine(e=>hasSPI(e)||hasUART(e),{message:"Motor slot must have either SPI or UART pins"});s.innerType().omit({title:!0}).partial();let d=n.z.string(),u=n.z.string().brand("BoardID"),p=n.z.string().brand("BoardPath"),c=n.z.string().brand("BoardSerialPath"),_=n.z.record(n.z.nativeEnum(i.po),n.z.string()),g=n.z.record(d,s),z=n.z.object({id:u,isToolboard:n.z.boolean().optional(),isHost:n.z.boolean().optional(),serialPath:c.optional(),name:n.z.string(),manufacturer:n.z.string(),firmwareBinaryName:n.z.string(),compileScript:n.z.string(),flashScript:n.z.string().optional(),flashInstructions:n.z.string().optional(),disableAutoFlash:n.z.boolean().optional(),documentationLink:n.z.string().optional(),hasQuirksFiles:n.z.boolean().optional(),driverCount:n.z.number(),integratedDrivers:_.optional(),extruderlessConfig:n.z.string().optional(),fourPinFanConnectorCount:n.z.number().optional(),driverVoltages:i.v6.array().default([24]),hasMcuTempSensor:n.z.boolean().default(!0),alternativePT1000Resistor:n.z.number().optional(),motorSlots:n.z.record(d,s).optional(),outputPins:n.z.array(n.z.object({pin:n.z.string(),name:n.z.string(),value:n.z.number().min(0).max(1)})).optional(),dfu:n.z.object({dfuBootImage:n.z.string(),flashDevice:n.z.string(),instructions:n.z.array(n.z.string()),reminder:n.z.string().optional(),hasBoot0Jumper:n.z.boolean()}).optional(),stepperSPI:n.z.object({software:n.z.object({sclk:n.z.string(),mosi:n.z.string(),miso:n.z.string()})}).or(n.z.object({hardware:n.z.object({bus:n.z.string()})})).optional(),ADXL345SPI:n.z.object({cs_pin:n.z.string()}).and(n.z.object({software:n.z.object({sclk:n.z.string(),mosi:n.z.string(),miso:n.z.string()})}).or(n.z.object({hardware:n.z.object({bus:n.z.string()})}))).optional(),path:p}).and(n.z.object({isToolboard:n.z.literal(!0),motorSlots:n.z.undefined()}).or(n.z.object({motorSlots:g})).or(n.z.object({isHost:n.z.literal(!0),motorSlots:n.z.undefined()})));z.and(n.z.object({detected:n.z.boolean()})),n.z.object({id:n.z.string(),disableAutoFlash:n.z.literal(!1).optional(),isToolboard:n.z.boolean().optional(),compileScript:n.z.string(),flashScript:n.z.string(),path:p});let f=z.and(n.z.object({isToolboard:n.z.literal(!0),isHost:n.z.literal(!1).optional(),integratedDrivers:_.and(n.z.object({[i.po.extruder]:n.z.string()}))}));f.and(n.z.object({detected:n.z.boolean()}))},21899:function(e,t,r){"use strict";r.d(t,{M3:function(){return f},Mf:function(){return u},U3:function(){return _},Uy:function(){return p},XG:function(){return h},lV:function(){return g},ow:function(){return c},ws:function(){return z}});var n=r(94594),i=r(54213),o=r(78185),a=r(28070);let l=["EPCOS 100K B57560G104F","ATC Semitec 104GT-2","ATC Semitec 104NT-4-R025H42G","Generic 3950","Honeywell 100K 135-104LAG-J01","NTC 100K MGB18-104F39050L32","SliceEngineering 450","TDK NTCG104LH104JT1","PT1000"],s="";if(a.env.RATOS_CONFIGURATION_PATH){let e=i.Rz.parse(a.env);s=e.RATOS_CONFIGURATION_PATH}let d=n.z.object({path:n.z.string().startsWith(s).endsWith(".cfg"),id:n.z.string()}),u=n.z.enum(l),p=d.extend({type:n.z.literal("hotend"),title:n.z.string(),thermistor:n.z.enum(l),flowType:n.z.union([n.z.literal("sf"),n.z.literal("hf"),n.z.literal("uhf")])}),c=n.z.object({type:n.z.enum(["Regular","CHT"]),diameter:n.z.number().min(.2).max(1.8)}),_=d.extend({type:n.z.literal("extruder"),stepper:o.vF.shape.id.optional(),current:o.P6.shape.current.optional(),title:n.z.string()}),g=d.extend({type:n.z.literal("static-probe").or(n.z.literal("stowable-probe")),title:n.z.string()}),z=n.z.object({id:n.z.enum(["endstop","endstop-toolboard","sensorless"]),title:n.z.string()}),f=n.z.object({id:n.z.enum(["toolboard","controlboard","sbc","none"]),title:n.z.string()}),h=n.z.object({id:n.z.enum(["2pin","4pin","4pin-dedicated","2pin-toolboard","4pin-toolboard","4pin-dedicated-toolboard","none"]),title:n.z.string()})},78185:function(e,t,r){"use strict";r.d(t,{Ah:function(){return h},HB:function(){return u},JQ:function(){return f},P6:function(){return g},R_:function(){return matchesDefaultRail},Wx:function(){return getSupportedVoltages},g6:function(){return _},po:function(){return a},r:function(){return z},v6:function(){return d},vF:function(){return c}});var n,i,o,a,l=r(94594);(n=o||(o={}))[n["24V"]=24]="24V",n[n["36V"]=36]="36V",n[n["48V"]=48]="48V",n[n["56V"]=56]="56V",n[n["60V"]=60]="60V";let s=[{id:24,title:"24V"},{id:36,title:"36V"},{id:48,title:"48V"},{id:56,title:"56V"},{id:60,title:"60V"}],getSupportedVoltages=(e,t)=>(null==t?void 0:t.external)?s.filter(e=>{var r;return(null==t?void 0:null===(r=t.voltages)||void 0===r?void 0:r.includes(e.id))||24===e.id}):s.filter(t=>{var r;return(null==e?void 0:null===(r=e.driverVoltages)||void 0===r?void 0:r.includes(t.id))||24===t.id}).filter(e=>{var r;return(null==t?void 0:null===(r=t.voltages)||void 0===r?void 0:r.includes(e.id))||24===e.id}),matchesDefaultRail=(e,t,r)=>{var n,i;return e.axis===t.axis&&e.driver.id===t.driver.id&&e.stepper.id===t.stepper.id&&(r&&t.performanceMode&&e.voltage===(null===(n=t.performanceMode)||void 0===n?void 0:n.voltage)&&e.current===(null===(i=t.performanceMode)||void 0===i?void 0:i.current)||!r&&e.voltage===t.voltage&&e.current===t.current)},d=l.jb(o),u=l.Ry({id:l.Z_(),title:l.Z_(),type:l.Km(["TMC2209","TMC2226","TMC5160","TMC2130","TMC2240"]),protocol:l.Km(["SPI","UART"]),senseResistor:l.Rx().min(0),coolingCurrentThreshold:l.Rx(),voltages:d.array(),maxCurrent:l.Rx().min(0),external:l.O7().optional()}),p=l.Ry({voltage:d,run_current:l.Rx(),driver:u.shape.id,sense_resistor:l.Rx()}),c=l.Ry({id:l.Z_(),title:l.Z_(),fullStepsPerRotation:l.Rx().default(200),maxPeakCurrent:l.Rx().min(0),presets:l.IX(l.VK("driver",[p.extend({driver:l.Km(["TMC2130","TMC5160","TMC2240"]),driver_MSLUT0:l.Rx().optional(),driver_MSLUT1:l.Rx().optional(),driver_MSLUT2:l.Rx().optional(),driver_MSLUT3:l.Rx().optional(),driver_MSLUT4:l.Rx().optional(),driver_MSLUT5:l.Rx().optional(),driver_MSLUT6:l.Rx().optional(),driver_MSLUT7:l.Rx().optional(),driver_W0:l.Rx().optional(),driver_W1:l.Rx().optional(),driver_W2:l.Rx().optional(),driver_W3:l.Rx().optional(),driver_X1:l.Rx().optional(),driver_X2:l.Rx().optional(),driver_X3:l.Rx().optional(),driver_START_SIN:l.Rx().optional(),driver_START_SIN90:l.Rx().optional(),driver_IHOLDDELAY:l.Rx().optional(),driver_TPOWERDOWN:l.Rx().optional(),driver_TBL:l.Rx().optional(),driver_TOFF:l.Rx().optional(),driver_HEND:l.Rx().optional(),driver_HSTRT:l.Rx().optional(),driver_PWM_AUTOSCALE:l.O7().optional(),driver_PWM_FREQ:l.Rx().optional(),driver_PWM_GRAD:l.Rx().optional(),driver_PWM_AMPL:l.Rx().optional(),driver_SGT:l.Rx().optional()}),p.extend({driver:l.Km(["TMC2209"]),driver_TBL:l.Rx().optional(),driver_TOFF:l.Rx().optional(),driver_HEND:l.Rx().optional(),driver_HSTRT:l.Rx().optional()})])).optional().describe("Stepper presets are tightly coupled to the driver type, sense_resistor, stepper, voltage and current.")});(i=a||(a={})).x="x",i.dual_carriage="dual_carriage",i.x1="x1",i.y="y",i.y1="y1",i.y2="y2",i.z="z",i.z1="z1",i.z2="z2",i.z3="z3",i.extruder="extruder",i.extruder1="extruder1";let _=l.Ry({axis:l.jb(a).describe("Axis of the rail"),axisDescription:l.Z_().optional().describe("Description of the axis"),driver:u.describe("Stepper driver used on this axis"),voltage:d.default(24).describe("Voltage of the stepper driver"),stepper:c.describe("Stepper motor connected to this axis"),motorSlot:l.Z_().optional().describe("Optional board motor slot of the stepper driver"),current:l.Rx().min(0),rotationDistance:l.Rx().min(0).describe("Distance in mm the axis travels per stepper rotation"),gearRatio:l.Z_().regex(/^\d+:\d+$/).optional().describe("Optional gear ratio of the axis"),homingSpeed:l.Rx().min(0).default(10).describe("Axis speed during homing in mm/s"),microstepping:l.Rx().min(16).max(256).default(64).describe("Microstepping of the stepper driver, higher values increase resolution and lower noise but increases load on the MCU")}),g=_.extend({motorSlot:l.S1(),performanceMode:l.Ry({current:l.Rx().min(0),voltage:d.default(24).describe("Voltage of the stepper driver in performance mode"),homingSpeed:l.Rx().min(0).optional().describe("Axis speed during homing in mm/s in performance mode")}).optional()}),z=g.extend({driver:u.shape.id,stepper:c.shape.id}),f=_.refine(e=>e.current<=e.driver.maxCurrent,"Current must be less than max current of the driver"),h=_.extend({driver:u.shape.id,stepper:c.shape.id});l.Ry({min:l.Rx(),max:l.Rx(),endstop:l.Rx()})},2134:function(e,t,r){"use strict";r.d(t,{O:function(){return z},Q:function(){return g}});var n=r(94594),i=r(54213),o=r(31027),a=r.n(o),l=r(78185),s=r(89553),d=r(21899),u=r(79438),p=r(28070);let c="";if(p.env.RATOS_CONFIGURATION_PATH){let e=i.Rz.parse(p.env);c=a().join(e.RATOS_CONFIGURATION_PATH,"printers")}let _=n.z.object({velocity:n.z.number().min(0).describe("Maximum velocity for this printer"),accel:n.z.number().min(0).describe("Maximum acceleration for this printer"),z_velocity:n.z.number().min(0).describe("Maximum z velocity for this printer"),z_accel:n.z.number().min(0).describe("Maximum z acceleration for this printer"),square_corner_velocity:n.z.number().min(0).default(5).describe("Maximum square corner velocity for this printer"),travel_velocity:n.z.number().min(0).default(200).describe("Maximum travel velocity for this printer"),travel_accel:n.z.number().min(0).default(3e3).describe("Maximum travel velocity for this printer")}).strict(),g=n.z.object({id:n.z.string(),name:n.z.string().describe("The name of the printer"),description:n.z.string().describe("A description of the printer"),manufacturer:n.z.string().describe("The name of the manufacturer of this printer"),documentationLink:n.z.string().describe("Link to the RatOS documentation for this printer"),image:n.z.string().describe("Link to an image of the printer"),sizes:n.z.array(n.z.number()).describe("Size options for this printer").optional(),template:n.z.string().describe("Printer.cfg template for this printer"),path:n.z.string().startsWith(c),driverCountRequired:n.z.number().describe("Number of drivers required for this printer"),kinematics:n.z.union([n.z.literal("cartesian"),n.z.literal("corexy"),n.z.literal("hybrid-corexy"),n.z.literal("hybrid-corexy-idex")]).optional(),bedMargin:n.z.object({x:n.z.tuple([n.z.number().default(0),n.z.number().default(0)]),y:n.z.tuple([n.z.number().default(0),n.z.number().default(0)])}).describe("Margin of available movement around the bed for this printer").default({x:[0,0],y:[0,0]}),speedLimits:n.z.object({basic:_,performance:_.optional()}).strict().describe("Speed limits for this printer"),defaults:n.z.object({toolheads:n.z.array(s.Qk).describe("Default toolheads for this printer"),board:u.WQ.describe("Default board for this printer. Should be the name of the board directory."),rails:n.z.array(l.r).describe("Default rails for this printer"),controllerFan:d.XG.shape.id.optional().describe("Default controller fan for this printer")}).strict().describe("Default hardware for this printer")}).describe("A RatOS supported 3d printer"),z=g.extend({defaults:g.shape.defaults.extend({toolheads:n.z.array(s.x8)}).strict()})},89553:function(e,t,r){"use strict";r.d(t,{PY:function(){return s},Qk:function(){return _},Qr:function(){return d},ZF:function(){return g},b2:function(){return c},x8:function(){return p}});var n=r(94594),i=r(79438),o=r(21899),a=r(78185),l=r(12064);let s=n.z.object({hotend:o.Uy,thermistor:o.Mf,extruder:o.U3,xEndstop:o.ws,yEndstop:o.ws,hotendFan:o.XG,partFan:o.XG,nozzle:o.ow.default((0,l.S)()),xAccelerometer:o.M3.optional().nullable(),yAccelerometer:o.M3.optional().nullable(),toolboard:i.MG.nullable(),probe:o.lV.optional(),axis:n.z.literal(a.po.x).or(n.z.literal(a.po.dual_carriage)),description:n.z.string().optional(),toolNumber:n.z.number().optional()}).strict(),d=n.z.union([n.z.literal(0),n.z.literal(1)]),u=n.z.union([n.z.literal(a.po.x),n.z.literal(a.po.dual_carriage),n.z.literal(a.po.extruder),n.z.literal(a.po.extruder1)]);n.z.union([u,d]);let p=s.refine(e=>null!==e.toolboard||"endstop-toolboard"!==e.xEndstop.id,"Cannot use toolboard endstop without a toolboard").refine(e=>null!==e.toolboard||!["2pin-toolboard","4pin-toolboard","4pin-dedicated-toolboard"].includes(e.hotendFan.id),"Cannot use toolboard hotend fan without a toolboard").refine(e=>null!==e.toolboard||!["2pin-toolboard","4pin-toolboard","4pin-dedicated-toolboard"].includes(e.partFan.id),"Cannot use toolboard part cooling fan without a toolboard"),c=s.partial().optional(),_=s.extend({hotend:o.Uy.shape.id,extruder:o.U3.shape.id,thermistor:o.Mf,xEndstop:o.ws.shape.id,yEndstop:o.ws.shape.id,hotendFan:o.XG.shape.id,partFan:o.XG.shape.id,xAccelerometer:o.M3.shape.id.optional().nullable(),yAccelerometer:o.M3.shape.id.optional().nullable(),toolboard:i.WQ.optional().nullable(),probe:o.lV.shape.id.optional().nullable()}).strict(),g=_.partial().optional()},54213:function(e,t,r){"use strict";r.d(t,{Rz:function(){return i}});var n=r(94594);let i=n.z.object({NODE_ENV:n.z.enum(["development","test","production"]),RATOS_CONFIGURATION_PATH:n.z.string(),RATOS_SCRIPT_DIR:n.z.string(),KLIPPER_CONFIG_PATH:n.z.string(),KLIPPER_DIR:n.z.string(),KLIPPER_ENV:n.z.string(),MOONRAKER_DIR:n.z.string(),LOG_FILE:n.z.string(),RATOS_DATA_DIR:n.z.string()});n.z.object({NEXT_PUBLIC_KLIPPER_HOSTNAME:n.z.string().optional()})}}]);