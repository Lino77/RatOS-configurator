(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[723],{10944:function(e,t,n){Promise.resolve().then(n.bind(n,44872))},44872:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Page}});var a=n(45489),i=n(26248),l=n(74601),r=n(50961),s=n(49738),o=n(88116),c=n(50962),d=n(44838),u=n(81503);let useDebounce=(e,t)=>{let n=(0,s.useRef)(),a=(0,s.useRef)([]);return(0,s.useEffect)(()=>()=>{n.current&&clearTimeout(n.current)},[]),(0,s.useCallback)(function(){for(var i=arguments.length,l=Array(i),r=0;r<i;r++)l[r]=arguments[r];a.current=l,n.current||(n.current=setTimeout(()=>{e(...a.current),n.current=void 0},t))},[e,t])},m={duration:150},Button=e=>{let[t]=(0,o.u)(),[n,a]=s.useState(!1),l=useDebounce(a,200),r=(0,s.useCallback)(async()=>{e.onClick&&!e.isLoading&&(l(!0),await e.onClick(),l(!1))},[l,e]);return(0,i.jsxs)("li",{className:(0,c.d)("flex"),children:["before"===e.subButtonPosition&&(0,i.jsx)("ol",{ref:t,className:"flex divide-x divide-zinc-200 dark:divide-zinc-800",children:e.children}),(0,i.jsx)("div",{className:(0,c.d)("flex items-center",e.isActive&&"dark:bg-zinc-800"),children:(0,i.jsxs)("button",{onClick:r,type:"button",title:e.title,className:(0,d.m)("flex items-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-700 transition-transform hover:text-black active:scale-95 dark:text-zinc-300 dark:hover:text-white",e.isActive?"hover:text-brand:600 text-brand-600 dark:text-brand-500 dark:hover:text-brand-500":"",e.hidden?"hidden":"",e.className),children:[e.icon&&(e.isLoading||n)&&(0,i.jsx)(u.$,{noMargin:!0,className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),e.icon&&!e.isLoading&&(0,i.jsx)(e.icon,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),e.name&&(0,i.jsx)("span",{className:"inline",children:e.name})]})}),null!=e.subButtonPosition&&"before"!==e.subButtonPosition&&(0,i.jsx)("ol",{ref:t,className:"flex divide-x divide-zinc-200 dark:divide-zinc-800",children:e.children}),null==e.subButtonPosition&&e.children&&e.children]},e.id)};function Toolbar(e){let[t]=(0,o.u)(m);return(0,i.jsx)("nav",{className:(0,d.m)("flex select-none overflow-hidden rounded-md border border-zinc-200 bg-white shadow dark:border-zinc-800 dark:bg-zinc-900/80",e.className),"aria-label":"Breadcrumb",children:(0,i.jsx)("ol",{role:"list",className:"flex divide-x divide-zinc-200 dark:divide-zinc-800",ref:t,children:e.buttons.map(t=>{var n;let a=null===(n=e.subButtons)||void 0===n?void 0:n.filter(e=>e.parent===t.id);return t.hidden?null:(0,s.createElement)(Button,{...t,key:t.id},null!=a&&a.length>0&&t.isActive?a.map(e=>e.hidden?null:(0,s.createElement)(Button,{...e,key:e.id})):t.children)})})})}var x=n(18754),f=n(91403),h=n(16277),p=n(46251),b=n(75403),v=n(78926),g=n(67419),j=n(26781),k=n(3487),y=n(51601),w=n(55282),N=n(48542),z=n(63041),C=n(61352),_=n(65778);let ScrollContainer=e=>(0,i.jsx)("div",{...e,className:(0,d.m)("scroll-smooth scrollbar-thin scrollbar-track-transparent scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600",e.className)}),S={pixelPrMm:160,outerNozzleDiameter:1,flipVertical:!1,flipHorizontal:!1},CameraSettingsDialog=e=>{var t,n;let a=(0,s.useRef)(!1),[l,r,o]=(0,C.Fu)("RatOS","camera-settings",S),[c,u]=(0,s.useState)(o.isFetched?l.pixelPrMm.toFixed(2):null),[m,x]=(0,s.useState)(o.isFetched?l.outerNozzleDiameter.toFixed(2):null),f=useDebounce(r,200);return(0,s.useEffect)(()=>{if(o.isFetched&&!1===a.current){var e,t;u(null!==(e=null==l?void 0:l.pixelPrMm.toFixed(2))&&void 0!==e?e:S.pixelPrMm.toFixed(2)),x(null!==(t=null==l?void 0:l.outerNozzleDiameter.toFixed(2))&&void 0!==t?t:S.outerNozzleDiameter.toFixed(2)),a.current=!0}},[l,o.isFetched]),(0,i.jsxs)(ScrollContainer,{className:(0,d.m)("scroll absolute left-5 top-1/2 max-h-[50%] w-80 -translate-y-1/2 transform-gpu overflow-y-auto rounded-md border-y border-r border-zinc-800 bg-zinc-100 p-5 shadow-lg transition-all dark:bg-zinc-900/70",e.isVisible?"translate-x-0 opacity-100":"pointer-events-none -translate-x-8 opacity-0",e.className),onWheel:e=>{e.stopPropagation()},children:[(0,i.jsxs)("h3",{className:"flex flex-1 items-center justify-between text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100",children:[(0,i.jsx)("span",{children:"Camera Settings"}),(0,i.jsx)(_,{className:"h-5 w-5 cursor-pointer",onClick:()=>e.toggle(!e.isVisible)})]}),(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-800",children:[(0,i.jsx)(N.o,{label:"Pixel per mm",type:"number",value:null!=c?c:"",placeholder:o.isFetched?void 0:"Loading...",onChange:e=>{let t=parseFloat(e);u(e),isNaN(t)||f(e=>({...e,pixelPrMm:t}))},error:isNaN(parseFloat(null!=c?c:""))?"Not a valid number":void 0}),(0,i.jsx)(N.o,{label:"Outer Nozzle Diameter",type:"number",step:.1,value:null!=m?m:"",placeholder:o.isFetched?void 0:"Loading...",onChange:e=>{let t=parseFloat(e);console.log(e,t),x(e),isNaN(t)||f(e=>({...e,outerNozzleDiameter:t}))},error:isNaN(parseFloat(null!=m?m:""))?"Not a valid number":void 0}),(0,i.jsx)(z.Z,{label:"Flip vertical",onChange:e=>r({...null!=l?l:S,flipVertical:null!=e&&e}),description:"Whether to flip the camera vertically",value:null!==(t=null==l?void 0:l.flipVertical)&&void 0!==t?t:S.flipVertical}),(0,i.jsx)(z.Z,{label:"Flip horizontal",onChange:e=>r({...null!=l?l:S,flipHorizontal:null!=e&&e}),description:"Whether to flip the camera horizontally",value:null!==(n=null==l?void 0:l.flipHorizontal)&&void 0!==n?n:S.flipHorizontal})]})]})};var O=n(21863);let ExposureIcon=e=>(0,i.jsxs)("svg",{viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",className:e.className,children:[(0,i.jsx)("path",{fill:"currentColor",d:"M456,40H56A16,16,0,0,0,40,56V456a16,16,0,0,0,16,16H456a16,16,0,0,0,16-16V56A16,16,0,0,0,456,40ZM72,72H417.373L72,417.373ZM440,440H94.627L440,94.627Z"}),(0,i.jsx)("polygon",{fill:"currentColor",points:"336 368 336 408 368 408 368 368 408 368 408 336 368 336 368 296 336 296 336 336 296 336 296 368 336 368"}),(0,i.jsx)("rect",{width:"112",height:"32",x:"112",y:"136",fill:"currentColor"})]});var E=n(74193),T=n(19731),A=n(20978),P=n(73838);let useGcodeCommand=()=>{let e=(0,C.xH)("printer.gcode.script");return(0,s.useCallback)(async function(t){for(var n=arguments.length,a=Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];let l=[t[0]];a.forEach((e,n)=>{l.push(e.toString(),t[n+1])});let r=l.join("");await e.mutateAsync({script:r}),console.log(r)},[e])};function _templateObject(){let e=(0,a._)(["G91\nG0 Z1"],["G91\\nG0 Z1"]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,a._)(["G91\nG0 Z0.5"],["G91\\nG0 Z0.5"]);return _templateObject1=function(){return e},e}function _templateObject2(){let e=(0,a._)(["G91\nG0 Z0.1"],["G91\\nG0 Z0.1"]);return _templateObject2=function(){return e},e}function _templateObject3(){let e=(0,a._)(["G91\nG0 Z0.05"],["G91\\nG0 Z0.05"]);return _templateObject3=function(){return e},e}function _templateObject4(){let e=(0,a._)(["G91\nG0 Z-0.05"],["G91\\nG0 Z-0.05"]);return _templateObject4=function(){return e},e}function _templateObject5(){let e=(0,a._)(["G91\nG0 Z-0.1"],["G91\\nG0 Z-0.1"]);return _templateObject5=function(){return e},e}function _templateObject6(){let e=(0,a._)(["G91\nG0 Z-0.5"],["G91\\nG0 Z-0.5"]);return _templateObject6=function(){return e},e}function _templateObject7(){let e=(0,a._)(["G91\nG0 Z-1.0"],["G91\\nG0 Z-1.0"]);return _templateObject7=function(){return e},e}let FocusControls=e=>{let t=useGcodeCommand();return(0,i.jsx)("div",{className:(0,d.m)("scroll absolute transform-gpu overflow-y-auto rounded-md border-y border-r border-zinc-800 bg-zinc-100 font-mono shadow-lg transition-all dark:bg-zinc-900/70",e.isVisible?" -translate-y-full opacity-100":"pointer-events-none  -translate-y-2/3  opacity-0",e.className),onWheel:e=>{e.stopPropagation()},children:(0,i.jsxs)("ol",{className:"flex flex-col divide-y divide-zinc-200 dark:divide-zinc-800",children:[(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(E,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"+1.00"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject1()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(T,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"+0.50"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject2()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(T,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"+0.10"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject3()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(T,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"+0.05"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject4()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(T,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"-0.05"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject5()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(A,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"-0.10"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject6()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(A,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"-0.50"})]})})}),(0,i.jsx)("li",{className:(0,c.d)("flex"),children:(0,i.jsx)("div",{className:(0,c.d)("flex flex-1 items-center justify-center text-center"),children:(0,i.jsxs)("button",{onClick:()=>t(_templateObject7()),type:"button",className:(0,d.m)("flex items-center justify-center space-x-2 whitespace-nowrap px-5 py-3 text-sm font-medium text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-100"),children:[(0,i.jsx)(P,{className:"inline h-5 w-5 flex-shrink-0","aria-hidden":"true"}),(0,i.jsx)("span",{className:"inline",children:"-1.00"})]})})})]})})},useWindowSize=()=>{let[e,t]=(0,s.useState)({width:window.innerWidth,height:window.innerHeight});return(0,s.useEffect)(()=>{let handleResize=()=>{requestAnimationFrame(()=>{t({width:window.innerWidth,height:window.innerHeight})})};return window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]),e};var R=n(8930),L=n(26989);let parseOptions=e=>{let t=e.matchAll(/- available option:\s(\w+)\s.+(\[-?\d+\.\.\d+\])/g),n=[];for(let e of t){let[t,a]=e[2].slice(1,-1).split("..").map(e=>parseInt(e,10)),i=n.find(t=>t.key===e[1]);i&&"max"in i&&i.max&&i.max<=a||n.push({key:e[1],min:t,max:["redbalance","bluebalance","greenbalance"].includes(e[1])?2e3:a})}let a=e.matchAll(/- available option:\s(\w+)\s.+(\[-?\d+\.\d+\.\.\d+\.\d+\])/g);for(let e of a){let[t,a]=e[2].slice(1,-1).split("..").map(e=>parseFloat(e)),i=n.find(t=>t.key===e[1]);i&&"max"in i&&i.max&&i.max<=a||n.push({key:e[1],float:!0,min:t,max:["redbalance","bluebalance","greenbalance"].includes(e[1])?2e3:a})}let i=e.matchAll(/- available option:\s(\w+)\s.+(\[false\.\.true\])/g);for(let e of i)n.push({key:e[1],toggle:!0});return n};var G=n(52540);let useCameraSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[n,a]=(0,s.useState)([]),i=(0,C.bL)("RatOS","camera-stream-settings"),l=(0,C.A4)("RatOS","camera-stream-settings"),r=(0,s.useRef)(l.data);r.current=l.data;let o=(0,s.useMemo)(()=>n.map(e=>{var t,n,a;return e.value=null!==(a=null===(n=r.current)||void 0===n?void 0:null===(t=n[e.key])||void 0===t?void 0:t.value)&&void 0!==a?a:e.value,e}),[n]),c=(0,s.useCallback)(async t=>{let n=await fetch("".concat(e,"/option?compressionquality=").concat(t));a(parseOptions(await n.text()))},[e]),d=(0,s.useCallback)(async(t,a)=>{let s=n.find(e=>e.key===t);if(null==s)throw Error("Invalid option ".concat(t));if(s&&"toggle"in s&&"boolean"!=typeof a)throw Error("Expect a boolean value for ".concat(t,", got ").concat(a));if(s&&"max"in s&&("number"!=typeof a||s.min>a||s.max<a))throw Error("Value ".concat(a," is out of range for ").concat(t));try{let n=await fetch("".concat(e,"/option?").concat(t,"=").concat(a.toString()));if(console.log(n.ok,l.isInitialLoading),n.ok&&!1===l.isInitialLoading){var o,c;console.log("saving",t,a,r.current,(0,G.T)(null!==(o=r.current)&&void 0!==o?o:{},{[t]:{value:a}})),await i.mutateAsync((0,G.T)(null!==(c=r.current)&&void 0!==c?c:{},{[t]:{value:a}}))}return n.ok}catch(e){return!1}},[n,i,e,l]);return(0,s.useEffect)(()=>{if(t&&c(100),t&&l.isFetched&&null!=r.current)for(let t in r.current){var n;let a=null===(n=r.current[t])||void 0===n?void 0:n.value;a&&fetch("".concat(e,"/option?").concat(t,"=").concat(a.toString()))}},[l.isFetched,e,t,c]),{options:o,setOption:d}},Slider=e=>{let{onChange:t,min:n,max:a,initialValue:l,step:r,isBoolean:o}=e,[c,d]=(0,s.useState)(null!=l?l:n),u=useDebounce((0,s.useCallback)(e=>{null==t||t(e)},[t]),100),m=(0,s.useCallback)(e=>{let t=r?parseFloat(e.target.value):parseInt(e.target.value,10);d(t),u(t)},[u,r]);return(0,i.jsxs)("div",{className:"relative mb-6",children:[(0,i.jsx)("input",{type:"range",value:c,onChange:m,min:n,max:a,step:null!=r?r:1,className:"h-2 w-full cursor-pointer appearance-none rounded-lg bg-zinc-200 dark:bg-zinc-700"}),(0,i.jsx)("span",{className:"absolute -bottom-6 start-0 text-sm text-zinc-500 dark:text-zinc-400",children:o?"Off":"Min (".concat(n,")")}),!o&&(0,i.jsx)("span",{className:"absolute -bottom-6 start-1/3 -translate-x-1/2 text-sm text-zinc-500 dark:text-zinc-400 rtl:translate-x-1/2",children:(a/3).toFixed(2)}),!o&&(0,i.jsx)("span",{className:"absolute -bottom-6 start-2/3 -translate-x-1/2 text-sm text-zinc-500 dark:text-zinc-400 rtl:translate-x-1/2",children:(a/3*2).toFixed(2)}),(0,i.jsx)("span",{className:"absolute -bottom-6 end-0 text-sm text-zinc-500 dark:text-zinc-400",children:o?"On":"Max (".concat(a,")")})]})};var M=n(5037);function page_templateObject(){let e=(0,a._)(["_VAOC_MOVE X="," Y=",""]);return page_templateObject=function(){return e},e}function page_templateObject1(){let e=(0,a._)(["_VAOC_END"]);return page_templateObject1=function(){return e},e}function page_templateObject2(){let e=(0,a._)(["_VAOC_START"]);return page_templateObject2=function(){return e},e}function page_templateObject3(){let e=(0,a._)(["_VAOC_LOAD_TOOL T=0"]);return page_templateObject3=function(){return e},e}function page_templateObject4(){let e=(0,a._)(["_VAOC_LOAD_TOOL T=1"]);return page_templateObject4=function(){return e},e}function page_templateObject5(){let e=(0,a._)(["_VAOC_SWITCH_LED STATE=",""]);return page_templateObject5=function(){return e},e}function page_templateObject6(){let e=(0,a._)(["_VAOC_SET_TOOL"]);return page_templateObject6=function(){return e},e}function page_templateObject7(){let e=(0,a._)(["_VAOC_PROBE_Z_OFFSET"]);return page_templateObject7=function(){return e},e}let getCameraUrl=()=>{let e=(0,L.X)();return null==e||""==e.trim()?"/webcam":"http://".concat(e,"/webcam")};function Page(){var e,t,n,a;let[m,N]=(0,s.useState)(getCameraUrl());(0,s.useEffect)(()=>{N(getCameraUrl())},[]);let[z,_]=(0,s.useState)(null),[S,E]=(0,s.useState)(null),[T,A]=(0,s.useState)(.1),{videoRef:P,connectionState:L}=function(e,t){let n=(0,s.useRef)(null),a=(0,s.useRef)(null),i=(0,s.useRef)(null),l=(0,s.useRef)(e),r=(0,s.useRef)(!1),[o,c]=(0,s.useState)(null),d=(0,s.useRef)(null),u=(0,s.useCallback)(e=>{if(e.candidate)return fetch(l.current,{body:JSON.stringify({type:"remote_candidate",id:d.current,candidates:[e.candidate]}),headers:{"Content-Type":"application/json"},method:"POST"}).catch(function(e){window.console.error(e)})},[]),m=(0,s.useCallback)(async()=>{i.current&&(i.current.close(),i.current=null),r.current=!0;try{c("new");var t={sdpSemantics:"unified-plan"};document.getElementById("use-stun")&&document.getElementById("use-stun").checked&&(t.iceServers=[{urls:["stun:stun.l.google.com:19302"]}]);let r=new URLSearchParams(e),s=Object.fromEntries(r.entries()),o=await fetch(e,{body:JSON.stringify({type:"request",res:s.res}),headers:{"Content-Type":"application/json"},method:"POST"});if(o.ok){let r=await o.json();r.iceServers&&(t.iceServers=r.iceServers),i.current=new RTCPeerConnection(t),i.current.addTransceiver("video",{direction:"recvonly"}),i.current.addEventListener("track",function(e){if("video"==e.track.kind){if(n.current)n.current.srcObject=e.streams[0];else throw Error("No video ref to set src on")}else a.current&&(a.current.srcObject=e.streams[0])}),i.current.addEventListener("connectionstatechange",()=>{var e;let t=null===(e=i.current)||void 0===e?void 0:e.connectionState;c(null!=t?t:null)}),d.current=r.id,await i.current.setRemoteDescription(r);let s=await i.current.createAnswer();await i.current.setLocalDescription(s),await new Promise(function(e){if(null==i.current)throw Error("peerConnection.current is null");"complete"===i.current.iceGatheringState?e(null):i.current.addEventListener("icegatheringstatechange",function checkState(){if(null==i.current)throw Error("peerConnection.current is null");"complete"===i.current.iceGatheringState&&(i.current.removeEventListener("icegatheringstatechange",checkState),e(null))})}),i.current.addEventListener("icecandidate",u);var l=i.current.localDescription;if(null==l)throw Error("No offer from peerConnection");await fetch(e,{body:JSON.stringify({type:l.type,id:d.current,sdp:l.sdp}),headers:{"Content-Type":"application/json"},method:"POST"})}else c("failed")}catch(e){console.error(e),c("failed")}finally{r.current=!1}},[u,e]);return(0,s.useEffect)(()=>{if(t){let e=setInterval(async()=>{if(i.current){let e=await i.current.getStats();e.forEach(e=>{"inbound-rtp"===e.type&&"video"===e.kind&&(null==t||t(e))})}},1e3);return()=>clearInterval(e)}},[t]),(0,s.useEffect)(()=>{e&&!1===r.current?m():i.current&&!1===r.current&&i.current.close()},[m,e]),(0,s.useEffect)(()=>{if(["failed","disconnected"].includes(null!=o?o:"")){let e=setTimeout(()=>{m()},5e3);return()=>clearTimeout(e)}},[m,o]),{videoRef:n,audioRef:a,connectionState:o,close:(0,s.useCallback)(()=>{var e;null===(e=i.current)||void 0===e||e.close()},[])}}(m+"/webrtc",(0,s.useCallback)(e=>{e.framesPerSecond&&_(e.framesPerSecond),e.frameHeight&&e.frameWidth&&E(e.frameWidth/e.frameHeight)},[])),[G]=(0,C.Fu)("RatOS","camera-settings"),V=(0,M.W)(null,(e,t)=>{null!=e&&A(e.getBoundingClientRect().width/e.getBoundingClientRect().height)}),F=(0,s.useRef)(null),[B,Z]=(0,s.useState)(null),[D,H]=(0,s.useState)({x:!1,y:!1}),{options:W,setOption:I}=useCameraSettings(m,"connected"===L),[X,U]=(0,s.useState)(!1),[q,J]=(0,s.useState)(!1),[Q,$]=(0,s.useState)(!1),[Y,K]=(0,s.useState)(!1),[ee,et]=(0,s.useState)(!1),[en,ea]=(0,s.useState)(!1),[ei,el]=(0,s.useState)(!1),[er,es]=(0,s.useState)(!1),[eo,ec]=(0,s.useState)(!1),[ed,eu]=(0,s.useState)(!1),[em,ex]=(0,s.useState)(1),[ef,eh]=(0,s.useState)(!1),ep=useGcodeCommand(),[eb]=(0,o.u)(),ev=useWindowSize(),eg=(0,C.Q)(e=>({tool:"extruder"===e.toolhead.extruder?"T0":"T1",homed_axes:e.toolhead.homed_axes,position:e.toolhead.position}),"toolhead"),{isVaocStarted:ej}=null!==(e=(0,C.Q)(e=>({isVaocStarted:e["gcode_macro _VAOC"].is_started}),"gcode_macro _VAOC"))&&void 0!==e?e:{isVaocStarted:!1},[ek]=(0,O.S)([eo],200,!0),[ey]=(0,O.I)([eo],190,10,!0),{hasZOffsetProbe:ew}=null!==(t=(0,C.Q)(e=>({hasZOffsetProbe:null!=e.configfile.settings.z_offset_probe}),"configfile"))&&void 0!==t?t:{hasZOffsetProbe:!1},[eN,ez]=(0,s.useState)(!1);(0,s.useEffect)(()=>{console.log(eg)},[eg]),(0,s.useEffect)(()=>{if(null!=V.current){var e,t,n;A((null===(e=V.current)||void 0===e?void 0:e.getBoundingClientRect().width)/(null===(t=V.current)||void 0===t?void 0:t.getBoundingClientRect().height))}},[ev,V]);let eC=(0,s.useCallback)(e=>{var t,n,a,i;let l=null!==(a=null===(t=P.current)||void 0===t?void 0:t.videoWidth)&&void 0!==a?a:1,r=null!==(i=null===(n=V.current)||void 0===n?void 0:n.getBoundingClientRect().width)&&void 0!==i?i:1;return e*em*(r>0&&l>0?r/l:1)},[P.current,em,ev]),e_=(0,s.useCallback)(e=>{var t,n,a,i;let l=null!==(a=null===(t=P.current)||void 0===t?void 0:t.videoWidth)&&void 0!==a?a:1,r=null!==(i=null===(n=V.current)||void 0===n?void 0:n.getBoundingClientRect().width)&&void 0!==i?i:1;return e/em/(r>0&&l>0?r/l:1)},[V,P,em]),eS=(0,s.useCallback)(e=>{var t;return eC(e)*(null!==(t=null==G?void 0:G.pixelPrMm)&&void 0!==t?t:0)},[eC,null==G?void 0:G.pixelPrMm,ev]),eO=(0,s.useCallback)(e=>{var t;return e_(e)/(null!==(t=null==G?void 0:G.pixelPrMm)&&void 0!==t?t:0)},[e_,null==G?void 0:G.pixelPrMm]),[eE,eT]=(0,O.S)([em],2e3,!0),eA=eE||Y,eP=(0,s.useCallback)(()=>{K(e=>!e),eT()},[eT]);(0,x.useGesture)({onDrag:e=>{if(e.dragging)Z([e.offset[0],e.offset[1]]),H({x:e._movementBound[0],y:e._movementBound[1]});else{var t,n;let e=-1*eO(null!==(t=null==B?void 0:B[0])&&void 0!==t?t:0),a=-1*eO(null!==(n=null==B?void 0:B[1])&&void 0!==n?n:0);ep(page_templateObject(),e,a),Z(null),H({x:!1,y:!1})}},onPinch:e=>{ex(t=>Math.max(Math.min(t*e.offset[0],10),1))},onWheel:e=>{0!=e.delta[1]&&!1!=e.wheeling&&!1!=e.intentional&&(e.delta[1]<0?ex(e=>Math.max(.85*e,1)):ex(e=>Math.min(1.15*e,10)))}},{target:P,enabled:"connected"===L,drag:{enabled:X,from:()=>[0,0],bounds:{left:-eS(1),right:eS(1),top:-eS(1),bottom:eS(1)},rubberband:!0},wheel:{axis:"y",rubberband:!1},pinch:{scaleBounds:{min:1,max:10},pinchOnWheel:!1,rubberband:!0}});let eR=[{icon:ej?l:r,id:"start/stop",name:ej?void 0:"Start Calibration",title:ej?"Stop calibration":"Start calibration",onClick:async()=>{q||(J(!0),await (ej?ep(page_templateObject1()):ep(page_templateObject2())),J(!1))},isActive:ej},{name:"T0",id:"t0",hidden:!ej,title:"Switch to tool 0 (T0)",onClick:async()=>{U(!1),await ep(page_templateObject3())},isActive:(null==eg?void 0:eg.tool)==="T0"},{name:"T1",id:"t1",hidden:!ej,title:"Switch to tool 1 (T1)",onClick:async()=>{U(!1),await ep(page_templateObject4())},isActive:(null==eg?void 0:eg.tool)==="T1"}],eL=[{icon:f,id:"zoom",title:"".concat(eA?"Hide":"Show"," zoom controls"),subButtonPosition:"before",className:"font-mono",name:em>=10?"MAX!":(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.ZP,{preserveValue:!0,start:0,end:Math.round(100*em),duration:.15}),"%"]}),onClick:()=>{eP()},isActive:eA},{icon:h,id:"light",title:"".concat(ed?"Turn off":"Turn on"," the LEDs"),onClick:async()=>{let e=!ed;await ep(page_templateObject5(),e?1:0),eu(e)},isActive:ed}],eG=(0,s.useMemo)(()=>{var e,t,n,a;return[{name:"Settings",icon:p,id:"settings",title:"Show camera settings dialog",onClick:()=>{$(e=>!e)},isActive:Q},{name:(null==eg?void 0:eg.tool)==="T0"?"Set reference":"Set offset",icon:b,isLoading:ek,hidden:!ej,id:"reference",title:"Set the ".concat((null==eg?void 0:eg.tool)==="T0"?"T0 reference point":"T1 offset"),onClick:async()=>{ez(!!ew),ec(!0),await ep(page_templateObject6()),ec(!1),U(!1)},isActive:ek},{name:X?(0,i.jsxs)("span",{className:"font-mono",children:[(0,i.jsx)(R.ZP,{preserveValue:!0,decimals:2,start:0,end:null!==(n=null==eg?void 0:null===(e=eg.position)||void 0===e?void 0:e[0])&&void 0!==n?n:0}),","," ",(0,i.jsx)(R.ZP,{preserveValue:!0,decimals:2,start:0,end:null!==(a=null==eg?void 0:null===(t=eg.position)||void 0===t?void 0:t[1])&&void 0!==a?a:0})]}):"Move",icon:v,hidden:!ej,id:"move",title:"".concat(X?"Disable":"Enable"," drag and drop calibration"),onClick:()=>{X?(el(!1),et(!1),ea(!1),es(!1),eh(!1)):(el(!0),et(!1),ea(!1),es(!1),eh(!0)),U(e=>!e)},isActive:X},{name:"Z-Probe",icon:g,title:"Probe the z endstop to set the Z offset",id:"z-probe",hidden:!ej||!ew||!eN,onClick:async()=>{await ep(page_templateObject7())},isActive:!1}]},[Q,null==eg?void 0:eg.tool,null==eg?void 0:eg.position,ek,ej,X,ew,eN,ep]),eM=(0,s.useMemo)(()=>{let e=[{icon:j,name:(0,i.jsx)("span",{children:null==z?"Loading...":(0,i.jsxs)("span",{children:[(0,i.jsx)(R.ZP,{start:0,preserveValue:!0,duration:1,end:z})," FPS"]})}),className:"font-mono",id:"settings",subButtonPosition:"before",title:"".concat(ef?"Hide":"Show"," camera controls"),onClick:()=>{ef&&(el(!1),et(!1),ea(!1),es(!1)),eh(e=>!e)},isActive:ef}];return e},[z,ef]),eV=(0,s.useMemo)(()=>{let e=[{icon:k,id:"focus",parent:"settings",hidden:en||er||ee,name:"Z Focus",title:"".concat(ei?"Hide":"Show"," focus controls"),children:(0,i.jsx)(FocusControls,{isVisible:ei,toggle:el}),onClick:()=>{el(e=>!e),et(!1),ea(!1),es(!1)},isActive:ei},{icon:ExposureIcon,id:"exposure",parent:"settings",hidden:en||er||ei,title:"".concat(ee?"Hide":"Show"," exposure controls"),name:"Exposure",onClick:()=>{et(e=>!e),ea(!1),es(!1),el(!1)},isActive:ee},{icon:y,id:"color",parent:"settings",title:"".concat(en?"Hide":"Show"," color controls"),hidden:ee||er||ei,name:"Color",onClick:()=>{ea(e=>!e),et(!1),es(!1),el(!1)},isActive:en},{icon:w,id:"advanced-camera-controls",parent:"settings",title:"".concat(er?"Hide":"Show"," advanced camera controls"),name:"Advanced",hidden:ee||en||ei,onClick:()=>{es(e=>!e),et(!1),ea(!1),el(!1)},isActive:er}];return e.reverse()},[er,ee,ei,en]),eF=null==B?0:B[0]/em,eB=null==B?0:B[1]/em,eZ=(0,s.useMemo)(()=>eS(.2),[eS]),eD=(0,s.useMemo)(()=>ek?eZ:eS(G?G.outerNozzleDiameter/2:0),[eS,ek,eZ,G]),eH=(0,s.useMemo)(()=>null==V.current||"connected"!==L?0:eD/V.current.getBoundingClientRect().width*100,[L,V,eD]),eW=(0,s.useMemo)(()=>null==V.current||"connected"!==L?0:eD/V.current.getBoundingClientRect().height*100,[L,V,eD]),eI=(0,s.useMemo)(()=>eS(.01),[eS]);return(0,i.jsx)("div",{className:"flex h-[calc(100vh_-_64px)] w-full select-none items-center",ref:F,children:(0,i.jsxs)("div",{className:"relative mx-auto flex h-full max-h-full min-h-[50vh] min-w-[50vw] max-w-fit items-center overflow-hidden object-contain shadow-lg",ref:V,children:[(0,i.jsx)("video",{ref:P,className:(0,d.m)("h-full max-h-full w-full min-w-full max-w-full transform-gpu touch-none",X&&"cursor-move",null==B&&"transition-transform ease-in-out"),style:{transform:"scale3d(".concat(em*((null==G?void 0:G.flipHorizontal)?-1:1),", ").concat(em*((null==G?void 0:G.flipVertical)?-1:1),", 1) translate3d(").concat(eF*((null==G?void 0:G.flipHorizontal)?-1:1),"px, ").concat(eB*((null==G?void 0:G.flipVertical)?-1:1),"px, 0)")},autoPlay:!0,muted:!0,playsInline:!0}),(0,i.jsxs)("div",{className:(0,c.d)("pointer-events-none absolute inset-0 flex items-center justify-center"),children:[(0,i.jsx)("div",{className:(0,c.d)("absolute inset-0",D.x&&D.x>0?"left-0 right-2/3 bg-gradient-to-r from-red-500/70 to-red-500/0":"left-2/3 right-0 bg-gradient-to-l from-red-500/70 to-red-500/0"),style:{opacity:D.x?Math.abs(D.x-(null!==(n=null==B?void 0:B[0])&&void 0!==n?n:0))/200:0}}),(0,i.jsx)("div",{className:(0,c.d)("absolute inset-0",D.y&&D.y>0?"bottom-2/3 top-0 bg-gradient-to-b from-red-500/70 to-red-500/0":"bottom-0 top-2/3 bg-gradient-to-t from-red-500/70 to-red-500/0"),style:{opacity:D.y?Math.abs(D.y-(null!==(a=null==B?void 0:B[1])&&void 0!==a?a:0))/200:0}}),(0,i.jsxs)("svg",{width:"100%",height:"100%",children:[(0,i.jsxs)("g",{className:(0,c.d)("connected"===L&&eD>0?"opacity-100":"opacity-0"),children:[(0,i.jsx)("rect",{x:"50%",y:"".concat(50-eW,"%"),height:"".concat(2*eW,"%"),width:eI,shapeRendering:"geometricPrecision",className:"fill-brand-500 transition-all ease-in-out",style:{transform:"translateX(-".concat(eI/2,")")}}),(0,i.jsx)("rect",{x:"".concat(50-eH,"%"),y:"50%",width:"".concat(2*eH,"%"),height:eI,shapeRendering:"geometricPrecision",className:"fill-brand-500 transition-all ease-in-out",style:{transform:"translateY(-".concat(eI/2,")")}})]}),(0,i.jsx)("circle",{cx:"50%",cy:"50%",r:ey?eD:1.5*eD,fill:"none",className:(0,c.d)("ease-out",ey?"fill-brand-300":"fill-brand-300/0 transition-all duration-700"),shapeRendering:"geometricPrecision",strokeWidth:0}),(0,i.jsx)("circle",{cx:"50%",cy:"50%",r:eZ,fill:"none",className:(0,c.d)("stroke-brand-500 transition-all ease-in-out","connected"===L&&eD>0?"opacity-100":"opacity-0"),shapeRendering:"geometricPrecision",strokeWidth:eI}),(0,i.jsx)("circle",{cx:"50%",cy:"50%",r:eD,fill:"none",className:(0,c.d)("stroke-brand-500 transition-all ease-in-out","connected"===L&&eD>0?"opacity-100":"opacity-0"),shapeRendering:"geometricPrecision",strokeWidth:eI})]})]}),(0,i.jsx)("div",{className:"absolute bottom-24 left-1/4 right-1/4 max-h-[50%] overflow-y-scroll rounded-md bg-zinc-900/70 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600",children:(0,i.jsxs)("div",{ref:eb,children:[ee&&W.filter(e=>e.key.toLowerCase().includes("gain")||e.key.toLowerCase().includes("exposure")||e.key.startsWith("Ae")||e.key.toLowerCase().includes("brightness")).filter(e=>"ColourGains"!==e.key).map(e=>(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("label",{className:"block text-center text-base font-semibold capitalize text-zinc-200",children:e.key}),(0,i.jsx)(Slider,{isBoolean:"toggle"in e,min:"toggle"in e?0:"min"in e?e.min:0,initialValue:!0===e.value?1:!1===e.value?0:e.value,max:"toggle"in e?1:"max"in e?e.max:0,step:"float"in e&&e.float?"any":1,onChange:t=>I(e.key,"toggle"in e?!!t:t)})]},e.key)),en&&W.filter(e=>e.key.toLowerCase().includes("saturation")||e.key.toLowerCase().includes("contrast")||e.key.startsWith("Awb")).map(e=>(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("label",{className:"block text-center text-base font-semibold capitalize text-zinc-200",children:e.key}),(0,i.jsx)(Slider,{isBoolean:"toggle"in e,min:"toggle"in e?0:"min"in e?e.min:0,initialValue:!0===e.value?1:!1===e.value?0:e.value,max:"toggle"in e?1:"max"in e?e.max:0,step:"float"in e&&e.float?"any":1,onChange:t=>I(e.key,"toggle"in e?!!t:t)})]},e.key)),er&&W.map(e=>(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("label",{className:"block text-center text-base font-semibold capitalize text-zinc-200",children:e.key}),(0,i.jsx)(Slider,{isBoolean:"toggle"in e,min:"toggle"in e?0:"min"in e?e.min:0,initialValue:!0===e.value?1:!1===e.value?0:e.value,max:"toggle"in e?1:"max"in e?e.max:0,step:"float"in e&&e.float?"any":1,onChange:t=>I(e.key,"toggle"in e?!!t:t)})]},e.key))]})}),(0,i.jsxs)("div",{className:(0,d.m)("pointer-events-none absolute inset-0 flex items-center justify-center"),children:[(0,i.jsx)("h3",{className:(0,d.m)("absolute inset-0 flex items-center justify-center text-xl font-semibold text-rose-500 transition-all dark:text-rose-500","failed"===L?"animate-pulse opacity-100":"opacity-0"),children:"Webcam stream not found"}),(0,i.jsx)(u.$,{noMargin:!0,className:(0,d.m)("h-1/3 w-1/3 animate-spin text-inherit transition-all","text-green-500 dark:text-green-500",("connected"===L||"failed"===L)&&"opacity-0","failed"===L&&"text-rose-500 dark:text-rose-500","connecting"===L&&"text-brand-500 dark:text-brand-500","closed"===L&&"text-yellow-500 dark:text-yellow-500","disconnected"===L&&"text-amber-500 dark:text-amber-500","new"===L&&"text-sky-500 dark:text-sky-500")})]}),(0,i.jsxs)("div",{className:"pointer-events-none absolute inset-0 top-1/2 -translate-y-1/2 transition-all",style:S?{aspectRatio:Math.max(S/em,T)}:{},children:[(0,i.jsx)(Toolbar,{className:"pointer-events-auto absolute left-5 top-5",buttons:eR}),(0,i.jsx)(Toolbar,{className:"pointer-events-auto absolute bottom-5 right-5 overflow-visible",buttons:eM,subButtons:eV}),(0,i.jsx)(Toolbar,{className:"pointer-events-auto absolute right-5 top-5",buttons:eL,subButtons:[{name:"1X",id:"1x",parent:"zoom",title:"Set zoom to 1X (100%)",className:"font-mono",onClick:()=>{ex(1)},isActive:!1},{name:"2X",id:"2x",parent:"zoom",title:"Set zoom to 2X (200%)",className:"font-mono",onClick:()=>{ex(2)},isActive:!1},{name:"4X",id:"4x",parent:"zoom",title:"Set zoom to 4X (400%)",className:"font-mono",onClick:()=>{ex(4)},isActive:!1}]}),(0,i.jsx)(Toolbar,{className:"pointer-events-auto absolute bottom-5 left-5",buttons:eG}),(0,i.jsx)(CameraSettingsDialog,{className:"pointer-events-auto",isVisible:Q,toggle:$})]})]})})}},81503:function(e,t,n){"use strict";n.d(t,{$:function(){return Spinner}});var a=n(26248),i=n(44838);let Spinner=e=>(0,a.jsxs)("svg",{className:(0,i.m)("h-5 w-5 animate-spin text-black dark:text-white",e.noMargin?"":"-ml-1 mr-3",e.className),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},48542:function(e,t,n){"use strict";n.d(t,{o:function(){return TextInput}});var a=n(26248),i=n(96148),l=n(6181),r=n(33964),s=n(32836),o=n.n(s),c=n(49738),d=n(50962);let TextInput=e=>{let t=(0,c.useRef)(o()(e)),{onChange:n}=e,[s,u]=(0,c.useState)(!1);(0,d.d)("h-5 w-5",(e.error,"text-red-500"));let m=e.error?(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)(r,{className:"h-5 w-5 text-red-500","aria-hidden":"true"})}):null,x=(0,d.d)(e.error?"ring-red-300 text-red-900 placeholder-red-300 focus:ring-red-500 dark:ring-red-500 dark:text-red-400 dark:placeholder-red-700":"ring-zinc-300 text-zinc-900 placeholder-zinc-300 focus:ring-brand-600 dark:ring-zinc-700 dark:text-zinc-100 dark:placeholder-zinc-700 dark:focus:ring-brand-400 ","block w-full rounded-md bg-white py-1.5 pl-3 pr-3 text-leftshadow-sm ring-1 ring-inset focus:outline-none dark:bg-zinc-800 sm:text-sm sm:leading-6 border-0"),f=e.error?(0,a.jsx)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",id:t.current+"-error",children:e.error}):null,h=e.help?(0,a.jsx)("p",{className:"mt-2 text-sm text-zinc-500",id:"email-description",children:e.help}):null,p=(0,c.useCallback)(t=>{null==n||n("number"===e.type?parseFloat(t.currentTarget.value):t.currentTarget.value)},[n,e.type]),b=(0,c.useCallback)(()=>{u(e=>!e)},[]),v="password"===e.type?(0,a.jsx)("div",{onClick:b,className:"absolute inset-y-0 ".concat(null!=m?"right-6":"right-0"," flex cursor-pointer items-center pr-3"),children:s?(0,a.jsx)(i,{className:"h-5 w-5 text-zinc-400"}):(0,a.jsx)(l,{className:"h-5 w-5 text-zinc-400"})}):null;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold leading-6 text-zinc-700 dark:text-zinc-300",children:e.label}),(0,a.jsxs)("div",{className:"relative mt-1 rounded-md shadow-sm",children:[(0,a.jsx)("input",{...e,type:s?"text":e.type,className:x,placeholder:e.placeholder,defaultValue:e.defaultValue,value:e.value,onChange:p,"aria-invalid":!!e.error,"aria-describedby":e.error?t.current+"-error":void 0}),m,v]}),null!=f?f:h]})}},63041:function(e,t,n){"use strict";n.d(t,{Z:function(){return Toggle}});var a=n(26248),i=n(40818);n(49738);var l=n(44838),r=n(50962);let Toggle=e=>(0,a.jsxs)(i.r.Group,{as:"div",className:"flex items-center justify-between gap-x-2",children:[(0,a.jsxs)("span",{className:"flex flex-grow flex-col",children:[(0,a.jsx)(i.r.Label,{as:"span",className:(0,l.m)("text-sm font-medium leading-6 text-zinc-700 dark:text-zinc-300",e.onLabel&&e.value&&"opacity-70",e.onLabel&&!e.value&&"text-brand-700 dark:text-brand-500"),passive:!0,children:e.label}),e.description&&(0,a.jsx)(i.r.Description,{as:"span",className:"text-sm text-zinc-500 dark:text-zinc-400",children:e.description})]}),(0,a.jsx)(i.r,{checked:e.value,onChange:e.onChange,className:(0,r.d)(e.value&&null==e.onLabel?"bg-brand-600":"bg-zinc-200 dark:bg-zinc-950/50","relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none"),children:(0,a.jsx)("span",{"aria-hidden":"true",className:(0,r.d)(e.value?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow-md shadow-black/20 ring-0 transition duration-200 ease-in-out dark:border-t dark:border-zinc-600 dark:bg-zinc-700 dark:shadow-black/100 ")})}),e.onLabel&&(0,a.jsx)("span",{className:"flex flex-grow flex-col",children:(0,a.jsx)(i.r.Label,{as:"span",className:(0,l.m)("text-sm font-medium leading-6 text-zinc-700 dark:text-zinc-300",e.onLabel&&!e.value&&"opacity-70",e.onLabel&&e.value&&"text-brand-700 dark:text-brand-500"),passive:!0,children:e.onLabel})})]})},21863:function(e,t,n){"use strict";n.d(t,{I:function(){return useDelayedChangeEffect},S:function(){return useChangeEffect}});var a=n(49738);let useChangeEffect=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],[i,l]=(0,a.useState)(0),r=(0,a.useRef)([...e]);(0,a.useEffect)(()=>{let t=!1;r.current.forEach((n,a)=>{n!==e[a]&&(t=!0)}),t&&l(e=>n?e+1:1),r.current=[...e]},[...e]);let s=(0,a.useCallback)(()=>{l(0)},[]);return(0,a.useEffect)(()=>{if(null!=t&&i>0){let e=setTimeout(()=>{l(0)},t);return()=>{clearTimeout(e)}}},[t,i]),[i>0,s]},useDelayedChangeEffect=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],[l,r]=(0,a.useState)(0),s=(0,a.useRef)([...e]),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{let n=!1;if(s.current.forEach((t,a)=>{t!==e[a]&&(n=!0)}),n){let trigger=()=>r(e=>i?e+1:1);o.current=window.setTimeout(()=>{trigger(),o.current=null},t)}s.current=[...e]},[...e]),(0,a.useEffect)(()=>()=>{o.current&&clearTimeout(o.current)},[]);let[c,d]=useChangeEffect([l],n,i);return[c,d]}}},function(e){e.O(0,[393,838,982,346,23,955,399,625,744],function(){return e(e.s=10944)}),_N_E=e.O()}]);