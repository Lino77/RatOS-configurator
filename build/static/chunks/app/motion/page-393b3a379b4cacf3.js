(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8411],{41817:function(e,i,r){Promise.resolve().then(r.bind(r,24123))},24123:function(e,i,r){"use strict";r.r(i),r.d(i,{default:function(){return Page}});var s=r(72612),a=r(39164),n=r(34709),t=r(94809),l=r(88192),d=r(98130),o=r(12178),c=r(59672),u=r(73371),x=r(37652),f=r(21264),g=r(79293),m=r(9948),h=r(57818),p=r(94787);let Motion=()=>{var e,i,r;let{selectedBoard:v,selectedPrinter:j,performanceMode:b,selectedPrinterRails:N,parsedPrinterConfiguration:y}=(0,x.usePrinterConfiguration)(),w=!1===y.success?y.error.format():null,[k,S]=(0,a.useState)([]),[C,z]=(0,a.useState)([]),_=(0,a.useMemo)(()=>!0===y.success?(0,x.serializePrinterConfiguration)(y.data):null,[y]),P=g.SX.printer.saveConfiguration.useMutation(),F=(0,a.useCallback)(async()=>{y.success&&P.mutate({config:(0,x.serializePrinterConfiguration)(y.data),overwriteFiles:k,skipFiles:C},{onSuccess:()=>p.A.success("Configuration saved"),onError:()=>p.A.error("Failed to save configuration")})},[y,P,k,C]),L=g.SX.useUtils().client,O=(0,m.a)({queryKey:["filesToWrite",_],queryFn:async()=>{let e=await L.printer.getFilesToWrite.mutate({config:null!=_?_:{}});return e},enabled:y.success}),M=null===(e=O.data)||void 0===e?void 0:e.some(e=>"changed"===e.state&&!0===e.changedFromConfig&&!1===e.overwrite&&!C.includes(e.fileName)&&!k.includes(e.fileName));return null==j?(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center p-8",children:(0,s.jsx)(d.$,{})}):(0,s.jsxs)("div",{className:"grid gap-8",children:[(0,s.jsx)(h.S,{id:"rails",children:(0,s.jsx)(n.i,{className:"grid gap-4 @3xl:grid-cols-2 @6xl:grid-cols-3",children:N.map((e,i)=>{var r;let a=null==j?void 0:j.defaults.rails.find(i=>i.axis===e.axis);if(null==a)throw Error("No printer default for axis "+e.axis);return(0,s.jsx)(c.l,{errors:(null==w?void 0:null===(r=w.rails)||void 0===r?void 0:r[i])!=null?w.rails[i]:{_errors:[]},selectedBoard:v,printerRail:e,printerRailDefault:(0,f.Oj)(a),performanceMode:b,isVisible:!0},e.axis)})})}),(0,s.jsx)(n.i,{children:(null!==(r=null===(i=O.data)||void 0===i?void 0:i.filter(e=>"unchanged"!==e.state).length)&&void 0!==r?r:0)>0&&(0,s.jsxs)(l.Card,{children:[(0,s.jsx)(u.Ol,{children:(0,s.jsx)(u.ll,{children:"File Changes"})}),(0,s.jsx)(u.aY,{children:(0,s.jsx)(o.o,{serializedConfig:y.success?_:null,onFilesToIgnoreChange:z,onFilesToOverwriteChange:S})}),(0,s.jsx)(u.eW,{children:(0,s.jsxs)(t.z,{onClick:F,disabled:P.isLoading||!y.success||M,children:[P.isLoading&&(0,s.jsx)(d.$,{})," Save Configuration"]})})]})})]})};var v=r(91302),j=r(56445),b=r(63278),N=r(8832),y=r(39634),w=r(2750),k=r(96886);let PrinterStateHeader=e=>{var i,r,a,n,t;let l=(0,w.PF)("general.printername",{initialData:"Loading..."}),d=g.SX.printer.getSavedPrinterName.useQuery(void 0,{initialData:"Loading..."}),o=(0,k.DS)("server.info"),c=(0,k.hS)("print_stats"),u=null===(i=c.data)||void 0===i?void 0:i.print_stats.state,x=(0,v.O)();return x?(0,s.jsxs)("div",{className:"bg-zinc-700/15 backdrop-blur-sm",children:[(0,s.jsxs)("div",{className:"mx-auto flex max-w-7xl flex-col items-start justify-between gap-x-8 px-4 py-4 @screen-sm:flex-row @screen-sm:items-center",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,s.jsx)("div",{className:(0,b.m6)("flex-none rounded-full bg-green-400/10 p-1 text-zinc-400",(null===(r=o.data)||void 0===r?void 0:r.klippy_state)==="error"&&"bg-red-400/10 text-red-400",(null===(a=o.data)||void 0===a?void 0:a.klippy_state)==="startup"&&"bg-amber-400/10 text-amber-400",(null===(n=o.data)||void 0===n?void 0:n.klippy_state)==="ready"&&"bg-green-400/10 text-green-400",(null===(t=o.data)||void 0===t?void 0:t.klippy_state)==="shutdown"&&"bg-red-400/10 text-red-400"),children:(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-current"})}),(0,s.jsxs)("h1",{className:"flex gap-x-3 text-base leading-7",children:[(0,s.jsx)("span",{className:"font-semibold text-white",children:l.data}),(0,s.jsx)("span",{className:"text-zinc-600",children:"/"}),(0,s.jsx)("span",{className:"font-semibold text-white",children:d.data})]})]})}),(0,s.jsx)(y.Ct,{className:"order-first capitalize @screen-sm:order-none",color:void 0===u?"gray":"canceled"==u?"pink":"complete"==u?"green":"error"==u?"red":"paused"===u?"sky":"printing"===u?"yellow":"standby"===u?"brand":"gray",children:void 0===u?"Offline":null!=u?u:"Loading..."})]}),(0,s.jsx)("header",{className:"sticky top-14 z-10 flex flex-grow-0 items-center gap-1 border-y border-white/5 bg-zinc-700/10 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"mx-auto w-full max-w-7xl gap-x-8 px-4 py-4",children:[(0,s.jsx)("h3",{className:"dark:focus-ring-0 flex h-auto flex-1 border-none p-0 text-xl font-medium focus:ring-0 focus:ring-offset-0",children:e.title}),(0,s.jsx)("p",{className:"dark:focus-ring-0 flex h-auto flex-1 border-none p-0 text-base font-medium text-muted-foreground focus:ring-0 focus:ring-offset-0 dark:text-muted-foreground",children:e.description})]})})]}):(0,s.jsx)(N.I,{})},LoadScreen=()=>(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsxs)("div",{className:"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700",children:[(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100",children:"Loading printer configuration..."}),(0,s.jsx)("p",{className:"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400",children:"Please wait while RatOS loads your printer configuration"})]}),(0,s.jsx)("div",{className:"mt-4 flex h-48 items-center justify-center",children:(0,s.jsx)(d.$,{})})]});function Page(){let e=(0,v.O)();return e?(0,s.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-6 @container",children:[(0,s.jsx)(PrinterStateHeader,{title:"Motion Settings",description:"You can change your motion settings below, be aware that any change will require the config to be regenerated"}),(0,s.jsx)("div",{className:"mx-auto max-w-7xl px-4",children:(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(LoadScreen,{}),children:(0,s.jsx)(j.NoSSR,{fallback:(0,s.jsx)(LoadScreen,{}),children:(0,s.jsx)(Motion,{})})})})]}):null}},2750:function(e,i,r){"use strict";r.d(i,{PF:function(){return useMainsailQuery}}),r(39164);var s=r(96886);let useMainsailQuery=(e,i)=>(0,s.A4)("mainsail",e,i)}},function(e){e.O(0,[6545,9996,660,5360,3790,1853,453,5591,9535,5847,6303,6270,9699,4787,8367,4535,7158,2745,9633,8540,1100,51,9321,8458,1744],function(){return e(e.s=41817)}),_N_E=e.O()}]);
//# sourceMappingURL=page-393b3a379b4cacf3.js.map