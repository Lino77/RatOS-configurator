(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8411],{41817:function(e,t,r){Promise.resolve().then(r.bind(r,16509))},16509:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Page}});var n=r(72612),i=r(39164),s=r(34709),l=r(94809),a=r(88192),o=r(98130),c=r(12178),u=r(59672),d=r(73371),f=r(37652),h=r(21264),p=r(79293),x=r(9948),m=r(57818),g=r(94787);let Motion=()=>{var e,t,r;let{selectedBoard:C,selectedPrinter:j,performanceMode:v,selectedPrinterRails:y,parsedPrinterConfiguration:P}=(0,f.usePrinterConfiguration)(),w=!1===P.success?P.error.format():null,[b,E]=(0,i.useState)([]),[M,N]=(0,i.useState)([]),R=(0,i.useMemo)(()=>!0===P.success?(0,f.serializePrinterConfiguration)(P.data):null,[P]),k=p.SX.printer.saveConfiguration.useMutation(),S=(0,i.useCallback)(async()=>{P.success&&k.mutate({config:(0,f.serializePrinterConfiguration)(P.data),overwriteFiles:b,skipFiles:M},{onSuccess:()=>g.A.success("Configuration saved"),onError:()=>g.A.error("Failed to save configuration")})},[P,k,b,M]),z=p.SX.useUtils().client,F=(0,x.a)({queryKey:["filesToWrite",R],queryFn:async()=>{let e=await z.printer.getFilesToWrite.mutate({config:null!=R?R:{}});return e},enabled:P.success}),L=null===(e=F.data)||void 0===e?void 0:e.some(e=>"changed"===e.state&&!0===e.changedFromConfig&&!1===e.overwrite&&!M.includes(e.fileName)&&!b.includes(e.fileName));return null==j?(0,n.jsx)("div",{className:"mx-auto flex items-center justify-center p-8",children:(0,n.jsx)(o.$,{})}):(0,n.jsxs)("div",{className:"grid gap-8",children:[(0,n.jsx)(m.S,{id:"rails",children:(0,n.jsx)(s.i,{className:"grid gap-4 @3xl:grid-cols-2 @6xl:grid-cols-3",children:y.map((e,t)=>{var r;let i=null==j?void 0:j.defaults.rails.find(t=>t.axis===e.axis);if(null==i)throw Error("No printer default for axis "+e.axis);return(0,n.jsx)(u.l,{errors:(null==w?void 0:null===(r=w.rails)||void 0===r?void 0:r[t])!=null?w.rails[t]:{_errors:[]},selectedBoard:C,printerRail:e,printerRailDefault:(0,h.Oj)(i),performanceMode:v,isVisible:!0},e.axis)})})}),(0,n.jsx)(s.i,{children:(null!==(r=null===(t=F.data)||void 0===t?void 0:t.filter(e=>"unchanged"!==e.state).length)&&void 0!==r?r:0)>0&&(0,n.jsxs)(a.Card,{children:[(0,n.jsx)(d.Ol,{children:(0,n.jsx)(d.ll,{children:"File Changes"})}),(0,n.jsx)(d.aY,{children:(0,n.jsx)(c.o,{serializedConfig:P.success?R:null,onFilesToIgnoreChange:N,onFilesToOverwriteChange:E})}),(0,n.jsx)(d.eW,{children:(0,n.jsxs)(l.z,{onClick:S,disabled:k.isLoading||!P.success||L,children:[k.isLoading&&(0,n.jsx)(o.$,{})," Save Configuration"]})})]})})]})};var C=r(91302),j=r(56445),v=r(3050);let LoadScreen=()=>(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsxs)("div",{className:"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700",children:[(0,n.jsx)("h3",{className:"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100",children:"Loading printer configuration..."}),(0,n.jsx)("p",{className:"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400",children:"Please wait while RatOS loads your printer configuration"})]}),(0,n.jsx)("div",{className:"mt-4 flex h-48 items-center justify-center",children:(0,n.jsx)(o.$,{})})]});function Page(){let e=(0,C.O)();return e?(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 @container",children:[(0,n.jsx)(v.Ch,{title:"Motion Settings",description:"You can change your motion settings below, be aware that any change will require the config to be regenerated"}),(0,n.jsx)("div",{className:"mx-auto max-w-7xl px-4",children:(0,n.jsx)(i.Suspense,{fallback:(0,n.jsx)(LoadScreen,{}),children:(0,n.jsx)(j.NoSSR,{fallback:(0,n.jsx)(LoadScreen,{}),children:(0,n.jsx)(Motion,{})})})})]}):null}},39762:function(e,t,r){"use strict";r.d(t,{M:function(){return AnimatePresence}});var n=r(72612),i=r(39164),s=r(68238),l=r(55043),a=r(86058),o=r(27231),c=r(41501);let PopChildMeasure=class PopChildMeasure extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}};function PopChild({children:e,isPresent:t}){let r=(0,i.useId)(),s=(0,i.useRef)(null),l=(0,i.useRef)({width:0,height:0,top:0,left:0}),{nonce:a}=(0,i.useContext)(c._);return(0,i.useInsertionEffect)(()=>{let{width:e,height:n,top:i,left:o}=l.current;if(t||!s.current||!e||!n)return;s.current.dataset.motionPopId=r;let c=document.createElement("style");return a&&(c.nonce=a),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${n}px !important;
            top: ${i}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),(0,n.jsx)(PopChildMeasure,{isPresent:t,childRef:s,sizeRef:l,children:i.cloneElement(e,{ref:s})})}let PresenceChild=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:l,presenceAffectsLayout:c,mode:u})=>{let d=(0,o.h)(newChildrenMap),f=(0,i.useId)(),h=(0,i.useMemo)(()=>({id:f,initial:t,isPresent:r,custom:l,onExitComplete:e=>{for(let t of(d.set(e,!0),d.values()))if(!t)return;s&&s()},register:e=>(d.set(e,!1),()=>d.delete(e))}),c?[Math.random()]:[r]);return(0,i.useMemo)(()=>{d.forEach((e,t)=>d.set(t,!1))},[r]),i.useEffect(()=>{r||d.size||!s||s()},[r]),"popLayout"===u&&(e=(0,n.jsx)(PopChild,{isPresent:r,children:e})),(0,n.jsx)(a.O.Provider,{value:h,children:e})};function newChildrenMap(){return new Map}var u=r(40472),d=r(5815),f=r(67775);let getChildKey=e=>e.key||"",AnimatePresence=({children:e,custom:t,initial:r=!0,onExitComplete:a,exitBeforeEnter:o,presenceAffectsLayout:c=!0,mode:h="sync"})=>{var p;(0,f.k)(!o,"Replace exitBeforeEnter with mode='wait'");let x=(0,i.useContext)(u.p).forceRender||(0,s.N)()[0],m=(0,l.t)(),g=function(e){let t=[];return i.Children.forEach(e,e=>{(0,i.isValidElement)(e)&&t.push(e)}),t}(e),C=g,j=(0,i.useRef)(new Map).current,v=(0,i.useRef)(C),y=(0,i.useRef)(new Map).current,P=(0,i.useRef)(!0);if((0,d.L)(()=>{P.current=!1,function(e,t){e.forEach(e=>{let r=getChildKey(e);t.set(r,e)})}(g,y),v.current=C}),p=()=>{P.current=!0,y.clear(),j.clear()},(0,i.useEffect)(()=>()=>p(),[]),P.current)return(0,n.jsx)(n.Fragment,{children:C.map(e=>(0,n.jsx)(PresenceChild,{isPresent:!0,initial:!!r&&void 0,presenceAffectsLayout:c,mode:h,children:e},getChildKey(e)))});C=[...C];let w=v.current.map(getChildKey),b=g.map(getChildKey),E=w.length;for(let e=0;e<E;e++){let t=w[e];-1!==b.indexOf(t)||j.has(t)||j.set(t,void 0)}return"wait"===h&&j.size&&(C=[]),j.forEach((e,r)=>{if(-1!==b.indexOf(r))return;let i=y.get(r);if(!i)return;let s=w.indexOf(r),l=e;l||(l=(0,n.jsx)(PresenceChild,{isPresent:!1,onExitComplete:()=>{j.delete(r);let e=Array.from(y.keys()).filter(e=>!b.includes(e));if(e.forEach(e=>y.delete(e)),v.current=g.filter(t=>{let n=getChildKey(t);return n===r||e.includes(n)}),!j.size){if(!1===m.current)return;x(),a&&a()}},custom:t,presenceAffectsLayout:c,mode:h,children:i},getChildKey(i)),j.set(r,l)),C.splice(s,0,l)}),C=C.map(e=>{let t=e.key;return j.has(t)?e:(0,n.jsx)(PresenceChild,{isPresent:!0,presenceAffectsLayout:c,mode:h,children:e},getChildKey(e))}),(0,n.jsx)(n.Fragment,{children:j.size?C:C.map(e=>(0,i.cloneElement)(e))})}},68238:function(e,t,r){"use strict";r.d(t,{N:function(){return useForceUpdate}});var n=r(39164),i=r(55043),s=r(34431);function useForceUpdate(){let e=(0,i.t)(),[t,r]=(0,n.useState)(0),l=(0,n.useCallback)(()=>{e.current&&r(t+1)},[t]),a=(0,n.useCallback)(()=>s.Wi.postRender(l),[l]);return[a,t]}},55043:function(e,t,r){"use strict";r.d(t,{t:function(){return useIsMounted}});var n=r(39164),i=r(5815);function useIsMounted(){let e=(0,n.useRef)(!1);return(0,i.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}}},function(e){e.O(0,[6545,9996,966,8965,5360,3790,453,9036,2262,254,5591,3399,8367,4535,7969,2345,6375,336,5826,9321,8458,1744],function(){return e(e.s=41817)}),_N_E=e.O()}]);
//# sourceMappingURL=page-2e42d3d37822c129.js.map