{"version":3,"file":"static/chunks/app/analysis/page-30c72533c2299100.js","mappings":"yGCAAA,QAAAC,OAAA,GAAAC,IAAA,CAAAC,EAAAC,IAAA,CAAAD,EAAA,QACAH,QAAAC,OAAA,GAAAC,IAAA,CAAAC,EAAAC,IAAA,CAAAD,EAAA,oHCEO,IAAME,gBAAkB,KAC9B,IAAMC,EAAeC,CAAAA,EAAAA,EAAAA,EAAAA,EAAqB,wBAE1C,MAAOC,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,eAAOC,CAAAA,6BAAkCC,EAAAA,MAAAA,EAAAA,EAAAA,EAAAA,EAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,CAAAA,CAAAA,EAAAA,EAAAA,CAAAA,SAAAA,CAAAA,EAAAA,CAC3D,IAAMC,EAAS,CAACF,CAAO,CAAC,EAAE,CAAC,CAC3BC,EAAKE,OAAO,CAAC,CAACC,EAAKC,KAClBH,EAAOI,IAAI,CAACF,EAAIG,QAAQ,GAAIP,CAAO,CAACK,EAAI,EAAE,CAC3C,GACA,IAAMG,EAAQN,EAAOO,IAAI,CAAC,IACpBC,EAAW,MAAMb,EAAac,WAAW,CAAC,CAAEC,OAAQJ,CAAM,GAChEK,QAAQC,GAAG,CAACN,EAAOE,EAEpB,EAAG,EAAE,CACN,wWCuBAK,EAAAA,eAAeA,CAACC,SAAS,CAAC,CACzBC,QAAS,6BACTC,QAAS,4BACV,GAEO,IAAMC,yBAA2B,SACvCC,CAAAA,MAwBKC,EAAAA,EAECA,EAAAA,EASeC,EACAC,EACAC,EAGJC,EAnBfC,EAcmBJ,EACAC,EACAC,EAGJC,CAvCjBE,CAAAA,UAAAA,MAAAA,CAAAA,GAAAA,KAAAA,IAAAA,SAAAA,CAAAA,EAAAA,EAAAA,SAAAA,CAAAA,EAAAA,CAEAC,CAAAA,EAAAA,EAAAA,CAAAA,EAAS,CAAC,cAAc,CAAE,CACzBC,QAAS,UACRC,CAAAA,EAAAA,EAAAA,EAAAA,EAAa,CACZ,yBAA0B,oCAC1B,8BAA+B,yCAC/B,uCAAwC,iDACzC,GACA,MAAMC,CAAAA,EAAAA,EAAAA,GAAAA,EAAW,QACV,QAERC,SAAU,EACX,GACA,GAAM,CAACC,EAAgBC,EAAkB,CAAGC,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAC/C,CAACC,EAAYC,EAAc,CAAGF,CAAAA,EAAAA,EAAAA,QAAAA,EAAiEG,KAAAA,GAC/FjB,EAAYkB,CAAAA,EAAAA,EAAAA,EAAAA,IACZC,EAAeC,CAAAA,EAAAA,EAAAA,EAAAA,EAAeC,EAAAA,EAAiBA,EAC/ChB,EAAON,MAAAA,EAAAA,EAAiBC,CAAS,CAAC,EAAE,CAACsB,qBAAqB,GAC1DC,EACL,OAAClB,CAAAA,EAAAA,iBAAAA,EACEc,MAAAA,EAAAA,KAAAA,EAAAA,EAAcK,IAAI,CAClBnB,iBAAAA,EAAS,OACRL,CAAAA,EAAAA,CAAS,CAAC,EAAE,GAAZA,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,OAAAA,CAAAA,EAAAA,EAAcyB,YAAY,KAA1BzB,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAA8BwB,IAAI,CAClCnB,iBAAAA,EAAS,OACRL,CAAAA,EAAAA,CAAS,CAAC,EAAE,GAAZA,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,OAAAA,CAAAA,EAAAA,EAAcyB,YAAY,KAA1BzB,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAA8BwB,IAAI,CAClCnB,QAAAA,EACC,eACA,QARLA,KAAAA,IAAAA,EAAAA,EAQe,MACXD,EAAWsB,CAAAA,EAAAA,EAAAA,EAAAA,IACXzB,EAAe0B,CAAAA,EAAAA,EAAAA,EAAAA,EAAmB,KAClCzB,EAAeyB,CAAAA,EAAAA,EAAAA,EAAAA,EAAmB,KAClCxB,EAAewB,CAAAA,EAAAA,EAAAA,EAAAA,EAAmB,KAElCC,EAAe3B,OAAAA,CAAAA,EAAAA,OAAAA,CAAAA,EAAAA,EAAa4B,IAAI,CAACC,OAAO,GAAzB7B,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAA2B8B,KAAK,GAAhC9B,KAAAA,IAAAA,EAAAA,EAAoC,KACnD+B,EAAe9B,OAAAA,CAAAA,EAAAA,OAAAA,CAAAA,EAAAA,EAAa2B,IAAI,CAACC,OAAO,GAAzB5B,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAA2B6B,KAAK,GAAhC7B,KAAAA,IAAAA,EAAAA,EAAoC,KACnD+B,EAAe9B,OAAAA,CAAAA,EAAAA,OAAAA,CAAAA,EAAAA,EAAa0B,IAAI,CAACC,OAAO,GAAzB3B,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAA2B4B,KAAK,GAAhC5B,KAAAA,IAAAA,EAAAA,EAAoC,KACnD+B,EAAyBC,CAAAA,EAAAA,EAAAA,EAAAA,EAAoB,CAACP,EAAcI,EAAcC,EAAa,EAEvFG,EAAWhC,OAAAA,CAAAA,EAAAA,OAAAA,CAAAA,EAAAA,EAASiC,OAAO,CAACP,OAAO,GAAxB1B,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAA0BkC,KAAK,CAACC,OAAO,CAACC,EAAAA,EAA2BA,CAAAA,GAAnEpC,KAAAA,IAAAA,EAAAA,EAAwE,KACnFqC,EAAsBN,CAAAA,EAAAA,EAAAA,EAAAA,EAAoBC,EAAUM,EAAAA,EAA4BA,EAEhFC,EAAOC,CAAAA,EAAAA,EAAAA,EAAAA,EAAkB7B,GACzB8B,EAAmBC,CAAAA,EAAAA,EAAAA,MAAAA,EAAe,IAAIC,OAAOC,OAAO,IAE1DC,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACLrC,GAEHiC,CAAAA,EAAiBf,OAAO,CAAG,IAAIiB,OAAOC,OAAO,GAE/C,EAAG,CAACpC,EAAe,EAEnB,IAAMsC,EAAOC,CAAAA,EAAAA,EAAAA,EAAAA,EAAkB,QAOV/C,EANpB,IAAMiC,EAAUjC,EAASiC,OAAO,CAACP,OAAO,CACxC,GAAIO,MAAAA,EACH,OAED,IAAMe,EAAU,IAAIL,OAAOC,OAAO,GAAKH,EAAiBf,OAAO,CAC/De,EAAiBf,OAAO,CAAG,IAAIiB,OAAOC,OAAO,GAC7C,IAAMK,EAAAA,OAAcjD,CAAAA,EAAAA,EAASyB,IAAI,CAACC,OAAO,GAArB1B,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAuBkD,eAAe,CAC1D,GAAID,MAAAA,EACH,MAAM,MAAU,4BAuBjB,GApBIE,EAAIC,CAAC,CAACC,WAAW,CAACC,MAAM,GAAKH,EAAIC,CAAC,CAACG,SAAS,CAACD,MAAM,EACtDE,CAAAA,EAAAA,EAAAA,CAAAA,IAAYC,IAAI,CACf,wDAAqFN,MAAAA,CAA7BA,EAAIC,CAAC,CAACG,SAAS,CAACD,MAAM,CAAC,QAA+BI,MAAA,CAAzBP,EAAIC,CAAC,CAACC,WAAW,CAACC,MAAM,CAAC,MAG5GH,EAAIQ,CAAC,CAACN,WAAW,CAACC,MAAM,GAAKH,EAAIQ,CAAC,CAACJ,SAAS,CAACD,MAAM,EACtDE,CAAAA,EAAAA,EAAAA,CAAAA,IAAYC,IAAI,CACf,wDAAqFN,MAAAA,CAA7BA,EAAIQ,CAAC,CAACJ,SAAS,CAACD,MAAM,CAAC,QAA+BI,MAAA,CAAzBP,EAAIQ,CAAC,CAACN,WAAW,CAACC,MAAM,CAAC,MAG5GH,EAAIS,CAAC,CAACP,WAAW,CAACC,MAAM,GAAKH,EAAIS,CAAC,CAACL,SAAS,CAACD,MAAM,EACtDE,CAAAA,EAAAA,EAAAA,CAAAA,IAAYC,IAAI,CACf,wDAAqFN,MAAAA,CAA7BA,EAAIS,CAAC,CAACL,SAAS,CAACD,MAAM,CAAC,QAA+BI,MAAA,CAAzBP,EAAIS,CAAC,CAACP,WAAW,CAACC,MAAM,CAAC,MAG5GH,EAAIU,KAAK,CAACR,WAAW,CAACC,MAAM,GAAKH,EAAIU,KAAK,CAACN,SAAS,CAACD,MAAM,EAC9DE,CAAAA,EAAAA,EAAAA,CAAAA,IAAYC,IAAI,CACf,6DAA8FN,MAAAA,CAAjCA,EAAIU,KAAK,CAACN,SAAS,CAACD,MAAM,CAAC,QAAmCI,MAAA,CAA7BP,EAAIU,KAAK,CAACR,WAAW,CAACC,MAAM,CAAC,MAGzHH,EAAIC,CAAC,CAACC,WAAW,CAACC,MAAM,GAAKrB,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAACC,KAAK,GAAI,CAC1F/B,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAACE,KAAK,GACtDhC,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAACE,KAAK,GACtDhC,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAACE,KAAK,GACtDhC,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,SAAS4B,UAAU,CAACE,KAAK,GACzDhC,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAAkBG,WAAW,CAC7Ef,EAAIC,CAAC,CAACC,WAAW,CACjBF,EAAIC,CAAC,CAACG,SAAS,EAEftB,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAAkBG,WAAW,CAC7Ef,EAAIQ,CAAC,CAACN,WAAW,CACjBF,EAAIQ,CAAC,CAACJ,SAAS,EAEftB,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,KAAK4B,UAAU,CAAkBG,WAAW,CAC7Ef,EAAIS,CAAC,CAACP,WAAW,CACjBF,EAAIS,CAAC,CAACL,SAAS,EAEftB,EAAQ6B,gBAAgB,CAAC3B,OAAO,CAAC,SAAS4B,UAAU,CAAkBG,WAAW,CACjFf,EAAIU,KAAK,CAACR,WAAW,CACrBF,EAAIU,KAAK,CAACN,SAAS,EAEpBlB,EAAoB,IAAI8B,EAAAA,WAAWA,CAAChB,EAAIU,KAAK,CAACO,UAAU,CAACC,GAAG,CAAElB,EAAIU,KAAK,CAACO,UAAU,CAACE,GAAG,GACtF,MACD,CACArB,EAAYG,CAAC,CAACa,KAAK,GACnBhB,EAAYU,CAAC,CAACM,KAAK,GACnBhB,EAAYW,CAAC,CAACK,KAAK,GACnBhB,EAAYY,KAAK,CAACI,KAAK,GACvBhB,EAAYG,CAAC,CAACc,WAAW,CAACf,EAAIC,CAAC,CAACC,WAAW,CAAEF,EAAIC,CAAC,CAACG,SAAS,EAC5DN,EAAYU,CAAC,CAACO,WAAW,CAACf,EAAIQ,CAAC,CAACN,WAAW,CAAEF,EAAIQ,CAAC,CAACJ,SAAS,EAC5DN,EAAYW,CAAC,CAACM,WAAW,CAACf,EAAIS,CAAC,CAACP,WAAW,CAAEF,EAAIS,CAAC,CAACL,SAAS,EAC5DN,EAAYY,KAAK,CAACK,WAAW,CAACf,EAAIU,KAAK,CAACR,WAAW,CAAEF,EAAIU,KAAK,CAACN,SAAS,EACxEtB,EAAQ6B,gBAAgB,CACtB3B,OAAO,CAAC,KACRoC,YAAY,CAAC,IAAIC,EAAAA,aAAaA,CAAC,CAAEC,SAAUzB,EAAS0B,KAAMC,EAAAA,MAAMA,CAACC,SAAS,CAAEb,WAAYd,EAAYG,CAAC,IACvGnB,EAAQ6B,gBAAgB,CACtB3B,OAAO,CAAC,KACRoC,YAAY,CAAC,IAAIC,EAAAA,aAAaA,CAAC,CAAEC,SAAUzB,EAAS0B,KAAMC,EAAAA,MAAMA,CAACC,SAAS,CAAEb,WAAYd,EAAYU,CAAC,IACvG1B,EAAQ6B,gBAAgB,CACtB3B,OAAO,CAAC,KACRoC,YAAY,CAAC,IAAIC,EAAAA,aAAaA,CAAC,CAAEC,SAAUzB,EAAS0B,KAAMC,EAAAA,MAAMA,CAACC,SAAS,CAAEb,WAAYd,EAAYW,CAAC,IACvG3B,EAAQ6B,gBAAgB,CACtB3B,OAAO,CAAC,SACRoC,YAAY,CACZ,IAAIM,EAAAA,iBAAiBA,CAAC,CAAEJ,SAAUzB,EAAS0B,KAAMC,EAAAA,MAAMA,CAACC,SAAS,CAAEb,WAAYd,EAAYY,KAAK,IAElGxB,EAAoB,IAAI8B,EAAAA,WAAWA,CAAChB,EAAIU,KAAK,CAACO,UAAU,CAACC,GAAG,CAAElB,EAAIU,KAAK,CAACO,UAAU,CAACE,GAAG,EACvF,GACMQ,EAAYC,CAAAA,EAAAA,EAAAA,EAAAA,EAAexC,EAAKyC,UAAU,CAAElC,EAAKmC,MAAM,EACvDC,EAAgBC,CAAAA,EAAAA,EAAAA,EAAAA,EAAsB5C,EAAM,MAAO6C,EAAMhC,EAAGO,EAAGC,KAEpE,IAAMyB,EAAKC,CAAAA,EAAAA,EAAAA,EAAAA,EAAclC,GACnBmC,EAAKD,CAAAA,EAAAA,EAAAA,EAAAA,EAAc3B,GACnB6B,EAAKF,CAAAA,EAAAA,EAAAA,EAAAA,EAAc1B,GACzBR,EAAEqC,OAAO,GACT9B,EAAE8B,OAAO,GACT7B,EAAE6B,OAAO,GACT3H,QAAQ4H,GAAG,CAAC,CAACN,EAAKO,KAAK,GAAIN,EAAGM,KAAK,GAAIJ,EAAGI,KAAK,GAAIH,EAAGG,KAAK,GAAG,EAAE3H,IAAI,CAAC,QACpE6B,EACAC,EACAC,EACAF,EACAC,EACAC,KANqE,CAAC6F,EAAUC,EAAOC,EAAOC,EAAM,CAAAC,CAC3E,QAAzBnG,CAAAA,EAAAA,EAAa4B,IAAI,CAACC,OAAO,GAAzB7B,KAAAA,IAAAA,GAAAA,EAA2BoG,UAAU,CAAC/B,WAAW,CAAC0B,EAAUC,GACnC,OAAzB/F,CAAAA,EAAAA,EAAa2B,IAAI,CAACC,OAAO,GAAzB5B,KAAAA,IAAAA,GAAAA,EAA2BmG,UAAU,CAAC/B,WAAW,CAAC0B,EAAUE,GACnC,OAAzB/F,CAAAA,EAAAA,EAAa0B,IAAI,CAACC,OAAO,GAAzB3B,KAAAA,IAAAA,GAAAA,EAA2BkG,UAAU,CAAC/B,WAAW,CAAC0B,EAAUG,GACnC,OAAzBlG,CAAAA,EAAAA,EAAa4B,IAAI,CAACC,OAAO,GAAzB7B,KAAAA,IAAAA,GAAAA,EAA2BqG,WAAW,CAAChC,WAAW,CAAC0B,EAAUC,GACpC,OAAzB/F,CAAAA,EAAAA,EAAa2B,IAAI,CAACC,OAAO,GAAzB5B,KAAAA,IAAAA,GAAAA,EAA2BoG,WAAW,CAAChC,WAAW,CAAC0B,EAAUE,GACpC,OAAzB/F,CAAAA,EAAAA,EAAa0B,IAAI,CAACC,OAAO,GAAzB3B,KAAAA,IAAAA,GAAAA,EAA2BmG,WAAW,CAAChC,WAAW,CAAC0B,EAAUG,EAC9D,GACAjE,IACAgD,EAAUM,EAAMC,EAAIE,EAAIC,EAAI,GAC7B,GAeA,MAdAW,CAAAA,EAAAA,EAAAA,EAAAA,EAAU5D,EAAKyC,UAAU,CAACtD,OAAO,CAAG0E,EAAAA,EAAuBA,CAAE5F,EAAiB0E,EAAgBrE,KAAAA,GAE9FwF,CAAAA,EAAAA,EAAAA,EAAAA,EAAkB,CACjBC,OAAQrG,EACRsG,QAAS/F,EACTgG,aAAcjE,EAAK0C,MAAM,CACzBwB,sBAAuBnI,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,IAClCsC,EAAc8F,EACf,EAAG,EAAE,EACLC,sBAAuBrI,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,IAClCmC,EAAkB,IAClBmG,EAAAA,CAAKA,CAACC,KAAK,CAAC,iCAAkC,CAAEC,YAAaC,EAAIC,OAAO,EACzE,EAAG,EAAE,CACN,GACOC,CAAAA,EAAAA,EAAAA,OAAAA,EACN,IAAO,EACNzG,eAAAA,EACAC,kBAAAA,EACAqC,KAAAA,EACAoE,qBAAsBjH,EACtBkH,iCAAkChG,EAClCiG,WAAY,CACXvH,aAAAA,EACAC,aAAAA,EACAC,aAAAA,EACAC,SAAAA,CACD,CACD,GACA,CAACQ,EAAgBsC,EAAM7C,EAAMkB,EAAkBtB,EAAcC,EAAcC,EAAcC,EAAS,CAEpG,EAIaqH,EAA8DC,EAAAA,IAAU,CACpF,OAAC,CAAEzH,aAAAA,CAAY,CAAEC,aAAAA,CAAY,CAAEC,aAAAA,CAAY,CAAEC,SAAAA,CAAQ,CAAE,CAAAgG,EACtD,MACC,GAAAuB,EAAAC,IAAA,EAACC,MAAAA,CAAIC,UAAU,qEAEd,GAAAH,EAAAC,IAAA,EAACC,MAAAA,CAAIC,UAAU,0DACd,GAAAH,EAAAC,IAAA,EAACG,EAAAA,CAAIA,CAAAA,CAACD,UAAU,2FACf,GAAAH,EAAAC,IAAA,EAACI,KAAAA,CAAGF,UAAU,gGACb,GAAAH,EAAAM,GAAA,EAACJ,MAAAA,CAAIC,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO,wEACtB,GAAAP,EAAAM,GAAA,EAACJ,MAAAA,CAAIC,UAAU,sCAEhB,GAAAH,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,yBAAgB,gBAEjC,GAAAH,EAAAM,GAAA,EAACG,EAAAA,EAAaA,CAAAA,CACZ,GAAGnI,EAAaoI,YAAY,CAC7BP,UAAU,oBACVQ,SAAU,GAAAX,EAAAM,GAAA,EAACM,EAAAA,CAAcA,CAAAA,CAACT,UAAU,gCAGtC,GAAAH,EAAAC,IAAA,EAACG,EAAAA,CAAIA,CAAAA,CAACD,UAAU,2FACf,GAAAH,EAAAC,IAAA,EAACI,KAAAA,CAAGF,UAAU,gGACb,GAAAH,EAAAM,GAAA,EAACJ,MAAAA,CAAIC,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO,kEACtB,GAAAP,EAAAM,GAAA,EAACJ,MAAAA,CAAIC,UAAU,sCAEhB,GAAAH,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,yBAAgB,gBAEjC,GAAAH,EAAAM,GAAA,EAACG,EAAAA,EAAaA,CAAAA,CACZ,GAAGlI,EAAamI,YAAY,CAC7BP,UAAU,oBACVQ,SAAU,GAAAX,EAAAM,GAAA,EAACM,EAAAA,CAAcA,CAAAA,CAACT,UAAU,gCAGtC,GAAAH,EAAAC,IAAA,EAACG,EAAAA,CAAIA,CAAAA,CAACD,UAAU,2FACf,GAAAH,EAAAC,IAAA,EAACI,KAAAA,CAAGF,UAAU,gGACb,GAAAH,EAAAM,GAAA,EAACJ,MAAAA,CAAIC,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO,oEACtB,GAAAP,EAAAM,GAAA,EAACJ,MAAAA,CAAIC,UAAU,sCAEhB,GAAAH,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,yBAAgB,gBAEjC,GAAAH,EAAAM,GAAA,EAACG,EAAAA,EAAaA,CAAAA,CACZ,GAAGjI,EAAakI,YAAY,CAC7BP,UAAU,oBACVQ,SAAU,GAAAX,EAAAM,GAAA,EAACM,EAAAA,CAAcA,CAAAA,CAACT,UAAU,mCAIvC,GAAAH,EAAAM,GAAA,EAACF,EAAAA,CAAIA,CAAAA,CAACD,UAAU,uCACf,GAAAH,EAAAM,GAAA,EAACG,EAAAA,EAAaA,CAAAA,CACZ,GAAGhI,EAASiI,YAAY,CACzBP,UAAU,SACVQ,SAAU,GAAAX,EAAAM,GAAA,EAACM,EAAAA,CAAcA,CAAAA,CAACT,UAAU,iCAKzC,6SCxRD,IAAMU,GAASd,EAAAA,UAAgB,CAG7B,CAAAtB,EAA0BqC,QAAzB,CAAEX,UAAAA,CAAS,CAAE,GAAGY,EAAO,CAAAtC,QACzB,GAAAuB,EAAAC,IAAA,EAACe,EAAAA,EAAoB,EACpBF,IAAKA,EACLX,UAAWc,CAAAA,EAAAA,EAAAA,EAAAA,EAAG,2DAA4Dd,GACzE,GAAGY,CAAK,WAET,GAAAf,EAAAM,GAAA,EAACU,EAAAA,EAAqB,EACrBb,UAAWc,CAAAA,EAAAA,EAAAA,EAAAA,EACV,yDACA,oIACA,2HAGD,GAAAjB,EAAAM,GAAA,EAACU,EAAAA,EAAqB,EACrBb,UAAWc,CAAAA,EAAAA,EAAAA,EAAAA,EACV,+CACA,oIACA,uHAIH,GAAAjB,EAAAM,GAAA,EAACU,EAAAA,EAAqB,EACrBb,UAAWc,CAAAA,EAAAA,EAAAA,EAAAA,EACV,yFACA,mGACA,oIACA,gDACA,wKAGmB,GAEvBC,CAAAA,EAAAA,EAAAA,CAAAA,EAAeL,GAAQG,EAAAA,EAAoB,CAACG,WAAW,mYCGvDpJ,EAAAA,eAAeA,CAACC,SAAS,CAAC,CACzBC,QAAS,6BACTC,QAAS,4BACV,GAIA,IAAMkJ,cAAgB,SAACC,CAAAA,MAAuCC,EAAAA,UAAAA,MAAAA,CAAAA,GAAAA,KAAAA,IAAAA,SAAAA,CAAAA,EAAAA,EAAAA,SAAAA,CAAAA,EAAAA,CACvD,CAACC,EAAWC,EAAa,CAAGrI,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,GACrCsI,EAAetG,CAAAA,EAAAA,EAAAA,MAAAA,EAAOoG,EAC5BE,CAAAA,EAAatH,OAAO,CAAGoH,EACvB,GAAM,CAACG,EAAMC,EAAQ,CAAGxI,CAAAA,EAAAA,EAAAA,QAAAA,EAAgC,KAClDyI,EAAUzG,CAAAA,EAAAA,EAAAA,MAAAA,EAAOuG,EACvBE,CAAAA,EAAQzH,OAAO,CAAGuH,EAClB,IAAMG,EAAgB1G,CAAAA,EAAAA,EAAAA,MAAAA,EAAO,IACvB2G,EAAe3G,CAAAA,EAAAA,EAAAA,MAAAA,EAAOmG,EAC5BQ,CAAAA,EAAa3H,OAAO,CAAGmH,EAEvB,IAAMS,EAAYhL,CAAAA,EAAAA,EAAAA,WAAAA,EAAY,UAC7B,GAAI0K,EAAatH,OAAO,EAAI,EAC3B,OAGD,IAAM6H,EAAU,IAAMP,EAAatH,OAAO,CAEpC8H,EAAYC,KAAKC,KAAK,CAACD,KAAKnF,GAAG,CAAC,IAAKqF,IAAmBA,IAAkBJ,GAChFH,CAAAA,EAAc1H,OAAO,CAAG,GACxB,IAAMkI,EAAYT,MAAAA,EAAQzH,OAAO,CAAW,MAAQyH,MAAAA,EAAQzH,OAAO,CAAW,OAASyH,EAAQzH,OAAO,CAChGmI,EAAc,IAAIlH,OAAOC,OAAO,GACtC,GAAI,CACH,MAAMgG,EAAAA,kBACWI,EAAatH,OAAO,CAAS8H,EAAY,IAAaI,GAEvE,IAAME,EAAgB,IAAInH,OAAOC,OAAO,GAAKiH,CAC7CT,CAAAA,EAAc1H,OAAO,CAAG,GACpBsH,EAAatH,OAAO,CAAG,GAAK2H,EAAa3H,OAAO,EAAIoI,EAAgBN,EAAY,EACnFF,IAEAS,WAAW,KACVT,GACD,EAAGE,EAAYM,EAEjB,CAAE,MAAOE,EAAG,CACXZ,EAAc1H,OAAO,CAAG,GACxB8B,CAAAA,EAAAA,EAAAA,CAAAA,IAAYqD,KAAK,CAACmD,EAAG,uBACrBpD,EAAAA,CAAKA,CAACC,KAAK,CAAC,sBAAuB,CAClCC,YAAa,wKAG4IpD,MAAA,CAA3EsG,aAAaC,MAAQD,EAAEhD,OAAO,CAAGgD,aAAaE,OAASF,EAAI,gBAAgB,4BAG1J,EACD,CACD,EAAG,CAACpB,EAAE,EAON,MANA/F,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,KACLiG,EAAY,GAAK,CAACM,EAAc1H,OAAO,EAAImH,GAC9CS,GAEF,EAAG,CAACA,EAAWR,EAAWD,EAAU,EAE7B,CAAEC,UAAAA,EAAWC,aAAAA,EAAcE,KAAAA,EAAMC,QAAAA,CAAQ,CACjD,EAEMiB,GAA+F,CACpGC,QAAQvD,CAAK,CAAEwD,CAAS,EACvB7G,CAAAA,EAAAA,EAAAA,CAAAA,IAAYqD,KAAK,CAAC,0CAA2C,CAC5DA,MAAAA,EACAwD,UAAW,CAAE,GAAGA,CAAS,CAAEC,IAAK,oBAAqB,CACtD,EACD,CACD,EAEaC,SAAW,KACvB,GAAM,CAACC,EAAO,CAAGC,EAAAA,EAAIA,CAACC,QAAQ,CAACC,SAAS,CAACC,gBAAgB,CAAC,CAAEC,MAAO,EAAG,GAChEC,EAASC,CAAAA,EAAAA,EAAAA,SAAAA,IACTnL,EAAYkB,CAAAA,EAAAA,EAAAA,EAAAA,IACZkK,EAAY/D,CAAAA,EAAAA,EAAAA,OAAAA,EACjB,IAAMrH,EAAUqL,IAAI,CAAC,GAAQC,WAAAA,EAAGhK,qBAAqB,IAAmBgK,WAAAA,EAAGC,qBAAqB,IAChG,CAACvL,EAAU,EAEN,CAACK,EAAMmL,EAAQ,CAAG1K,CAAAA,EAAAA,EAAAA,QAAAA,EAAkDd,CAAS,CAAC,EAAE,CAACsB,qBAAqB,IACtG,CACLV,eAAAA,CAAc,CACdC,kBAAAA,CAAiB,CACjB2G,WAAAA,CAAU,CACVtE,KAAAA,CAAI,CACJoE,qBAAAA,CAAoB,CACpBC,iCAAAA,CAAgC,CAChC,CAAGzH,yBAAyBO,GACvB,CAAEf,YAAamM,CAAoB,CAAE,CAAGZ,EAAAA,EAAIA,CAACC,QAAQ,CAACY,aAAa,CAACC,WAAW,CAACpB,IAEhF,CAACqB,EAAaC,EAAe,CAAG/K,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IACzC,CAACgL,EAAgBC,EAAkB,CAAGjL,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAC/CkL,EAAelJ,CAAAA,EAAAA,EAAAA,MAAAA,EAAqB,MACpCkG,EAAIzK,CAAAA,EAAAA,EAAAA,CAAAA,IAEJ,CAAE2K,UAAAA,EAAS,CAAEC,aAAAA,EAAY,CAAEE,KAAAA,EAAI,CAAEC,QAAAA,EAAO,CAAE,CAAGP,cAAcC,EAAGpI,GAAkB,CAACkL,GAEjFG,GAAkBnJ,CAAAA,EAAAA,EAAAA,MAAAA,EAAO,IAAIoJ,iBAE7BC,GAAWzN,CAAAA,EAAAA,EAAAA,WAAAA,EAChB,SAAoC0N,CAAAA,6BAA+DxN,EAAAA,MAAAA,EAAAA,EAAAA,EAAAA,EAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,CAAAA,CAAAA,EAAAA,EAAAA,CAAAA,SAAAA,CAAAA,EAAAA,QAClG,UACCqN,GAAgBnK,OAAO,CAAG,IAAIoK,gBAC9B/C,GAAa,GACb4C,EAAkB,IAClBlL,EAAkB,IAClB,GAAI,CACH,MAAMuL,EAAMH,GAAgBnK,OAAO,CAACuK,MAAM,IAAKzN,EAChD,CAAE,MAAOwL,EAAG,CACP6B,GAAgBnK,OAAO,CAACuK,MAAM,CAACC,OAAO,EAAKlC,aAAamC,cAAgBnC,eAAAA,EAAE5I,IAAI,EACjFoC,CAAAA,EAAAA,EAAAA,CAAAA,IAAY4I,IAAI,CAACpC,EAAG,qBACpBpD,EAAAA,CAAKA,CAACwF,IAAI,CAAC,oBAAqB,CAC/BtF,YAAa,2BACd,KAEAtD,CAAAA,EAAAA,EAAAA,CAAAA,IAAYqD,KAAK,CAAE,mBAAmBmD,GACtCpD,EAAAA,CAAKA,CAACC,KAAK,CAAC,eAAgB,CAC3BC,YACCkD,aAAaC,MACVD,EAAEhD,OAAO,CACTgD,aAAaE,OACZF,EACA,mDACN,GAEF,QAAU,CACT2B,EAAkB,IAClBF,EAAe,IACfhL,EAAkB,IAClBmL,EAAalK,OAAO,CAAG,IACxB,CACD,GACD,CAACqH,GAActI,EAAkB,EAG5B4L,GAAYpF,CAAAA,EAAAA,EAAAA,OAAAA,EACjB,IACCuE,EACC,GAAAjE,EAAAM,GAAA,EAACyE,EAAAA,GAAaA,CAAAA,CAAC5E,UAAU,mCACtBgE,EACH,GAAAnE,EAAAM,GAAA,EAAC0E,EAAAA,CAAOA,CAAAA,CAACC,SAAU,GAAM9E,UAAU,+CAEnC,GAAAH,EAAAM,GAAA,EAAC4E,EAAAA,CAAcA,CAAAA,CAAC/E,UAAU,2EAE5B,CAACgE,EAAgBF,EAAY,EAGxBkB,GAAapO,CAAAA,EAAAA,EAAAA,WAAAA,EAClB,GACCyN,GAAS,MAAOY,IACff,EAAalK,OAAO,CAAGsK,EACvB,IAAMY,EAAaC,EAAAA,CAAO,GACpBC,EAA4B,EAAE,CAC9BC,EAAYf,EAAMe,SAAS,CAACC,GAAG,CAAC,GAAc,cAK3CC,EACJA,EAaAA,EAlBJ,GAAIN,EAAMT,OAAO,CAChB,MAAM,IAAIC,aAAa,4BAA6B,cAErD,IAAMe,EAAU,IAAIvK,OAAOC,OAAO,GAMlC,GALAwI,EAAAA,OAAQ6B,CAAAA,EAAAA,EAASE,SAAS,GAAlBF,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAoBtN,aAAa,EACzC,QAAIsN,CAAAA,EAAAA,EAASE,SAAS,GAAlBF,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAoBG,UAAU,IACjC,MAAMtK,EAAKuK,iBAAiB,GAC5B5B,EAAe,KAEZkB,EAAMT,OAAO,CAGhB,MAFA,MAAMpJ,EAAKwK,gBAAgB,GAC3B7B,EAAe,IACT,IAAIU,aAAa,4BAA6B,cAMrD,GAJA,MAAMvD,EAAAA,mBACHqE,EAASlO,KAAK,EAGjB,OAAIkO,CAAAA,EAAAA,EAASE,SAAS,GAAlBF,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAoBG,UAAU,CAAE,CACnC,IAAM9C,EAAM,MAAMxH,EAAKwK,gBAAgB,GAEvC,GADA7B,EAAe,IACXkB,EAAMT,OAAO,CAChB,MAAM,IAAIC,aAAa,4BAA6B,cAErDW,EAAUjO,IAAI,CACbwM,EAAqB,CACpB8B,UAAW,CACVI,GAAIV,EAAAA,CAAO,GACXW,oBAAqBZ,EACrBa,QAASzB,EAAMuB,EAAE,CACjBG,WAAYT,EAASM,EAAE,CACvBI,eAAgBT,EAChBU,aAAc,IAAIjL,OAAOC,OAAO,GAChC0H,IAAAA,EACAlJ,KAAM6L,EAAS7L,IAAI,CACnBzB,cAAeuH,EACf2G,sBAAuB1G,CACxB,CACD,GAEF,CACD,GAEA,GADA,MAAM4F,EAAUe,MAAM,CAAC,CAACC,EAAGC,IAAMD,EAAE/P,IAAI,CAACgQ,GAAIlQ,QAAQC,OAAO,IACvD4O,EAAMT,OAAO,CAChB,MAAM,IAAIC,aAAa,4BAA6B,cAErD,IAAM8B,EAAgBrH,EAAAA,CAAKA,CAACsH,OAAO,CAAC,uBAAwB,CAC3DpH,YAAa,yCACd,GACA,GAAI,CACH,MAAMhJ,QAAQ4H,GAAG,CAACoH,GAClBlG,EAAAA,CAAKA,CAACuH,OAAO,CAAC,sBAAuB,CACpCZ,GAAIU,EACJnH,YAAa,UAAqBpD,MAAA,CAAXsI,EAAM5K,IAAI,CAAC,4BAClCgN,OAAQ,CACPC,MAAO,cACPC,QAAS,IAAMxD,EAAOjM,IAAI,CAAC,oBAA2C+N,MAAAA,CAAvBZ,EAAMuB,EAAE,CAAC,gBAAyB7J,MAAA,CAAXkJ,GACvE,CACD,EACD,CAAE,MAAO5C,EAAG,CACXpD,EAAAA,CAAKA,CAACC,KAAK,CAAC,mBAAoB,CAC/B0G,GAAIU,EACJnH,YAAa,yDAAoEpD,MAAA,CAAXsI,EAAM5K,IAAI,CAAC,IAClF,EACD,CACD,GACD,CAACwH,EAAGyC,EAAsBvI,EAAMoE,EAAsBC,EAAkC2D,EAAQiB,GAAS,EAuO1G,MApOAwC,CAAAA,EAAAA,EAAAA,EAAAA,EACC,WACAjQ,CAAAA,EAAAA,EAAAA,WAAAA,EACC,QAwKKkM,EA+BOoB,QAtMX,GAAArE,EAAAC,IAAA,EAAAD,EAAAiH,QAAA,YACC,GAAAjH,EAAAC,IAAA,EAACiH,EAAKC,WAAW,YAChB,GAAAnH,EAAAC,IAAA,EAACiH,EAAKE,cAAc,EAACjH,UAAU,sDAC9B,GAAAH,EAAAM,GAAA,EAAC4G,EAAKG,WAAW,EAACC,KAAMC,EAAAA,CAAUA,CAAEpH,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAOtH,GAAkB,oBAAsB,IAC9F,GAAA+G,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,4BAAmB,cAEpC,GAAAH,EAAAC,IAAA,EAACiH,EAAKM,cAAc,EAACC,iBAAkB,GAAOhF,EAAEiF,cAAc,aAC7D,GAAA1H,EAAAC,IAAA,EAACiH,EAAKS,UAAU,YACf,GAAA3H,EAAAC,IAAA,EAACiH,EAAKU,iBAAiB,YACtB,GAAA5H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMQ,EAAAA,CAAMA,GAAI,oBAE1C,GAAA9H,EAAAM,GAAA,EAAC4G,EAAKa,iBAAiB,WACtB,GAAA/H,EAAAC,IAAA,EAACiH,EAAKc,iBAAiB,EAACC,MAAOvP,EAAMwP,cAAe,GAAOrE,EAAQpB,aAClE,GAAAzC,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,MACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO7H,QAAAA,GAAkB,gCACpC0P,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMe,EAAAA,CAAUA,GAAI,UAG9C,GAAArI,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,eACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO7H,iBAAAA,GAA2B,gCAC7C0P,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMgB,EAAAA,CAAGA,GAAI,mBAGtCjQ,CAAS,CAAC,EAAE,CAACkQ,YAAY,IACzB,GAAAvI,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,eACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO7H,iBAAAA,GAA2B,gCAC7C0P,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMkB,EAAAA,CAAcA,GAAI,kBAIlDnQ,EAAU0D,MAAM,CAAG,GAAK1D,CAAS,CAAC,EAAE,CAACkQ,YAAY,IACjD,GAAAvI,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,eACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO7H,iBAAAA,GAA2B,gCAC7C0P,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMkB,EAAAA,CAAcA,GAAI,kBAIlD/E,GACA,GAAAzD,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,SACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO7H,WAAAA,GAAqB,gCACvC0P,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMmB,EAAAA,CAAMA,GAAI,oBAO9C,GAAAzI,EAAAM,GAAA,EAAC4G,EAAKwB,gBAAgB,KACtB,GAAA1I,EAAAC,IAAA,EAACiH,EAAKyB,WAAW,EAChBC,SAAU3P,GAAkBkL,EAC5B4C,QAAS,UACR7N,EAAkB,GACnB,YAEA,GAAA8G,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMuB,EAAAA,CAAIA,GAAI,YAExC,GAAA7I,EAAAC,IAAA,EAACiH,EAAKyB,WAAW,EAChBC,SAAU,CAAC3P,GAAkBkL,EAC7B4C,QAAS,UACR7N,EAAkB,GACnB,YAEA,GAAA8G,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMwB,EAAAA,CAAKA,GAAI,iBAI3C,GAAA9I,EAAAC,IAAA,EAACiH,EAAKC,WAAW,YAChB,GAAAnH,EAAAC,IAAA,EAACiH,EAAKE,cAAc,EAACjH,UAAU,sDAC9B,GAAAH,EAAAM,GAAA,EAAC4G,EAAKG,WAAW,EAACC,KAAMyB,EAAAA,CAAWA,GAAI,IAAC,GAAA/I,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,4BAAmB,aAE5E,GAAAH,EAAAC,IAAA,EAACiH,EAAKM,cAAc,EAACC,iBAAkB,GAAOhF,EAAEiF,cAAc,aAC7D,GAAA1H,EAAAC,IAAA,EAACiH,EAAKyB,WAAW,EAChBC,SAAUzE,EACViE,SAAU5D,GAAS,UAClB,MAAMnD,EAAAA,mBACP,aAEA,GAAArB,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAM0B,EAAAA,CAAIA,GAAI,kBAGxC,GAAAhJ,EAAAM,GAAA,EAAC4G,EAAKwB,gBAAgB,KAEtB,GAAA1I,EAAAC,IAAA,EAACiH,EAAKS,UAAU,YACf,GAAA3H,EAAAC,IAAA,EAACiH,EAAKU,iBAAiB,YACtB,GAAA5H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAM2B,EAAAA,CAAaA,GAAI,iBAEjD,GAAAjJ,EAAAC,IAAA,EAACiH,EAAKa,iBAAiB,YACtB,GAAA/H,EAAAC,IAAA,EAACiH,EAAKc,iBAAiB,EAACC,MAAOvG,GAAMwG,cAAe,GAAOvG,GAAQc,aAClE,GAAAzC,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,IACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAOmB,MAAAA,IAAgBH,GAAY,GAAK,gCACnD6G,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAM4B,EAAAA,CAAcA,GAAI,qBAElD,GAAAlJ,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,IACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAOmB,MAAAA,IAAgBH,GAAY,GAAK,gCACnD6G,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAM6B,EAAAA,CAAYA,GAAI,qBAEhD,GAAAnJ,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,IACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAOmB,MAAAA,IAAgBH,GAAY,GAAK,gCACnD6G,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAM8B,EAAAA,CAAYA,GAAI,qBAEhD,GAAApJ,EAAAC,IAAA,EAACiH,EAAKiB,gBAAgB,EACrBF,MAAM,IACN9H,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAOmB,MAAAA,IAAgBH,GAAY,GAAK,gCACnD6G,SAAU,GAAO3F,EAAEiF,cAAc,aAEjC,GAAA1H,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAM+B,EAAAA,CAAaA,GAAI,wBAGlD,GAAArJ,EAAAM,GAAA,EAAC4G,EAAKwB,gBAAgB,KACtB,GAAA1I,EAAAC,IAAA,EAACC,MAAAA,CAAIC,UAAU,yBACd,GAAAH,EAAAC,IAAA,EAACI,KAAAA,CAAGF,UAAU,kEACb,GAAAH,EAAAM,GAAA,EAACgJ,GAAAA,CAAKA,CAAAA,CACLC,KAAK,SACLC,KAAM,EACNzM,IAAK,IACLD,IAAK,EACL2M,QAAS,GAAOhH,EAAEiH,eAAe,GACjCC,UAAW,GAAOlH,EAAEiH,eAAe,GACnCvJ,UAAU,6GACV8H,MAAO1G,GAAUqI,OAAO,CAAC,GACzBC,MAAO,CAAEC,MAAOvI,GAAUqI,OAAO,CAAC,GAAG7N,MAAM,CAAG,KAAM,EACpDgO,SAAU,GAAOvI,GAAawI,WAAWvH,EAAEwH,MAAM,CAAChC,KAAK,KACtD,QAGH,GAAAjI,EAAAM,GAAA,EAACO,GAAMA,CACN/D,IAAK,EACLqD,UAAU,OACVpD,IAAK,IACLkL,MAAO,CAAC1G,GAAU,CAClB2G,cAAe,GAAS1G,GAAa0I,CAAG,CAAC,EAAE,EAC3CC,KAAM,oBAOZ,GAAAnK,EAAAC,IAAA,EAACiH,EAAKC,WAAW,YAChB,GAAAnH,EAAAC,IAAA,EAACiH,EAAKE,cAAc,EAACjH,UAAU,sDAC7B2E,GAAU,IAAC,GAAA9E,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,4BAAmB,cAEhD,GAAAH,EAAAC,IAAA,EAACiH,EAAKM,cAAc,EAACC,iBAAkB,GAAOhF,EAAEiF,cAAc,aAC/C,OAAbzE,CAAAA,EAAAA,EAAO/L,MAAM,GAAb+L,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAewC,GAAG,CAAC,QAKApB,EAEjBA,QANF,GAAArE,EAAAC,IAAA,EAACiH,EAAKyB,WAAW,EAEhBC,SAAUzE,EACViE,SAAUjD,GAAWV,GACrBtE,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO8D,CAAAA,OAAAA,CAAAA,EAAAA,EAAalK,OAAO,GAApBkK,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAsB2B,EAAE,IAAKvB,EAAMuB,EAAE,EAAI,wCAE1D3B,CAAAA,OAAAA,CAAAA,EAAAA,EAAalK,OAAO,GAApBkK,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAsB2B,EAAE,IAAKvB,EAAMuB,EAAE,CAAGlB,GAAY,GAAA9E,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMuB,EAAAA,CAAIA,GACvFpE,EAAM5K,IAAI,GANN4K,EAAMuB,EAAE,IASf,GAAAhG,EAAAM,GAAA,EAAC4G,EAAKwB,gBAAgB,KACtB,GAAA1I,EAAAM,GAAA,EAAC4G,EAAKyB,WAAW,EAACC,SAAUzE,EAAgBiG,QAAS,GAAMjK,UAAU,gBACpE,GAAAH,EAAAC,IAAA,EAACoK,IAAIA,CAACC,KAAK,6BACV,GAAAtK,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMiD,EAAAA,CAAIA,GAAI,mBACvC,GAAAvK,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,yEACf,GAAAH,EAAAM,GAAA,EAACkK,EAAAA,CAASA,CAAAA,CAACrK,UAAU,mBAIxB,GAAAH,EAAAM,GAAA,EAAC4G,EAAKyB,WAAW,EAACC,SAAUzE,EAAgBiG,QAAS,GAAMjK,UAAU,gBACpE,GAAAH,EAAAC,IAAA,EAACoK,IAAIA,CAACC,KAAK,iCACV,GAAAtK,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMmD,EAAAA,CAAIA,GAAI,aACvC,GAAAzK,EAAAM,GAAA,EAACE,OAAAA,CAAKL,UAAU,yEACf,GAAAH,EAAAM,GAAA,EAACkK,EAAAA,CAASA,CAAAA,CAACrK,UAAU,mBAIxB,GAAAH,EAAAM,GAAA,EAAC4G,EAAKwB,gBAAgB,KACtB,GAAA1I,EAAAC,IAAA,EAACiH,EAAKyB,WAAW,EAACC,SAAU,CAACzE,EAAgB4C,QAAS,IAAMzC,GAAgBnK,OAAO,CAACiL,KAAK,aACxF,GAAApF,EAAAM,GAAA,EAAC4G,EAAKW,kBAAkB,EAACP,KAAMoD,EAAAA,CAAGA,CAAEvK,UAAWI,CAAAA,EAAAA,EAAAA,CAAAA,EAAO4D,GAAkB,kBAAmB,SACpFE,CAAAA,OAAAA,CAAAA,EAAAA,EAAalK,OAAO,GAApBkK,KAAAA,IAAAA,EAAAA,KAAAA,EAAAA,EAAsBxK,IAAI,GAAI,gBAM1C,CACCZ,EACAP,EACAL,EACAoL,EACAU,EACAK,GACA9C,GACAH,GACAuD,GACA7B,EAAO/L,MAAM,CACbgC,EACAmI,EACAM,GACAH,GACA2D,GACA,GAII,GAAAnF,EAAAM,GAAA,EAACR,EAAqBA,CAAE,GAAGD,CAAU,EAC7C,4GChfA,IAAM8K,EAAeC,CAAAA,EAAAA,EAAAA,CAAAA,EAAI,CACxB,oDACA,oIACA,+CACA,iKACA,EAMYxK,KAA4B,GACjC,GAAAyK,EAAAvK,GAAA,EAACJ,MAAAA,CAAIC,UAAWwK,EAAa,CAAExK,UAAWY,EAAMZ,SAAS,YAAMY,EAAM+J,QAAQ,kICTrF,IAAMC,EAAgBH,CAAAA,EAAAA,EAAAA,CAAAA,EACrBrK,CAAAA,EAAAA,EAAAA,CAAAA,EACC,+FACA,oGACA,iKACA,mLACA,kGACA,mDAED,CACCyK,SAAU,CACTC,QAAS,CACRC,MAAO,kFACPC,QAAS,4BACT7L,MACC,2HACF,CACD,EACA8L,gBAAiB,CAChBH,QAAS,OACV,CACD,GAKK3B,EAAQvJ,EAAAA,UAAgB,CAA+B,CAAAtB,EAAgCqC,QAA/B,CAAEX,UAAAA,CAAS,CAAEoJ,KAAAA,CAAI,CAAE,GAAGxI,EAAO,CAAAtC,EAC1F,MAAO,GAAAoM,EAAAvK,GAAA,EAAC+K,QAAAA,CAAM9B,KAAMA,EAAMpJ,UAAWc,CAAAA,EAAAA,EAAAA,EAAAA,EAAG8J,EAAchK,GAAQZ,GAAYW,IAAKA,EAAM,GAAGC,CAAK,EAC9F,GACAG,CAAAA,EAAAA,EAAAA,CAAAA,EAAeoI,EAAO","sources":["webpack://_N_E/ignored|/home/runner/work/RatOS-configurator/RatOS-configurator/src/node_modules/.pnpm/seedrandom@3.0.5/node_modules/seedrandom|crypto","webpack://_N_E/?a79b","webpack://_N_E/./app/_hooks/toolhead.ts","webpack://_N_E/./app/analysis/realtime-analysis-chart.tsx","webpack://_N_E/./components/ui/slider.tsx","webpack://_N_E/./app/analysis/analysis.tsx","webpack://_N_E/./components/common/card.tsx","webpack://_N_E/./components/ui/input.tsx","webpack://_N_E/<anon>"],"sourcesContent":["/* (ignored) */","import(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/app/analysis/analysis.tsx\");\nimport(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/components/common/no-ssr.tsx\")","import { useCallback } from 'react';\nimport { useMoonrakerMutation } from '@/moonraker/hooks';\n\nexport const useGcodeCommand = () => {\n\tconst executeGcode = useMoonrakerMutation('printer.gcode.script');\n\n\treturn useCallback(async (command: TemplateStringsArray, ...args: (number | string)[]) => {\n\t\tconst result = [command[0]];\n\t\targs.forEach((arg, i) => {\n\t\t\tresult.push(arg.toString(), command[i + 1]);\n\t\t});\n\t\tconst gcode = result.join('') as GCode;\n\t\tconst gcodeRes = await executeGcode.mutateAsync({ script: gcode });\n\t\tconsole.log(gcode, gcodeRes);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n};\n","'use client';\n\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { useToolheads } from '@/hooks/useToolheadConfiguration';\nimport { Card } from '@/components/common/card';\nimport {\n\tPSDChartMinimumYVisibleRange,\n\tPSD_CHART_AXIS_AMPLITUDE_ID,\n\tuseADXLSignalChart,\n\tusePSDChart,\n\tADXL_STREAM_BUFFER_SIZE,\n} from '@/app/analysis/charts';\nimport { twJoin } from 'tailwind-merge';\nimport { SciChartReact } from 'scichart-react';\nimport {\n\tuseADXLFifoTensor,\n\tuseAccumulatedPSD,\n\tuseBufferedADXLSignal,\n\tuseBufferedPSD,\n\tuseDynamicAxisRange,\n\tuseRealtimeSensor,\n\tuseTicker,\n} from '@/app/analysis/hooks';\nimport { LineAnimation, MountainAnimation, NumberRange, SciChartSurface, XyDataSeries, easing } from 'scichart';\nimport { detrendSignal } from '@/app/analysis/periodogram';\nimport { FullLoadScreen } from '@/components/common/full-load-screen';\nimport { KlipperAccelSubscriptionResponse, MacroRecordingSettings } from '@/zods/analysis';\nimport { useRecoilValue } from 'recoil';\nimport { ControlboardState } from '@/recoil/printer';\nimport { toast } from 'sonner';\nimport { getLogger } from '@/app/_helpers/logger';\nimport { AccelerometerType } from '@/zods/hardware';\nimport { z } from 'zod';\nimport { useQuery } from '@tanstack/react-query';\nimport { setWasmPaths } from '@tensorflow/tfjs-backend-wasm';\nimport '@tensorflow/tfjs-backend-cpu';\nimport { setBackend } from '@tensorflow/tfjs-core';\n\nSciChartSurface.configure({\n\twasmUrl: '/configure/scichart2d.wasm',\n\tdataUrl: '/configure/scichart2d.data',\n});\n\nexport const useRealtimeAnalysisChart = (\n\taccelerometer?: MacroRecordingSettings['accelerometer'],\n\taccelerometerType: z.infer<typeof AccelerometerType> = 'adxl345',\n) => {\n\tuseQuery(['wasmBackend'], {\n\t\tqueryFn: async () => {\n\t\t\tsetWasmPaths({\n\t\t\t\t'tfjs-backend-wasm.wasm': '/configure/tfjs-backend-wasm.wasm',\n\t\t\t\t'tfjs-backend-wasm-simd.wasm': '/configure/tfjs-backend-wasm-simd.wasm',\n\t\t\t\t'tfjs-backend-wasm-threaded-simd.wasm': '/configure/tfjs-backend-wasm-threaded-simd.wasm',\n\t\t\t});\n\t\t\tawait setBackend('wasm');\n\t\t\treturn 'wasm';\n\t\t},\n\t\tsuspense: true,\n\t});\n\tconst [isChartEnabled, setIsChartEnabled] = useState(false);\n\tconst [dataHeader, setDataHeader] = useState<KlipperAccelSubscriptionResponse['header'] | undefined>(undefined);\n\tconst toolheads = useToolheads();\n\tconst controlBoard = useRecoilValue(ControlboardState);\n\tconst adxl = accelerometer ?? toolheads[0].getYAccelerometerName();\n\tconst adxlHardwareName =\n\t\t(adxl === 'controlboard'\n\t\t\t? controlBoard?.name\n\t\t\t: adxl === 'toolboard_t0'\n\t\t\t\t? toolheads[0]?.getToolboard()?.name\n\t\t\t\t: adxl === 'toolboard_t1'\n\t\t\t\t\t? toolheads[1]?.getToolboard()?.name\n\t\t\t\t\t: adxl === 'rpi'\n\t\t\t\t\t\t? 'Raspberry Pi'\n\t\t\t\t\t\t: 'N/A') ?? 'N/A';\n\tconst psdChart = usePSDChart();\n\tconst xSignalChart = useADXLSignalChart('x');\n\tconst ySignalChart = useADXLSignalChart('y');\n\tconst zSignalChart = useADXLSignalChart('z');\n\n\tconst xSignalYAxis = xSignalChart.data.current?.yAxis ?? null;\n\tconst ySignalYAxis = ySignalChart.data.current?.yAxis ?? null;\n\tconst zSignalYAxis = zSignalChart.data.current?.yAxis ?? null;\n\tconst updateSignalChartRange = useDynamicAxisRange([xSignalYAxis, ySignalYAxis, zSignalYAxis]);\n\n\tconst psdYAxis = psdChart.surface.current?.yAxes.getById(PSD_CHART_AXIS_AMPLITUDE_ID) ?? null;\n\tconst updatePsdChartRange = useDynamicAxisRange(psdYAxis, PSDChartMinimumYVisibleRange);\n\n\tconst fifo = useADXLFifoTensor(dataHeader);\n\tconst timeSinceLastPsd = useRef<number>(new Date().getTime());\n\n\tuseEffect(() => {\n\t\tif (isChartEnabled) {\n\t\t\t// Reset time since last PSD calculation\n\t\t\ttimeSinceLastPsd.current = new Date().getTime();\n\t\t}\n\t}, [isChartEnabled]);\n\n\tconst psds = useAccumulatedPSD((res) => {\n\t\tconst surface = psdChart.surface.current;\n\t\tif (surface == null) {\n\t\t\treturn;\n\t\t}\n\t\tconst elapsed = new Date().getTime() - timeSinceLastPsd.current;\n\t\ttimeSinceLastPsd.current = new Date().getTime();\n\t\tconst animationDS = psdChart.data.current?.animationSeries;\n\t\tif (animationDS == null) {\n\t\t\tthrow new Error('No animation data series');\n\t\t}\n\t\t// Log lengths if estimates and frequencies aren't the same length\n\t\tif (res.x.frequencies.length !== res.x.estimates.length) {\n\t\t\tgetLogger().warn(\n\t\t\t\t`X estimates and frequencies are not the same length (${res.x.estimates.length} vs ${res.x.frequencies.length})`,\n\t\t\t);\n\t\t}\n\t\tif (res.y.frequencies.length !== res.y.estimates.length) {\n\t\t\tgetLogger().warn(\n\t\t\t\t`Y estimates and frequencies are not the same length (${res.y.estimates.length} vs ${res.y.frequencies.length})`,\n\t\t\t);\n\t\t}\n\t\tif (res.z.frequencies.length !== res.z.estimates.length) {\n\t\t\tgetLogger().warn(\n\t\t\t\t`Z estimates and frequencies are not the same length (${res.z.estimates.length} vs ${res.z.frequencies.length})`,\n\t\t\t);\n\t\t}\n\t\tif (res.total.frequencies.length !== res.total.estimates.length) {\n\t\t\tgetLogger().warn(\n\t\t\t\t`Total estimates and frequencies are not the same length  (${res.total.estimates.length} vs ${res.total.frequencies.length})`,\n\t\t\t);\n\t\t}\n\t\tif (res.x.frequencies.length !== surface.renderableSeries.getById('x').dataSeries.count()) {\n\t\t\tsurface.renderableSeries.getById('x').dataSeries.clear();\n\t\t\tsurface.renderableSeries.getById('y').dataSeries.clear();\n\t\t\tsurface.renderableSeries.getById('z').dataSeries.clear();\n\t\t\tsurface.renderableSeries.getById('total').dataSeries.clear();\n\t\t\t(surface.renderableSeries.getById('x').dataSeries as XyDataSeries).appendRange(\n\t\t\t\tres.x.frequencies,\n\t\t\t\tres.x.estimates,\n\t\t\t);\n\t\t\t(surface.renderableSeries.getById('y').dataSeries as XyDataSeries).appendRange(\n\t\t\t\tres.y.frequencies,\n\t\t\t\tres.y.estimates,\n\t\t\t);\n\t\t\t(surface.renderableSeries.getById('z').dataSeries as XyDataSeries).appendRange(\n\t\t\t\tres.z.frequencies,\n\t\t\t\tres.z.estimates,\n\t\t\t);\n\t\t\t(surface.renderableSeries.getById('total').dataSeries as XyDataSeries).appendRange(\n\t\t\t\tres.total.frequencies,\n\t\t\t\tres.total.estimates,\n\t\t\t);\n\t\t\tupdatePsdChartRange(new NumberRange(res.total.powerRange.min, res.total.powerRange.max));\n\t\t\treturn;\n\t\t}\n\t\tanimationDS.x.clear();\n\t\tanimationDS.y.clear();\n\t\tanimationDS.z.clear();\n\t\tanimationDS.total.clear();\n\t\tanimationDS.x.appendRange(res.x.frequencies, res.x.estimates);\n\t\tanimationDS.y.appendRange(res.y.frequencies, res.y.estimates);\n\t\tanimationDS.z.appendRange(res.z.frequencies, res.z.estimates);\n\t\tanimationDS.total.appendRange(res.total.frequencies, res.total.estimates);\n\t\tsurface.renderableSeries\n\t\t\t.getById('x')\n\t\t\t.runAnimation(new LineAnimation({ duration: elapsed, ease: easing.inOutCirc, dataSeries: animationDS.x }));\n\t\tsurface.renderableSeries\n\t\t\t.getById('y')\n\t\t\t.runAnimation(new LineAnimation({ duration: elapsed, ease: easing.inOutCirc, dataSeries: animationDS.y }));\n\t\tsurface.renderableSeries\n\t\t\t.getById('z')\n\t\t\t.runAnimation(new LineAnimation({ duration: elapsed, ease: easing.inOutCirc, dataSeries: animationDS.z }));\n\t\tsurface.renderableSeries\n\t\t\t.getById('total')\n\t\t\t.runAnimation(\n\t\t\t\tnew MountainAnimation({ duration: elapsed, ease: easing.inOutCirc, dataSeries: animationDS.total }),\n\t\t\t);\n\t\tupdatePsdChartRange(new NumberRange(res.total.powerRange.min, res.total.powerRange.max));\n\t});\n\tconst updatePsd = useBufferedPSD(fifo.sampleRate, psds.onData);\n\tconst updateSignals = useBufferedADXLSignal(fifo, async (time, x, y, z) => {\n\t\t// Center the signals by subtracting the mean\n\t\tconst dX = detrendSignal(x);\n\t\tconst dY = detrendSignal(y);\n\t\tconst dZ = detrendSignal(z);\n\t\tx.dispose();\n\t\ty.dispose();\n\t\tz.dispose();\n\t\tPromise.all([time.array(), dX.array(), dY.array(), dZ.array()]).then(([timeData, xData, yData, zData]) => {\n\t\t\txSignalChart.data.current?.signalData.appendRange(timeData, xData);\n\t\t\tySignalChart.data.current?.signalData.appendRange(timeData, yData);\n\t\t\tzSignalChart.data.current?.signalData.appendRange(timeData, zData);\n\t\t\txSignalChart.data.current?.historyData.appendRange(timeData, xData);\n\t\t\tySignalChart.data.current?.historyData.appendRange(timeData, yData);\n\t\t\tzSignalChart.data.current?.historyData.appendRange(timeData, zData);\n\t\t});\n\t\tupdateSignalChartRange();\n\t\tupdatePsd(time, dX, dY, dZ, true);\n\t});\n\tuseTicker(fifo.sampleRate.current / ADXL_STREAM_BUFFER_SIZE, isChartEnabled ? updateSignals : undefined);\n\n\tuseRealtimeSensor({\n\t\tsensor: adxl,\n\t\tenabled: isChartEnabled,\n\t\tonDataUpdate: fifo.onData,\n\t\tonSubscriptionSuccess: useCallback((header: KlipperAccelSubscriptionResponse['header']) => {\n\t\t\tsetDataHeader(header);\n\t\t}, []),\n\t\tonSubscriptionFailure: useCallback((err: Error) => {\n\t\t\tsetIsChartEnabled(false);\n\t\t\ttoast.error('Failed to subscribe to ADXL345', { description: err.message });\n\t\t}, []),\n\t});\n\treturn useMemo(\n\t\t() => ({\n\t\t\tisChartEnabled,\n\t\t\tsetIsChartEnabled,\n\t\t\tpsds,\n\t\t\tcurrentAccelerometer: adxl,\n\t\t\tcurrentAccelerometerHardwareName: adxlHardwareName,\n\t\t\tchartProps: {\n\t\t\t\txSignalChart,\n\t\t\t\tySignalChart,\n\t\t\t\tzSignalChart,\n\t\t\t\tpsdChart,\n\t\t\t},\n\t\t}),\n\t\t[isChartEnabled, psds, adxl, adxlHardwareName, xSignalChart, ySignalChart, zSignalChart, psdChart],\n\t);\n};\n\ntype RealtimeAnalysisChartProps = ReturnType<typeof useRealtimeAnalysisChart>['chartProps'];\n\nexport const RealtimeAnalysisChart: React.FC<RealtimeAnalysisChartProps> = React.memo(\n\t({ xSignalChart, ySignalChart, zSignalChart, psdChart }) => {\n\t\treturn (\n\t\t\t<div className=\"flex max-h-full min-h-full flex-col space-y-4 @container\">\n\t\t\t\t{/* <Toolbar buttons={toolbarButtons} /> */}\n\t\t\t\t<div className=\"grid grid-cols-1 gap-4 @screen-lg:grid-cols-3\">\n\t\t\t\t\t<Card className=\"flex max-h-32 min-h-32 overflow-hidden @screen-lg:max-h-72 @screen-lg:min-h-72\">\n\t\t\t\t\t\t<h3 className=\"text-md absolute left-0 right-0 top-0 flex items-center space-x-2 p-4 font-semibold\">\n\t\t\t\t\t\t\t<div className={twJoin('flex-none rounded-full bg-yellow-400/10 p-1 text-yellow-400')}>\n\t\t\t\t\t\t\t\t<div className=\"h-2 w-2 rounded-full bg-current\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-zinc-100\">X Signal</span>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<SciChartReact\n\t\t\t\t\t\t\t{...xSignalChart.forwardProps}\n\t\t\t\t\t\t\tclassName=\"flex-1 rounded-lg\"\n\t\t\t\t\t\t\tfallback={<FullLoadScreen className=\"ml-[150px] bg-zinc-900\" />}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Card>\n\t\t\t\t\t<Card className=\"flex max-h-32 min-h-32 overflow-hidden @screen-lg:max-h-72 @screen-lg:min-h-72\">\n\t\t\t\t\t\t<h3 className=\"text-md absolute left-0 right-0 top-0 flex items-center space-x-2 p-4 font-semibold\">\n\t\t\t\t\t\t\t<div className={twJoin('flex-none rounded-full bg-sky-400/10 p-1 text-sky-400')}>\n\t\t\t\t\t\t\t\t<div className=\"h-2 w-2 rounded-full bg-current\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-zinc-100\">Y Signal</span>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<SciChartReact\n\t\t\t\t\t\t\t{...ySignalChart.forwardProps}\n\t\t\t\t\t\t\tclassName=\"flex-1 rounded-lg\"\n\t\t\t\t\t\t\tfallback={<FullLoadScreen className=\"ml-[150px] bg-zinc-900\" />}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Card>\n\t\t\t\t\t<Card className=\"flex max-h-32 min-h-32 overflow-hidden @screen-lg:max-h-72 @screen-lg:min-h-72\">\n\t\t\t\t\t\t<h3 className=\"text-md absolute left-0 right-0 top-0 flex items-center space-x-2 p-4 font-semibold\">\n\t\t\t\t\t\t\t<div className={twJoin('flex-none rounded-full bg-rose-400/10 p-1 text-rose-400')}>\n\t\t\t\t\t\t\t\t<div className=\"h-2 w-2 rounded-full bg-current\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span className=\"text-zinc-100\">Z Signal</span>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<SciChartReact\n\t\t\t\t\t\t\t{...zSignalChart.forwardProps}\n\t\t\t\t\t\t\tclassName=\"flex-1 rounded-lg\"\n\t\t\t\t\t\t\tfallback={<FullLoadScreen className=\"ml-[150px] bg-zinc-900\" />}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Card>\n\t\t\t\t</div>\n\t\t\t\t<Card className=\"flex flex-1 overflow-hidden\">\n\t\t\t\t\t<SciChartReact\n\t\t\t\t\t\t{...psdChart.forwardProps}\n\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\tfallback={<FullLoadScreen className=\"ml-[150px] bg-zinc-900\" />}\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t);\n\t},\n);\n","'use client';\n\nimport * as React from 'react';\nimport * as SliderPrimitive from '@radix-ui/react-slider';\n\nimport { cn, setDisplayName } from '@/helpers/utils';\n\nconst Slider = React.forwardRef<\n\tReact.ElementRef<typeof SliderPrimitive.Root>,\n\tReact.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n\t<SliderPrimitive.Root\n\t\tref={ref}\n\t\tclassName={cn('relative flex w-full touch-none select-none items-center', className)}\n\t\t{...props}\n\t>\n\t\t<SliderPrimitive.Track\n\t\t\tclassName={cn(\n\t\t\t\t'relative h-1.5 w-full grow rounded-full bg-zinc-400/10',\n\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:-inset-[1px] dark:before:rounded-full dark:before:transition-all',\n\t\t\t\t'dark:before:shadow-[0px_-1px_0px_0px_hsl(var(--zinc-400)_/_15%)_inset,_inset_0px_1px_2px_0px_rgba(0,0,0,0.55)]',\n\t\t\t)}\n\t\t>\n\t\t\t<SliderPrimitive.Range\n\t\t\t\tclassName={cn(\n\t\t\t\t\t'absolute h-full rounded-full bg-brand-400/80',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:-inset-[1px] dark:before:rounded-full dark:before:transition-all',\n\t\t\t\t\t'dark:before:shadow-[inset_0px_-1px_0px_0px_hsl(var(--brand-200)_/_20%),_inset_0px_1px_2px_0px_rgba(0,0,0,0.55)]',\n\t\t\t\t)}\n\t\t\t/>\n\t\t</SliderPrimitive.Track>\n\t\t<SliderPrimitive.Thumb\n\t\t\tclassName={cn(\n\t\t\t\t'block h-4 w-4 rounded-full border border-zinc-700 bg-zinc-700 shadow transition-colors',\n\t\t\t\t'focus-visible:outline-none focus-visible:ring-0 disabled:pointer-events-none disabled:opacity-50',\n\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.03)]',\n\t\t\t\t'dark:before:inset-px dark:before:rounded-full',\n\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--zinc-900)),_0px_1px_0px_0px_hsl(var(--zinc-400)_/_20%)_inset]',\n\t\t\t)}\n\t\t/>\n\t</SliderPrimitive.Root>\n));\nsetDisplayName(Slider, SliderPrimitive.Root.displayName);\n\nexport { Slider };\n","'use client';\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { useGcodeCommand } from '@/app/_hooks/toolhead';\nimport { twJoin } from 'tailwind-merge';\nimport { DotFilledIcon } from '@radix-ui/react-icons';\nimport { Spinner } from '@/components/common/spinner';\nimport { SciChartSurface } from 'scichart';\nimport { useTopMenu } from '@/app/topmenu';\nimport { RealtimeAnalysisChart, useRealtimeAnalysisChart } from '@/app/analysis/realtime-analysis-chart';\nimport Link from 'next/link';\nimport { trpc } from '@/utils/trpc';\nimport { Macro, MacroRecordingSettings } from '@/zods/analysis';\nimport * as uuid from 'uuid';\nimport { toast } from 'sonner';\nimport { useRouter } from 'next/navigation';\nimport { getLogger } from '@/app/_helpers/logger';\nimport {\n\tArrowDownToDot,\n\tAudioLines,\n\tAudioWaveform,\n\tBan,\n\tCpu,\n\tHome,\n\tList,\n\tMove3D,\n\tMoveDiagonal,\n\tMoveDiagonal2,\n\tMoveHorizontal,\n\tMoveRight,\n\tMoveVertical,\n\tPause,\n\tPencilRuler,\n\tPlay,\n\tPlus,\n\tServerIcon,\n\tSquareFunction,\n\tTarget,\n} from 'lucide-react';\nimport { Slider } from '@/components/ui/slider';\nimport { Input } from '@/components/ui/input';\nimport { useToolheads } from '@/hooks/useToolheadConfiguration';\nimport { KlipperAccelSensorName } from '@/zods/hardware';\n\nSciChartSurface.configure({\n\twasmUrl: '/configure/scichart2d.wasm',\n\tdataUrl: '/configure/scichart2d.data',\n});\n\nconst TARGET_OSC_TIME = 500;\n\nconst useOscillator = (G: ReturnType<typeof useGcodeCommand>, isEnabled: boolean = false) => {\n\tconst [frequency, setFrequency] = useState(0);\n\tconst frequencyRef = useRef(frequency);\n\tfrequencyRef.current = frequency;\n\tconst [axis, setAxis] = useState<'x' | 'y' | 'a' | 'b'>('x');\n\tconst axisRef = useRef(axis);\n\taxisRef.current = axis;\n\tconst isOscillating = useRef(false);\n\tconst isEnabledRef = useRef(isEnabled);\n\tisEnabledRef.current = isEnabled;\n\n\tconst oscillate = useCallback(async () => {\n\t\tif (frequencyRef.current <= 0) {\n\t\t\treturn;\n\t\t}\n\t\t// time to do a full oscillation (250ms t_seq)\n\t\tconst oscTime = 500 / frequencyRef.current;\n\t\t// aim for TARGET_OSC_TIME to allow for relatively fast updates\n\t\tconst macroTime = Math.floor(Math.max(250, TARGET_OSC_TIME - (TARGET_OSC_TIME % oscTime)));\n\t\tisOscillating.current = true;\n\t\tconst direction = axisRef.current === 'a' ? '1,1' : axisRef.current === 'b' ? '1,-1' : axisRef.current;\n\t\tconst beforeGcode = new Date().getTime();\n\t\ttry {\n\t\t\tawait G`\n\t\t\tOSCILLATE FREQ=${frequencyRef.current} TIME=${macroTime / 1000} AXIS=${direction}\n\t\t\t`;\n\t\t\tconst gcodeDuration = new Date().getTime() - beforeGcode;\n\t\t\tisOscillating.current = false;\n\t\t\tif (frequencyRef.current > 0 && isEnabledRef.current && gcodeDuration > macroTime / 2) {\n\t\t\t\toscillate();\n\t\t\t} else {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\toscillate();\n\t\t\t\t}, macroTime - gcodeDuration);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tisOscillating.current = false;\n\t\t\tgetLogger().error(e, 'Failed to oscillate');\n\t\t\ttoast.error('Failed to oscillate', {\n\t\t\t\tdescription: `\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<p>An error occurred while trying to oscillate the printer:</p>\n\t\t\t\t\t\t<pre class=\"text-wrap mt-4 text-rose-400 font-medium whitespace-pre-wrap\">${e instanceof Error ? e.message : e instanceof String ? e : 'Unknown error'}</pre>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t});\n\t\t}\n\t}, [G]);\n\tuseEffect(() => {\n\t\tif (frequency > 0 && !isOscillating.current && isEnabled) {\n\t\t\toscillate();\n\t\t}\n\t}, [oscillate, frequency, isEnabled]);\n\n\treturn { frequency, setFrequency, axis, setAxis } as const;\n};\n\nconst macroRecordingMutationOptions: Parameters<typeof trpc.analysis.saveRecording.useMutation>[0] = {\n\tonError(error, variables) {\n\t\tgetLogger().error('Failed to save macro sequence recording', {\n\t\t\terror,\n\t\t\tvariables: { ...variables, psd: 'removed from log..' },\n\t\t});\n\t},\n};\n\nexport const Analysis = () => {\n\tconst [macros] = trpc.analysis.getMacros.useSuspenseQuery({ limit: 10 });\n\tconst router = useRouter();\n\tconst toolheads = useToolheads();\n\tconst hasBeacon = useMemo(\n\t\t() => toolheads.some((th) => th.getYAccelerometerName() === 'beacon' || th.getXAccelerometerName() === 'beacon'),\n\t\t[toolheads],\n\t);\n\tconst [adxl, setAdxl] = useState<MacroRecordingSettings['accelerometer']>(toolheads[0].getYAccelerometerName());\n\tconst {\n\t\tisChartEnabled,\n\t\tsetIsChartEnabled,\n\t\tchartProps,\n\t\tpsds,\n\t\tcurrentAccelerometer,\n\t\tcurrentAccelerometerHardwareName,\n\t} = useRealtimeAnalysisChart(adxl);\n\tconst { mutateAsync: mutateRecordingAsync } = trpc.analysis.saveRecording.useMutation(macroRecordingMutationOptions);\n\n\tconst [isRecording, setIsRecording] = useState(false);\n\tconst [isMacroRunning, setIsMacroRunning] = useState(false);\n\tconst currentMacro = useRef<Macro | null>(null);\n\tconst G = useGcodeCommand();\n\n\tconst { frequency, setFrequency, axis, setAxis } = useOscillator(G, isChartEnabled && !isMacroRunning);\n\n\tconst abortController = useRef(new AbortController());\n\n\tconst runMacro = useCallback(\n\t\t<Params extends readonly unknown[]>(macro: (...args: [AbortSignal, ...Params]) => Promise<any>, ...args: Params) =>\n\t\t\tasync () => {\n\t\t\t\tabortController.current = new AbortController();\n\t\t\t\tsetFrequency(0);\n\t\t\t\tsetIsMacroRunning(true);\n\t\t\t\tsetIsChartEnabled(true);\n\t\t\t\ttry {\n\t\t\t\t\tawait macro(abortController.current.signal, ...args);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (abortController.current.signal.aborted || (e instanceof DOMException && e.name === 'AbortError')) {\n\t\t\t\t\t\tgetLogger().info(e, 'Macro run aborted');\n\t\t\t\t\t\ttoast.info('Macro run aborted', {\n\t\t\t\t\t\t\tdescription: 'The macro run was aborted',\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgetLogger().error(`Macro run failed`, e);\n\t\t\t\t\t\ttoast.error('Macro failed', {\n\t\t\t\t\t\t\tdescription:\n\t\t\t\t\t\t\t\te instanceof Error\n\t\t\t\t\t\t\t\t\t? e.message\n\t\t\t\t\t\t\t\t\t: e instanceof String\n\t\t\t\t\t\t\t\t\t\t? e\n\t\t\t\t\t\t\t\t\t\t: 'An unknown error occurred while running the macro',\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} finally {\n\t\t\t\t\tsetIsMacroRunning(false);\n\t\t\t\t\tsetIsRecording(false);\n\t\t\t\t\tsetIsChartEnabled(false);\n\t\t\t\t\tcurrentMacro.current = null;\n\t\t\t\t}\n\t\t\t},\n\t\t[setFrequency, setIsChartEnabled],\n\t);\n\n\tconst MacroIcon = useMemo(\n\t\t() =>\n\t\t\tisRecording ? (\n\t\t\t\t<DotFilledIcon className=\"h-4 w-4 scale-150 text-red-400\" />\n\t\t\t) : isMacroRunning ? (\n\t\t\t\t<Spinner noMargin={true} className=\"h-4 w-4 group-data-[state=open]:text-white\" />\n\t\t\t) : (\n\t\t\t\t<SquareFunction className=\"h-5 w-5 text-white group-data-[state=open]:text-white lg:text-white/60\" />\n\t\t\t),\n\t\t[isMacroRunning, isRecording],\n\t);\n\n\tconst buildMacro = useCallback(\n\t\t(macro: Macro) =>\n\t\t\trunMacro(async (abort: AbortSignal) => {\n\t\t\t\tcurrentMacro.current = macro;\n\t\t\t\tconst macroRunId = uuid.v4();\n\t\t\t\tconst mutations: Promise<any>[] = [];\n\t\t\t\tconst sequences = macro.sequences.map((sequence) => async () => {\n\t\t\t\t\tif (abort.aborted) {\n\t\t\t\t\t\tthrow new DOMException('Macro run aborted by user', 'AbortError');\n\t\t\t\t\t}\n\t\t\t\t\tconst startTs = new Date().getTime();\n\t\t\t\t\tsetAdxl(sequence.recording?.accelerometer);\n\t\t\t\t\tif (sequence.recording?.capturePSD) {\n\t\t\t\t\t\tawait psds.startAccumulation();\n\t\t\t\t\t\tsetIsRecording(true);\n\t\t\t\t\t}\n\t\t\t\t\tif (abort.aborted) {\n\t\t\t\t\t\tawait psds.stopAccumulation();\n\t\t\t\t\t\tsetIsRecording(false);\n\t\t\t\t\t\tthrow new DOMException('Macro run aborted by user', 'AbortError');\n\t\t\t\t\t}\n\t\t\t\t\tawait G`\n\t\t\t\t\t\t${sequence.gcode}\n\t\t\t\t\t\tM400\n\t\t\t\t\t`;\n\t\t\t\t\tif (sequence.recording?.capturePSD) {\n\t\t\t\t\t\tconst psd = await psds.stopAccumulation();\n\t\t\t\t\t\tsetIsRecording(false);\n\t\t\t\t\t\tif (abort.aborted) {\n\t\t\t\t\t\t\tthrow new DOMException('Macro run aborted by user', 'AbortError');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmutations.push(\n\t\t\t\t\t\t\tmutateRecordingAsync({\n\t\t\t\t\t\t\t\trecording: {\n\t\t\t\t\t\t\t\t\tid: uuid.v4(),\n\t\t\t\t\t\t\t\t\tmacroRecordingRunId: macroRunId,\n\t\t\t\t\t\t\t\t\tmacroId: macro.id,\n\t\t\t\t\t\t\t\t\tsequenceId: sequence.id,\n\t\t\t\t\t\t\t\t\tstartTimeStamp: startTs,\n\t\t\t\t\t\t\t\t\tendTimeStamp: new Date().getTime(),\n\t\t\t\t\t\t\t\t\tpsd,\n\t\t\t\t\t\t\t\t\tname: sequence.name,\n\t\t\t\t\t\t\t\t\taccelerometer: currentAccelerometer,\n\t\t\t\t\t\t\t\t\trecordingHardwareName: currentAccelerometerHardwareName,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tawait sequences.reduce((p, f) => p.then(f), Promise.resolve());\n\t\t\t\tif (abort.aborted) {\n\t\t\t\t\tthrow new DOMException('Macro run aborted by user', 'AbortError');\n\t\t\t\t}\n\t\t\t\tconst macroRunToast = toast.loading('Saving recordings...', {\n\t\t\t\t\tdescription: 'Please wait for recordings to be saved.',\n\t\t\t\t});\n\t\t\t\ttry {\n\t\t\t\t\tawait Promise.all(mutations);\n\t\t\t\t\ttoast.success('Macro run completed', {\n\t\t\t\t\t\tid: macroRunToast,\n\t\t\t\t\t\tdescription: `Macro \"${macro.name}\" completed successfully`,\n\t\t\t\t\t\taction: {\n\t\t\t\t\t\t\tlabel: 'View Result',\n\t\t\t\t\t\t\tonClick: () => router.push(`/analysis/macros/${macro.id}/recordings/${macroRunId}`), // Todo fix a view of the actual result graph.\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\ttoast.error('Macro run failed', {\n\t\t\t\t\t\tid: macroRunToast,\n\t\t\t\t\t\tdescription: `An error occurred while saving macro result data for \"${macro.name}\"`,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}),\n\t\t[G, mutateRecordingAsync, psds, currentAccelerometer, currentAccelerometerHardwareName, router, runMacro],\n\t);\n\n\tuseTopMenu(\n\t\t'analysis',\n\t\tuseCallback(\n\t\t\t(Menu) => (\n\t\t\t\t<>\n\t\t\t\t\t<Menu.MenubarMenu>\n\t\t\t\t\t\t<Menu.MenubarTrigger className=\"flex-nowrap whitespace-nowrap text-nowrap\">\n\t\t\t\t\t\t\t<Menu.MenubarIcon Icon={AudioLines} className={twJoin(isChartEnabled && 'text-brand-400')} />{' '}\n\t\t\t\t\t\t\t<span className=\"hidden lg:inline\">Stream</span>\n\t\t\t\t\t\t</Menu.MenubarTrigger>\n\t\t\t\t\t\t<Menu.MenubarContent onCloseAutoFocus={(e) => e.preventDefault()}>\n\t\t\t\t\t\t\t<Menu.MenubarSub>\n\t\t\t\t\t\t\t\t<Menu.MenubarSubTrigger>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Move3D} /> Accelerometer\n\t\t\t\t\t\t\t\t</Menu.MenubarSubTrigger>\n\t\t\t\t\t\t\t\t<Menu.MenubarSubContent>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioGroup value={adxl} onValueChange={(e) => setAdxl(e as KlipperAccelSensorName)}>\n\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"rpi\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(adxl === 'rpi' && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={ServerIcon} />\n\t\t\t\t\t\t\t\t\t\t\tHost\n\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"controlboard\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(adxl === 'controlboard' && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Cpu} />\n\t\t\t\t\t\t\t\t\t\t\tControl Board\n\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t{toolheads[0].hasToolboard() && (\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"toolboard_t0\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(adxl === 'toolboard_t0' && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={ArrowDownToDot} />\n\t\t\t\t\t\t\t\t\t\t\t\tToolboard T0\n\t\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{toolheads.length > 1 && toolheads[1].hasToolboard() && (\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"toolboard_t1\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(adxl === 'toolboard_t1' && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={ArrowDownToDot} />\n\t\t\t\t\t\t\t\t\t\t\t\tToolboard T1\n\t\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t{hasBeacon && (\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"beacon\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(adxl === 'beacon' && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Target} />\n\t\t\t\t\t\t\t\t\t\t\t\tBeacon\n\t\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioGroup>\n\t\t\t\t\t\t\t\t</Menu.MenubarSubContent>\n\t\t\t\t\t\t\t</Menu.MenubarSub>\n\t\t\t\t\t\t\t<Menu.MenubarSeparator />\n\t\t\t\t\t\t\t<Menu.MenubarItem\n\t\t\t\t\t\t\t\tdisabled={isChartEnabled || isMacroRunning}\n\t\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\t\tsetIsChartEnabled(true);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Play} /> Start\n\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t\t<Menu.MenubarItem\n\t\t\t\t\t\t\t\tdisabled={!isChartEnabled || isMacroRunning}\n\t\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\t\tsetIsChartEnabled(false);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Pause} /> Stop\n\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t</Menu.MenubarContent>\n\t\t\t\t\t</Menu.MenubarMenu>\n\t\t\t\t\t<Menu.MenubarMenu>\n\t\t\t\t\t\t<Menu.MenubarTrigger className=\"flex-nowrap whitespace-nowrap text-nowrap\">\n\t\t\t\t\t\t\t<Menu.MenubarIcon Icon={PencilRuler} /> <span className=\"hidden lg:inline\">Tools</span>\n\t\t\t\t\t\t</Menu.MenubarTrigger>\n\t\t\t\t\t\t<Menu.MenubarContent onCloseAutoFocus={(e) => e.preventDefault()}>\n\t\t\t\t\t\t\t<Menu.MenubarItem\n\t\t\t\t\t\t\t\tdisabled={isMacroRunning}\n\t\t\t\t\t\t\t\tonSelect={runMacro(async () => {\n\t\t\t\t\t\t\t\t\tawait G`MAYBE_HOME`;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Home} />\n\t\t\t\t\t\t\t\tHome Printer\n\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t\t<Menu.MenubarSeparator />\n\n\t\t\t\t\t\t\t<Menu.MenubarSub>\n\t\t\t\t\t\t\t\t<Menu.MenubarSubTrigger>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={AudioWaveform} /> Oscillator\n\t\t\t\t\t\t\t\t</Menu.MenubarSubTrigger>\n\t\t\t\t\t\t\t\t<Menu.MenubarSubContent>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioGroup value={axis} onValueChange={(e) => setAxis(e as 'x' | 'y' | 'a' | 'b')}>\n\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"x\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(axis === 'x' && frequency > 0 && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={MoveHorizontal} /> Oscillate in X\n\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"y\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(axis === 'y' && frequency > 0 && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={MoveVertical} /> Oscillate in Y\n\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"a\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(axis === 'a' && frequency > 0 && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={MoveDiagonal} /> Oscillate in A\n\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t\t<Menu.MenubarRadioItem\n\t\t\t\t\t\t\t\t\t\t\tvalue=\"b\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(axis === 'b' && frequency > 0 && 'font-semibold text-brand-400')}\n\t\t\t\t\t\t\t\t\t\t\tonSelect={(e) => e.preventDefault()}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={MoveDiagonal2} /> Oscillate in B\n\t\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioItem>\n\t\t\t\t\t\t\t\t\t</Menu.MenubarRadioGroup>\n\t\t\t\t\t\t\t\t\t<Menu.MenubarSeparator />\n\t\t\t\t\t\t\t\t\t<div className=\"min-w-48 p-4\">\n\t\t\t\t\t\t\t\t\t\t<h3 className=\"-mt-2 text-center text-2xl font-medium tracking-tight\">\n\t\t\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\t\tsize={1}\n\t\t\t\t\t\t\t\t\t\t\t\tmax={200}\n\t\t\t\t\t\t\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyUp={(e) => e.stopPropagation()}\n\t\t\t\t\t\t\t\t\t\t\t\tonKeyDown={(e) => e.stopPropagation()}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"m-0 inline min-w-0 border-none bg-transparent p-0 text-right font-mono text-3xl font-medium tracking-tight\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={frequency.toFixed(1)}\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: frequency.toFixed(1).length + 'rem' }}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setFrequency(parseFloat(e.target.value))}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\tHz\n\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t\t<Slider\n\t\t\t\t\t\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"mt-4\"\n\t\t\t\t\t\t\t\t\t\t\tmax={200}\n\t\t\t\t\t\t\t\t\t\t\tvalue={[frequency]}\n\t\t\t\t\t\t\t\t\t\t\tonValueChange={(val) => setFrequency(val[0])}\n\t\t\t\t\t\t\t\t\t\t\tstep={0.1}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Menu.MenubarSubContent>\n\t\t\t\t\t\t\t</Menu.MenubarSub>\n\t\t\t\t\t\t</Menu.MenubarContent>\n\t\t\t\t\t</Menu.MenubarMenu>\n\t\t\t\t\t<Menu.MenubarMenu>\n\t\t\t\t\t\t<Menu.MenubarTrigger className=\"flex-nowrap whitespace-nowrap text-nowrap\">\n\t\t\t\t\t\t\t{MacroIcon} <span className=\"hidden lg:inline\">Macros</span>\n\t\t\t\t\t\t</Menu.MenubarTrigger>\n\t\t\t\t\t\t<Menu.MenubarContent onCloseAutoFocus={(e) => e.preventDefault()}>\n\t\t\t\t\t\t\t{macros.result?.map((macro) => (\n\t\t\t\t\t\t\t\t<Menu.MenubarItem\n\t\t\t\t\t\t\t\t\tkey={macro.id}\n\t\t\t\t\t\t\t\t\tdisabled={isMacroRunning}\n\t\t\t\t\t\t\t\t\tonSelect={buildMacro(macro)}\n\t\t\t\t\t\t\t\t\tclassName={twJoin(currentMacro.current?.id === macro.id && 'text-brand-400 opacity-100')}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{currentMacro.current?.id === macro.id ? MacroIcon : <Menu.MenubarContentIcon Icon={Play} />}\n\t\t\t\t\t\t\t\t\t{macro.name}\n\t\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t<Menu.MenubarSeparator />\n\t\t\t\t\t\t\t<Menu.MenubarItem disabled={isMacroRunning} asChild={true} className=\"pr-8\">\n\t\t\t\t\t\t\t\t<Link href=\"/analysis/macros\">\n\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={List} /> View All Macros\n\t\t\t\t\t\t\t\t\t<span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t<MoveRight className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t\t<Menu.MenubarItem disabled={isMacroRunning} asChild={true} className=\"pr-8\">\n\t\t\t\t\t\t\t\t<Link href=\"/analysis/macros/new\">\n\t\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Plus} /> New Macro\n\t\t\t\t\t\t\t\t\t<span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t<MoveRight className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t\t<Menu.MenubarSeparator />\n\t\t\t\t\t\t\t<Menu.MenubarItem disabled={!isMacroRunning} onClick={() => abortController.current.abort()}>\n\t\t\t\t\t\t\t\t<Menu.MenubarContentIcon Icon={Ban} className={twJoin(isMacroRunning && 'text-red-400')} />\n\t\t\t\t\t\t\t\tAbort {currentMacro.current?.name || ''}\n\t\t\t\t\t\t\t</Menu.MenubarItem>\n\t\t\t\t\t\t</Menu.MenubarContent>\n\t\t\t\t\t</Menu.MenubarMenu>\n\t\t\t\t</>\n\t\t\t),\n\t\t\t[\n\t\t\t\tisChartEnabled,\n\t\t\t\tadxl,\n\t\t\t\ttoolheads,\n\t\t\t\thasBeacon,\n\t\t\t\tisMacroRunning,\n\t\t\t\trunMacro,\n\t\t\t\taxis,\n\t\t\t\tfrequency,\n\t\t\t\tMacroIcon,\n\t\t\t\tmacros.result,\n\t\t\t\tsetIsChartEnabled,\n\t\t\t\tG,\n\t\t\t\tsetAxis,\n\t\t\t\tsetFrequency,\n\t\t\t\tbuildMacro,\n\t\t\t],\n\t\t),\n\t);\n\n\treturn <RealtimeAnalysisChart {...chartProps} />;\n};\n","import { cva } from 'class-variance-authority';\nimport React from 'react';\n\nconst cardVariants = cva([\n\t'relative rounded-lg  bg-white dark:bg-zinc-900/60',\n\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t'dark:before:-inset-px dark:before:rounded-xl',\n\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_rgba(0,_0,_0,_0.20),_0px_1px_0px_0px_rgba(255,_255,_255,_0.07)_inset]',\n]);\n\ntype CardProps = React.PropsWithChildren<{\n\tclassName?: string;\n}>;\n\nexport const Card: React.FC<CardProps> = (props) => {\n\treturn <div className={cardVariants({ className: props.className })}>{props.children}</div>;\n};\n","import * as React from 'react';\n\nimport { cn, setDisplayName } from '@/helpers/utils';\nimport { VariantProps, cva } from 'class-variance-authority';\nimport { twJoin } from 'tailwind-merge';\n\nconst InputVariants = cva(\n\ttwJoin(\n\t\t'flex w-full rounded-md border bg-transparent px-3 py-1.5 text-sm shadow-sm transition-colors',\n\t\t'file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground',\n\t\t'border-zinc-300 text-zinc-900 placeholder-zinc-300 ring-brand-600 dark:border-zinc-800 dark:text-zinc-100 dark:placeholder-zinc-700 dark:focus:ring-brand-400 ',\n\t\t'focus:ring-offset-zinc-900 block w-full rounded-md border text-left shadow-sm ring-inset ring-offset-zinc-900 transition-all focus:outline-none focus:ring-2 focus:ring-offset-2',\n\t\t'active:translate-y-px active:scale-[99%] active:outline-none active:ring-2 active:ring-offset-2',\n\t\t'disabled:cursor-not-allowed disabled:opacity-50',\n\t),\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tplain: 'shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 dark:bg-transparent',\n\t\t\t\tdefault: 'dark:bg-zinc-800 bg-white',\n\t\t\t\terror:\n\t\t\t\t\t'border-red-300 text-red-900 placeholder-red-300 ring-red-500 dark:ring-red-500 dark:text-red-400 dark:placeholder-red-700',\n\t\t\t},\n\t\t},\n\t\tdefaultVariants: {\n\t\t\tvariant: 'plain',\n\t\t},\n\t},\n);\n\nexport interface InputProps extends React.InputHTMLAttributes<HTMLInputElement>, VariantProps<typeof InputVariants> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(({ className, type, ...props }, ref) => {\n\treturn <input type={type} className={cn(InputVariants(props), className)} ref={ref} {...props} />;\n});\nsetDisplayName(Input, 'Input');\n\nexport { Input };\n"],"names":["Promise","resolve","then","__webpack_require__","bind","useGcodeCommand","executeGcode","useMoonrakerMutation","useCallback","command","args","result","forEach","arg","i","push","toString","gcode","join","gcodeRes","mutateAsync","script","console","log","SciChartSurface","configure","wasmUrl","dataUrl","useRealtimeAnalysisChart","accelerometer","toolheads","xSignalChart","ySignalChart","zSignalChart","psdChart","adxl","accelerometerType","useQuery","queryFn","setWasmPaths","setBackend","suspense","isChartEnabled","setIsChartEnabled","useState","dataHeader","setDataHeader","undefined","useToolheads","controlBoard","useRecoilValue","ControlboardState","getYAccelerometerName","adxlHardwareName","name","getToolboard","usePSDChart","useADXLSignalChart","xSignalYAxis","data","current","yAxis","ySignalYAxis","zSignalYAxis","updateSignalChartRange","useDynamicAxisRange","psdYAxis","surface","yAxes","getById","PSD_CHART_AXIS_AMPLITUDE_ID","updatePsdChartRange","PSDChartMinimumYVisibleRange","fifo","useADXLFifoTensor","timeSinceLastPsd","useRef","Date","getTime","useEffect","psds","useAccumulatedPSD","elapsed","animationDS","animationSeries","res","x","frequencies","length","estimates","getLogger","warn","concat","y","z","total","renderableSeries","dataSeries","count","clear","appendRange","NumberRange","powerRange","min","max","runAnimation","LineAnimation","duration","ease","easing","inOutCirc","MountainAnimation","updatePsd","useBufferedPSD","sampleRate","onData","updateSignals","useBufferedADXLSignal","time","dX","detrendSignal","dY","dZ","dispose","all","array","timeData","xData","yData","zData","param","signalData","historyData","useTicker","ADXL_STREAM_BUFFER_SIZE","useRealtimeSensor","sensor","enabled","onDataUpdate","onSubscriptionSuccess","header","onSubscriptionFailure","toast","error","description","err","message","useMemo","currentAccelerometer","currentAccelerometerHardwareName","chartProps","RealtimeAnalysisChart","React","jsx_runtime","jsxs","div","className","Card","h3","jsx","twJoin","span","SciChartReact","forwardProps","fallback","FullLoadScreen","Slider","ref","props","SliderPrimitive","cn","setDisplayName","displayName","useOscillator","G","isEnabled","frequency","setFrequency","frequencyRef","axis","setAxis","axisRef","isOscillating","isEnabledRef","oscillate","oscTime","macroTime","Math","floor","TARGET_OSC_TIME","direction","beforeGcode","gcodeDuration","setTimeout","e","Error","String","macroRecordingMutationOptions","onError","variables","psd","Analysis","macros","trpc","analysis","getMacros","useSuspenseQuery","limit","router","useRouter","hasBeacon","some","th","getXAccelerometerName","setAdxl","mutateRecordingAsync","saveRecording","useMutation","isRecording","setIsRecording","isMacroRunning","setIsMacroRunning","currentMacro","abortController","AbortController","runMacro","macro","signal","aborted","DOMException","info","MacroIcon","DotFilledIcon","Spinner","noMargin","SquareFunction","buildMacro","abort","macroRunId","uuid","mutations","sequences","map","sequence","startTs","recording","capturePSD","startAccumulation","stopAccumulation","id","macroRecordingRunId","macroId","sequenceId","startTimeStamp","endTimeStamp","recordingHardwareName","reduce","p","f","macroRunToast","loading","success","action","label","onClick","useTopMenu","Fragment","Menu","MenubarMenu","MenubarTrigger","MenubarIcon","Icon","AudioLines","MenubarContent","onCloseAutoFocus","preventDefault","MenubarSub","MenubarSubTrigger","MenubarContentIcon","Move3D","MenubarSubContent","MenubarRadioGroup","value","onValueChange","MenubarRadioItem","onSelect","ServerIcon","Cpu","hasToolboard","ArrowDownToDot","Target","MenubarSeparator","MenubarItem","disabled","Play","Pause","PencilRuler","Home","AudioWaveform","MoveHorizontal","MoveVertical","MoveDiagonal","MoveDiagonal2","Input","type","size","onKeyUp","stopPropagation","onKeyDown","toFixed","style","width","onChange","parseFloat","target","val","step","asChild","Link","href","List","MoveRight","Plus","Ban","cardVariants","cva","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","children","InputVariants","variants","variant","plain","default","defaultVariants","input"],"sourceRoot":""}