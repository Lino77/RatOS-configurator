(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5757],{21734:function(e,r,s){"use strict";s.d(r,{Z:function(){return n}});var a=s(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},16803:function(e,r,s){Promise.resolve().then(s.bind(s,19399)),Promise.resolve().then(s.bind(s,56445))},19399:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return AnalysisMacrosTable}});var a=s(72612),n=s(23071),l=s(79978),o=s(90077),c=s(94809),i=s(64827),t=s(82157),d=s.n(t),u=s(79293),h=s(63562),m=s(39164),x=s(94787),p=s(13425);function DataTableRowActions(e){let{row:r,onUpdate:s}=e,[n,l]=(0,m.useState)(!1),t=u.SX.analysis.deleteMacro.useMutation();return(0,a.jsxs)("div",{className:"flex justify-end",children:[(0,a.jsxs)(i.h_,{children:[(0,a.jsx)(i.$F,{asChild:!0,children:(0,a.jsxs)(c.z,{variant:"plain",size:"sm",className:"flex data-[state=open]:bg-muted",children:[(0,a.jsx)(o.AjK,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,a.jsxs)(i.AW,{align:"end",className:"w-[160px]",children:[(0,a.jsx)(i.Xi,{asChild:!0,children:(0,a.jsx)(d(),{href:"/analysis/macros/".concat(r.original.id,"/recordings"),children:"View Recordings"})}),(0,a.jsx)(i.Xi,{asChild:!0,children:(0,a.jsx)(d(),{href:"/analysis/macros/".concat(r.original.id,"/edit"),children:"Edit"})}),(0,a.jsx)(i.VD,{}),(0,a.jsx)(i.Xi,{onClick:()=>l(!0),children:"Delete"})]})]}),(0,a.jsx)(h.aR,{open:n,children:(0,a.jsxs)(h._T,{children:[(0,a.jsxs)(h.fY,{children:[(0,a.jsx)(h.f$,{children:"Are you sure?"}),(0,a.jsx)(h.yT,{children:"This action cannot be undone. This will permanently delete this macro and all associated recordings."})]}),(0,a.jsxs)(h.xo,{children:[(0,a.jsx)(h.le,{onClick:()=>l(!1),children:"Cancel"}),(0,a.jsx)(h.OL,{variant:"danger",onClick:async()=>{l(!1);try{let e=await t.mutateAsync(r.original.id);if(null==e.result){(0,p.j)().error(r.original.id,"Failed to delete macro"),x.A.error("Failed to delete macro",{description:"An unknown error occurred and the macro seem to have disappeared from the database. This shouldn't happen. Please contact support."});return}x.A.success("Macro deleted!",{description:"The macro and ".concat(e.totalRecordingsRemoved," recording(s) were successfully deleted.")})}catch(e){(0,p.j)().error({id:r.original.id,error:e},"Failed to delete macro"),x.A.error("Failed to delete macro",{description:'\n											<div>\n												<p>An error occurred while delete the macro.</p>\n												<pre class="text-wrap mt-4 text-rose-400 font-medium whitespace-pre-wrap">'.concat(e instanceof Error?e.message:e instanceof String?e:"Unknown error","</pre>\n											</div>\n										")})}null==s||s()},children:"Continue"})]})]})})]})}var g=s(39634),j=s(16195),f=s(65523),y=s(8058),v=s(21734);function MacroBulkActions(e){let{selection:r,onUpdate:s}=e,[n,l]=(0,m.useState)(!1),t=u.SX.analysis.deleteMacros.useMutation();return(0,a.jsxs)("div",{className:"flex justify-end",children:[(0,a.jsxs)(i.h_,{children:[(0,a.jsx)(i.$F,{asChild:!0,children:(0,a.jsxs)(c.z,{variant:"plain",size:"sm",className:"flex data-[state=open]:bg-muted",children:[(0,a.jsx)(o.AjK,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Open menu"})]})}),(0,a.jsx)(i.AW,{align:"end",className:"w-[160px]",children:(0,a.jsxs)(i.Xi,{onClick:()=>l(!0),disabled:0===r.rows.length,children:["Delete ",r.rows.length>0?r.rows.length:""," ",1===r.rows.length?"Macro":"Macros"]})})]}),(0,a.jsx)(h.aR,{open:n,children:(0,a.jsxs)(h._T,{children:[(0,a.jsxs)(h.fY,{children:[(0,a.jsx)(h.f$,{children:"Are you sure?"}),(0,a.jsx)(h.yT,{children:"This action cannot be undone. This will permanently delete the selected macros and all associated recordings."})]}),(0,a.jsxs)(h.xo,{children:[(0,a.jsx)(h.le,{onClick:()=>l(!1),children:"Cancel"}),(0,a.jsx)(h.OL,{variant:"danger",onClick:async()=>{l(!1);try{let e=await t.mutateAsync(r.rows.map(e=>e.original.id)),s=e.result.filter(e=>!e.success);s.length>0&&((0,p.j)().error(s,"Failed to delete one or more macros"),x.A.error("Failed to delete one or more macros",{description:"An unknown error occurred and some of the macros you marked for deletion seem to have disappeared from the database. This shouldn't happen. Please contact support."})),x.A.success("Macros deleted!",{description:"".concat(e.macrosRemoved," out of ").concat(e.result.length," macro(s) and ").concat(e.result.reduce((e,r)=>e+r.totalRecordingsRemoved,0)," recording(s) were successfully deleted.")})}catch(e){(0,p.j)().error({ids:r.rows.map(e=>e.original.id),error:e},"Failed to delete macros"),x.A.error("Failed to delete macros",{description:'\n											<div>\n												<p>An error occurred while deleting the macros.</p>\n												<pre class="text-wrap mt-4 text-rose-400 font-medium whitespace-pre-wrap">'.concat(e instanceof Error?e.message:e instanceof String?e:"Unknown error","</pre>\n											</div>\n										")})}null==s||s()},children:"Continue"})]})]})})]})}let b=[{id:"select",size:30,minSize:30,header:e=>{let{table:r}=e;return(0,a.jsx)(n.X,{checked:r.getIsAllPageRowsSelected()||r.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>r.toggleAllPageRowsSelected(!!e),"aria-label":"Select all"})},cell:e=>{let{row:r}=e;return(0,a.jsx)(n.X,{checked:r.getIsSelected(),onCheckedChange:e=>r.toggleSelected(!!e),"aria-label":"Select row"})},enableSorting:!1,enableHiding:!1},{accessorKey:"name",size:1e3,header:e=>{let{column:r}=e;return(0,a.jsx)(l.p,{column:r,title:"Name"})},cell:e=>{let{row:r}=e,s=[];return r.original.sequences.map(e=>{var r;switch(null===(r=e.recording)||void 0===r?void 0:r.accelerometer){case"controlboard":s.push({label:"Control Board",color:"lime",icon:j.Z});break;case"rpi":s.push({label:"Host",color:"yellow",icon:f.Z});break;case"toolboard_t0":s.push({label:"Tool Board T0",color:"sky",icon:y.Z});break;case"toolboard_t1":s.push({label:"Tool Board T1",color:"pink",icon:y.Z})}}),s=s.filter((e,r,s)=>s.findIndex(r=>r.label===e.label)===r),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[s.map(e=>(0,a.jsx)(g.Ct,{color:e.color,children:e.label},e.label)),(0,a.jsx)(d(),{href:"/analysis/macros/".concat(r.original.id,"/recordings"),className:"truncate font-medium hover:text-brand-400",children:r.getValue("name")})]})},getUniqueValues:e=>e.sequences.map(e=>{var r;return null===(r=e.recording)||void 0===r?void 0:r.accelerometer}).concat([e.name]),getFacetedOptions:()=>[{label:"Control Board",value:"controlboard",icon:j.Z},{label:"Host",value:"rpi",icon:f.Z},{label:"Tool Board T0",value:"toolboard_t0",icon:y.Z},{label:"Tool Board T1",value:"toolboard_t1",icon:y.Z}],filterFn:(e,r,s)=>{let a=e.original.sequences.map(e=>{var r;return null===(r=e.recording)||void 0===r?void 0:r.accelerometer});return(Array.isArray(s)?s:[s]).some(r=>a.includes(r)||e.original.name.includes(r))}},{accessorKey:"sequences",size:100,header:e=>{let{column:r}=e;return(0,a.jsx)(l.p,{column:r,title:"Sequences"})},cell:e=>{let{row:r}=e,s=r.original.sequences.filter(e=>{var r;return!(null===(r=e.recording)||void 0===r?void 0:r.capturePSD)}).length,n=r.original.sequences.filter(e=>{var r;return null===(r=e.recording)||void 0===r?void 0:r.capturePSD}).length;return(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[s>0&&(0,a.jsxs)(g.Ct,{className:"flex gap-1.5",color:"gray",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 text-foreground"})," ",s]}),n>0&&(0,a.jsxs)(g.Ct,{className:"flex gap-1.5",color:"gray",children:[(0,a.jsx)(o.jXb,{className:"h-4 w-4 scale-[250%] text-rose-400"})," ",n]})]})}},{id:"actions",size:16,minSize:16,maxSize:16,header:e=>{let{table:r}=e;return(0,a.jsx)(MacroBulkActions,{selection:r.getSelectedRowModel()})},cell:e=>{let{row:r}=e;return(0,a.jsx)(DataTableRowActions,{row:r})}}];var w=s(25617),k=s(10187),N=s(74755),A=s(24360);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let C=(0,A.Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var T=s(20936);function AnalysisMacrosTable(){var e,r;let s=k.S.analysis.getMacros.useQuery({});return(0,T.Ty)("Analysis",(0,m.useCallback)(e=>(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(e.MenubarMenu,{children:[(0,a.jsx)(e.MenubarTrigger,{className:"cursor-pointer",asChild:!0,children:(0,a.jsxs)(d(),{href:"/analysis",children:[(0,a.jsx)(e.MenubarIcon,{Icon:N.Z}),(0,a.jsx)("span",{className:"hidden lg:inline",children:"Back"})]})}),(0,a.jsx)(e.MenubarContent,{className:"hidden"})]})}),[])),(0,a.jsxs)("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Resonance analysis macros"}),(0,a.jsx)("p",{className:"font-medium text-muted-foreground",children:"Here's a list of your macro's ready for analysis!"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)(c.z,{href:"/analysis/macros/new",variant:"primary",children:[(0,a.jsx)(C,{className:"size-4"}),(0,a.jsx)("span",{children:"New Macro"})]})})]}),(0,a.jsx)(w.w,{data:null!==(r=null===(e=s.data)||void 0===e?void 0:e.result)&&void 0!==r?r:[],columns:b})]})}}},function(e){e.O(0,[6545,660,5360,3790,1853,5591,5847,5076,6270,7270,4787,8367,5546,9146,3715,88,8540,5791,9321,8458,1744],function(){return e(e.s=16803)}),_N_E=e.O()}]);
//# sourceMappingURL=page-58f3d093f04fe14c.js.map