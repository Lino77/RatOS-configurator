{"version":3,"file":"static/chunks/app/wizard/page-1060461f0d33d288.js","mappings":"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","sources":["webpack://_N_E/?3a46","webpack://_N_E/./app/_hooks/debounce.ts","webpack://_N_E/./app/_hooks/navigation.ts","webpack://_N_E/./components/klippy-state-badge.tsx","webpack://_N_E/./components/moonraker-state-badge.tsx","webpack://_N_E/./hooks/useSteps.tsx","webpack://_N_E/./components/common/vertical-steps.tsx","webpack://_N_E/./components/step-nav-buttons.tsx","webpack://_N_E/./components/setup-steps/hardware-selection.tsx","webpack://_N_E/./components/common/query-status.tsx","webpack://_N_E/./components/common/mutation-status.tsx","webpack://_N_E/./components/common/info-message.tsx","webpack://_N_E/./components/setup-steps/mcu/dfu-flash.tsx","webpack://_N_E/./components/common/modal.tsx","webpack://_N_E/./components/setup-steps/mcu/sd-card-flash.tsx","webpack://_N_E/./components/setup-steps/mcu/flash.tsx","webpack://_N_E/./components/card-selector.tsx","webpack://_N_E/./components/setup-steps/mcu/pick.tsx","webpack://_N_E/./components/setup-steps/mcu-preparation.tsx","webpack://_N_E/./components/card-selector-with-options.tsx","webpack://_N_E/./components/common/show-when-ready.tsx","webpack://_N_E/./components/setup-steps/printer-selection.tsx","webpack://_N_E/./helpers/wifi.tsx","webpack://_N_E/./helpers/validators/wifi.ts","webpack://_N_E/./components/setup-steps/wifi-setup.tsx","webpack://_N_E/./components/setup-steps/diff-modal.tsx","webpack://_N_E/./components/common/state-circle.tsx","webpack://_N_E/./components/setup-steps/file-changes.tsx","webpack://_N_E/./components/setup-steps/wizard-complete.tsx","webpack://_N_E/./components/setup-steps/index.tsx","webpack://_N_E/./app/wizard/wizard.tsx","webpack://_N_E/./components/common/animated-container.tsx","webpack://_N_E/./components/common/button.tsx","webpack://_N_E/./components/common/card.tsx","webpack://_N_E/./components/common/error-message.tsx","webpack://_N_E/./components/common/full-load-screen.tsx","webpack://_N_E/./components/common/no-ssr.tsx","webpack://_N_E/./components/forms/toggle.tsx","webpack://_N_E/./components/setup-steps/toolhead-settings.tsx","webpack://_N_E/./components/warning-message.tsx","webpack://_N_E/./hooks/useChangeEffect.tsx","webpack://_N_E/./hooks/useKlippyStateHandler.tsx","webpack://_N_E/<anon>"],"sourcesContent":["import(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/app/wizard/wizard.tsx\");\nimport(/* webpackMode: \"eager\" */ \"/home/runner/work/RatOS-configurator/RatOS-configurator/src/components/common/no-ssr.tsx\")","import { useRef, useCallback, useEffect } from 'react';\n\nexport const useDebounce = <T extends Function>(fn: T, delay: number, refreshTimeout: boolean = false) => {\n\tconst timeoutRef = useRef<ReturnType<typeof setTimeout>>();\n\tconst argsRef = useRef<any[]>([]);\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (timeoutRef.current) {\n\t\t\t\tclearTimeout(timeoutRef.current);\n\t\t\t}\n\t\t};\n\t}, []);\n\treturn useCallback(\n\t\t(...args: any[]) => {\n\t\t\targsRef.current = args;\n\t\t\tif (timeoutRef.current) {\n\t\t\t\tif (refreshTimeout) {\n\t\t\t\t\tclearTimeout(timeoutRef.current);\n\t\t\t\t\ttimeoutRef.current = undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttimeoutRef.current = setTimeout(() => {\n\t\t\t\tfn(...argsRef.current);\n\t\t\t\ttimeoutRef.current = undefined;\n\t\t\t}, delay);\n\t\t},\n\t\t[delay, refreshTimeout, fn],\n\t) as unknown as T;\n};\n","'use client';\nimport { usePathname, useRouter } from 'next/navigation';\nimport React, { useCallback } from 'react';\nimport type { Route } from 'next';\nimport { AreaChart, LucideProps, Monitor, Video, Wand, Wand2 } from 'lucide-react';\n\nexport const useLocalPathname = () => {\n\tconst pathname = (usePathname() ?? '/').replace('/configure', '') as Route;\n\treturn pathname;\n};\n\nexport const useIsRouteActive = () => {\n\tconst pathname = useLocalPathname();\n\treturn useCallback(\n\t\t(href: string) => {\n\t\t\treturn pathname.startsWith(href);\n\t\t},\n\t\t[pathname],\n\t);\n};\n\nexport type NavigationItem = {\n\tname: string;\n\thref: Route;\n\tcurrent: boolean;\n\ticon: React.ComponentType<any>;\n\ticonClass?: string;\n};\n\nconst routes: NavigationItem[] = [\n\t{ name: 'Setup Wizard', href: '/wizard', current: false, icon: Wand2 },\n\t{ name: 'Dashboard', href: '/', current: false, icon: Monitor },\n\t{ name: 'Visual Calibration', href: '/calibration', current: false, icon: Video },\n\t{ name: 'Resonance Analysis', href: '/analysis', current: false, icon: AreaChart },\n\t// { name: 'Boards', href: '/', current: false, icon: Cpu },\n\t// { name: 'Motion', href: '/motion', current: false, icon: ArrowsPointingOutIcon, iconClass: 'rotate-45' },\n\t// { name: 'Toolhead', href: '/toolhead', current: false, icon: ArrowDownOnSquareIcon },\n];\n\nexport const useNavigation = () => {\n\tconst isRouteActive = useIsRouteActive();\n\tlet prevActive: number | null = null;\n\tconst result: typeof routes = [];\n\troutes.forEach((n, i) => {\n\t\tn.current = isRouteActive(n.href);\n\t\tif (n.current) {\n\t\t\tif (prevActive !== null && result[prevActive]?.href.length < n.href.length) {\n\t\t\t\tresult[prevActive].current = false;\n\t\t\t\tprevActive = i;\n\t\t\t} else if (prevActive !== null) {\n\t\t\t\tn.current = false;\n\t\t\t} else {\n\t\t\t\tprevActive = i;\n\t\t\t}\n\t\t}\n\t\tresult.push(n);\n\t});\n\treturn result;\n};\n\ninterface RedirecterProps extends React.PropsWithChildren {\n\thasLastPrinterSettings: boolean;\n}\n\nexport const Redirecter: React.FC<RedirecterProps> = (props) => {\n\tconst router = useRouter();\n\tconst isRouteActive = useIsRouteActive();\n\tif (!props.hasLastPrinterSettings && !isRouteActive('/wizard')) {\n\t\trouter.replace('/wizard');\n\t} else {\n\t\treturn props.children;\n\t}\n};\n","'use client';\nimport React from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { twJoin } from 'tailwind-merge';\nimport { KlippyReadyStates, useKlippyStateHandler } from '@/hooks/useKlippyStateHandler';\nimport { Badge, BadgeProps, badgeTextColorStyle } from '@/components/common/badge';\n\ninterface Props {\n\tclassName?: string;\n}\n\nconst klipperStateToText = (klippyState: KlippyReadyStates) => {\n\tswitch (klippyState) {\n\t\tcase 'error':\n\t\t\treturn 'Klipper State: Error';\n\t\tcase 'ready':\n\t\t\treturn 'Klipper State: Ready';\n\t\tcase 'shutdown':\n\t\t\treturn 'Klipper State: Shutdown';\n\t\tcase 'startup':\n\t\t\treturn 'Klipper State: Startup';\n\t\tcase 'unknown':\n\t\t\treturn 'Klipper State: Unknown';\n\t\tdefault:\n\t\t\treturn 'Klipper State: Unknown';\n\t}\n};\n\nexport const KlippyStateBadge: React.FC<Props> = (props) => {\n\tconst klippyState = useKlippyStateHandler();\n\tlet color: BadgeProps['color'] = 'orange';\n\tswitch (klippyState) {\n\t\tcase 'error':\n\t\t\tcolor = 'red';\n\t\t\tbreak;\n\t\tcase 'ready':\n\t\t\tcolor = 'brand';\n\t\t\tbreak;\n\t\tcase 'shutdown':\n\t\t\tcolor = 'orange';\n\t\t\tbreak;\n\t\tcase 'startup':\n\t\t\tcolor = 'yellow';\n\t\t\tbreak;\n\t\tcase 'unknown':\n\t\t\tcolor = 'orange';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcolor = 'orange';\n\t\t\tbreak;\n\t}\n\n\treturn (\n\t\t<Badge color={color} title={klipperStateToText(klippyState)}>\n\t\t\t<svg className={twJoin(badgeTextColorStyle({ color }), 'h-2 w-2')} fill=\"currentColor\" viewBox=\"0 0 8 8\">\n\t\t\t\t<circle cx={4} cy={4} r={3} />\n\t\t\t</svg>\n\t\t\tKlipper\n\t\t</Badge>\n\t);\n};\n","'use client';\n\nimport React from 'react';\nimport { twJoin } from 'tailwind-merge';\nimport { useMoonraker } from '@/moonraker/hooks';\nimport { Badge, BadgeProps, badgeTextColorStyle } from '@/components/common/badge';\nimport { MoonrakerStatus } from '@/moonraker/types';\n\ninterface Props {\n\tclassName?: string;\n}\n\nconst moonrakerStatusToText = (moonrakerState: MoonrakerStatus | null) => {\n\tswitch (moonrakerState) {\n\t\tcase 'not-running':\n\t\t\treturn 'Moonraker State: Not Running';\n\t\tcase 'connected':\n\t\t\treturn 'Moonraker State: Connected';\n\t\tcase 'connecting':\n\t\t\treturn 'Moonraker State: Connecting';\n\t\tdefault:\n\t\t\treturn 'Moonraker State: Unknown';\n\t}\n};\n\nexport const MoonrakerStateBadge: React.FC<Props> = (props) => {\n\tconst { status } = useMoonraker();\n\tlet color: BadgeProps['color'] = 'orange';\n\tswitch (status) {\n\t\tcase 'not-running':\n\t\t\tcolor = 'red';\n\t\t\tbreak;\n\t\tcase 'connected':\n\t\t\tcolor = 'brand';\n\t\t\tbreak;\n\t\tcase 'connecting':\n\t\t\tcolor = 'yellow';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcolor = 'orange';\n\t\t\tbreak;\n\t}\n\treturn (\n\t\t<Badge color={color} title={moonrakerStatusToText(status)}>\n\t\t\t<svg className={twJoin(badgeTextColorStyle({ color }), 'h-2 w-2')} fill=\"currentColor\" viewBox=\"0 0 8 8\">\n\t\t\t\t<circle cx={4} cy={4} r={3} />\n\t\t\t</svg>\n\t\t\tMoonraker\n\t\t</Badge>\n\t);\n};\n","'use client';\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\n\nexport interface StepScreenProps extends React.PropsWithChildren<{}> {\n\tnextScreen?: () => void;\n\tpreviousScreen?: () => void;\n\thasNextScreen: boolean;\n\thasPreviousScreen: boolean;\n\tskipSteps?: () => void;\n\tdescription: string;\n\tname: string;\n\tkey: string;\n}\n\ntype NoExtraProps = '__noExtraProps';\ntype ExtraStepProps<P extends NoExtraProps | Object = NoExtraProps> = P extends NoExtraProps\n\t? {}\n\t: { extraScreenProps: P };\ntype NormalizedGeneric<P extends NoExtraProps | Object = NoExtraProps> = P extends NoExtraProps ? {} : P;\n\nexport interface StepScreen<P extends NoExtraProps | Object = NoExtraProps> {\n\trenderScreen: (screenProps: StepScreenProps & NormalizedGeneric<P>) => JSX.Element | null;\n\tid: string;\n\tcanBeSkippedTo?: boolean;\n\tname: string | ((props: Omit<StepScreenProps, 'name' | 'description'> & NormalizedGeneric<P>) => string);\n\tdescription: string | ((props: Omit<StepScreenProps, 'name' | 'description'> & NormalizedGeneric<P>) => string);\n\thref: string;\n}\n\ntype UseStepProps<P extends NoExtraProps | Object = NoExtraProps> = {\n\tonStepChange?: (step: number, action: 'set' | 'increment' | 'decrement') => void;\n\tsteps: StepScreen<P>[];\n\tstep?: number;\n\tparentScreenProps?: StepScreenProps;\n} & ExtraStepProps<P>;\n\nexport const useSteps = <P extends NoExtraProps | Object>(props: UseStepProps<P>) => {\n\tconst { onStepChange } = props;\n\tconst [currentStepIndex, _setCurrentStepIndex] = useState(\n\t\tprops.step != null && !isNaN(props.step) && props.steps[props.step] != null ? props.step : 0,\n\t);\n\tconst currentStep = props.steps[currentStepIndex];\n\tconst currentStepRef = useRef(currentStepIndex);\n\tcurrentStepRef.current = currentStepIndex;\n\tconst setCurrentStepIndex = useCallback(\n\t\t(stepIndex: number) => {\n\t\t\tonStepChange?.(stepIndex, 'set');\n\t\t\t_setCurrentStepIndex(stepIndex);\n\t\t},\n\t\t[onStepChange],\n\t);\n\tuseEffect(() => {\n\t\tif (props.step && !isNaN(props.step) && props.step !== currentStepRef.current && props.steps[props.step] != null) {\n\t\t\t_setCurrentStepIndex(props.step);\n\t\t}\n\t}, [props.step, props.steps]);\n\tconst hasNextScreen = currentStepIndex < props.steps.length - 1;\n\tconst hasPreviousScreen = currentStepIndex > 0;\n\tconst incrementStep = useCallback(() => {\n\t\t_setCurrentStepIndex((csi) => {\n\t\t\tonStepChange?.(csi + 1, 'increment');\n\t\t\treturn csi + 1;\n\t\t});\n\t}, [onStepChange]);\n\tconst decrementStep = useCallback(() => {\n\t\t_setCurrentStepIndex((csi) => {\n\t\t\tonStepChange?.(csi - 1, 'decrement');\n\t\t\treturn csi - 1;\n\t\t});\n\t}, [onStepChange]);\n\tconst partialScreenProps: Omit<StepScreenProps, 'name' | 'description'> & NormalizedGeneric<P> = {\n\t\t...(('extraScreenProps' in props ? props.extraScreenProps : {}) as NormalizedGeneric<P>),\n\t\tkey: 'step-' + currentStepIndex,\n\t\thasNextScreen: hasNextScreen || (props.parentScreenProps?.hasNextScreen ?? false),\n\t\thasPreviousScreen: hasPreviousScreen || (props.parentScreenProps?.hasNextScreen ?? false),\n\t\tnextScreen: hasNextScreen\n\t\t\t? incrementStep\n\t\t\t: props.parentScreenProps?.hasNextScreen\n\t\t\t\t? props.parentScreenProps.nextScreen\n\t\t\t\t: undefined,\n\t\tpreviousScreen: hasPreviousScreen\n\t\t\t? decrementStep\n\t\t\t: props.parentScreenProps?.hasPreviousScreen\n\t\t\t\t? props.parentScreenProps.previousScreen\n\t\t\t\t: undefined,\n\t\tskipSteps:\n\t\t\tprops.parentScreenProps && props.parentScreenProps.hasNextScreen ? props.parentScreenProps.nextScreen : undefined,\n\t};\n\tconst name = typeof currentStep.name === 'function' ? currentStep.name(partialScreenProps) : currentStep.name;\n\tconst description =\n\t\ttypeof currentStep.description === 'function'\n\t\t\t? currentStep.description(partialScreenProps)\n\t\t\t: currentStep.description;\n\tconst screenProps: StepScreenProps = {\n\t\t...partialScreenProps,\n\t\tname,\n\t\tdescription,\n\t};\n\treturn {\n\t\tscreenProps,\n\t\tcurrentStepIndex,\n\t\tsetCurrentStepIndex: setCurrentStepIndex,\n\t\tcurrentStep: props.steps[currentStepIndex],\n\t};\n};\n","import { CheckIcon } from '@heroicons/react/24/solid';\nimport React from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport { StepScreen, StepScreenProps } from '@/hooks/useSteps';\n\ninterface StepProps {\n\tsteps: StepScreen[];\n\tscreenProps: StepScreenProps;\n\tcurrentStepIndex: number;\n\tsetCurrentStepIndex: (index: number) => void;\n}\n\nexport const VerticalSteps: React.FC<StepProps> = (props) => {\n\treturn (\n\t\t<nav aria-label=\"Progress\">\n\t\t\t<ol role=\"list\" className=\"overflow-hidden\">\n\t\t\t\t{props.steps.map((step, stepIdx) => {\n\t\t\t\t\tconst name = typeof step.name === 'function' ? step.name(props.screenProps) : step.name;\n\t\t\t\t\tconst description =\n\t\t\t\t\t\ttypeof step.description === 'function' ? step.description(props.screenProps) : step.description;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={name} className={twJoin(stepIdx !== props.steps.length - 1 ? 'pb-10' : '', 'relative')}>\n\t\t\t\t\t\t\t{props.currentStepIndex > stepIdx ? (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{stepIdx !== props.steps.length - 1 ? (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute left-4 top-4 -ml-px mt-0.5 h-full w-0.5 bg-brand-600 dark:bg-brand-500\"\n\t\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName=\"group relative flex cursor-pointer items-start\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => props.setCurrentStepIndex(stepIdx)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<span className=\"flex h-9 items-center\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"relative z-10 flex h-8 w-8 items-center justify-center rounded-full bg-brand-600 dark:bg-brand-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t<CheckIcon className=\"h-5 w-5 text-brand-100 dark:text-brand-900\" aria-hidden=\"true\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"ml-4 flex min-w-0 flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs font-semibold uppercase tracking-wide dark:text-zinc-200\">{name}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-zinc-500 dark:text-zinc-400\">{description}</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) : props.currentStepIndex === stepIdx ? (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{stepIdx !== props.steps.length - 1 ? (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute left-4 top-4 -ml-px mt-0.5 h-full w-0.5 bg-zinc-300 dark:bg-zinc-700\"\n\t\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={twMerge('group relative flex items-start', step.canBeSkippedTo && 'cursor-pointer')}\n\t\t\t\t\t\t\t\t\t\taria-current=\"step\"\n\t\t\t\t\t\t\t\t\t\tonClick={!step.canBeSkippedTo ? undefined : () => props.setCurrentStepIndex(stepIdx)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<span className=\"flex h-9 items-center\" aria-hidden=\"true\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"relative z-10 flex h-8 w-8 items-center justify-center rounded-full border-2 border-brand-600 bg-white dark:border-brand-500 dark:bg-zinc-800\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"h-2.5 w-2.5 rounded-full bg-brand-600 dark:bg-brand-500\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"ml-4 flex min-w-0 flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs font-semibold uppercase tracking-wide text-brand-600 dark:text-brand-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-zinc-500 dark:text-zinc-400\">{description}</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{stepIdx !== props.steps.length - 1 ? (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute left-4 top-4 -ml-px mt-0.5 h-full w-0.5 bg-zinc-300 dark:bg-zinc-700\"\n\t\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={twMerge('group relative flex items-start', step.canBeSkippedTo && 'cursor-pointer')}\n\t\t\t\t\t\t\t\t\t\taria-current=\"step\"\n\t\t\t\t\t\t\t\t\t\tonClick={!step.canBeSkippedTo ? undefined : () => props.setCurrentStepIndex(stepIdx)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<span className=\"flex h-9 items-center\" aria-hidden=\"true\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"relative z-10 flex h-8 w-8 items-center justify-center rounded-full border-2 border-zinc-300 bg-white dark:border-zinc-700 dark:bg-zinc-800\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"h-2.5 w-2.5 rounded-full bg-transparent\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"ml-4 flex min-w-0 flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs font-semibold uppercase tracking-wide text-zinc-500 dark:text-zinc-200\">\n\t\t\t\t\t\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-zinc-500 dark:text-zinc-400\">{description}</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t</nav>\n\t);\n};\n","'use client';\nimport { PlayIcon, ForwardIcon } from '@heroicons/react/24/outline';\nimport React from 'react';\nimport { Button } from '@/components/common/button';\nimport { Spinner } from '@/components/common/spinner';\nimport { ChevronLeft, ChevronRight, ChevronsRight } from 'lucide-react';\n\nexport interface StepNavButton {\n\tlabel?: string;\n\tonClick?: () => void;\n\tdisabled?: boolean;\n\tisLoading?: boolean;\n\ttitle?: string;\n}\n\ninterface StepNavButtonsProps {\n\tright: StepNavButton;\n\tleft: StepNavButton;\n\tskip?: Omit<StepNavButton, 'isLoading'>;\n}\n\nexport const StepNavButtons: React.FC<StepNavButtonsProps> = (props) => {\n\tconst leftIcon = props.left.isLoading ? (\n\t\t<Spinner noMargin={true} className=\"dark:text-black\" />\n\t) : (\n\t\t<ChevronLeft className=\"-ml-2 h-5 w-5\" aria-hidden=\"true\" />\n\t);\n\tconst left = props.left.onClick ? (\n\t\t<div className=\"flex flex-1 justify-start\">\n\t\t\t<Button\n\t\t\t\tvariant=\"indeterminate\"\n\t\t\t\tdisabled={props.left.disabled}\n\t\t\t\tonClick={!props.left.isLoading ? props.left.onClick : undefined}\n\t\t\t\ttitle={props.left.title}\n\t\t\t\tclassName={props.left.isLoading ? 'cursor-wait' : 'cursor-pointer'}\n\t\t\t>\n\t\t\t\t{leftIcon}\n\t\t\t\t{props.left.label ?? 'Back'}\n\t\t\t</Button>\n\t\t</div>\n\t) : null;\n\n\tconst rightIcon = props.right.isLoading ? (\n\t\t<Spinner noMargin={true} className=\"dark:text-black\" />\n\t) : (\n\t\t<ChevronRight className=\"-mr-2 h-5 w-5\" aria-hidden=\"true\" />\n\t);\n\n\tconst right = props.right.onClick ? (\n\t\t<div className=\"flex flex-1 justify-end space-x-4\">\n\t\t\t{props.skip && (\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"indeterminate\"\n\t\t\t\t\tonClick={props.skip.onClick}\n\t\t\t\t\tdisabled={props.skip.disabled}\n\t\t\t\t\ttitle={props.skip.title}\n\t\t\t\t>\n\t\t\t\t\t{props.skip.label ?? 'Skip'}\n\t\t\t\t\t<ChevronsRight className=\"-mr-1.5 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t</Button>\n\t\t\t)}\n\t\t\t<Button\n\t\t\t\tvariant=\"primary\"\n\t\t\t\tdisabled={props.right.disabled}\n\t\t\t\tonClick={!props.right.isLoading ? props.right.onClick : undefined}\n\t\t\t\ttitle={props.right.title}\n\t\t\t\tclassName={props.right.isLoading ? 'cursor-wait' : undefined}\n\t\t\t>\n\t\t\t\t{props.right.label ?? 'Next'}\n\t\t\t\t{rightIcon}\n\t\t\t</Button>\n\t\t</div>\n\t) : null;\n\n\treturn (\n\t\t<div className=\"px-8 pb-5\">\n\t\t\t<nav\n\t\t\t\tclassName=\"flex items-center justify-between border-t border-zinc-200 py-3 dark:border-zinc-700\"\n\t\t\t\taria-label=\"Pagination\"\n\t\t\t>\n\t\t\t\t{left}\n\t\t\t\t{right}\n\t\t\t</nav>\n\t\t</div>\n\t);\n};\n","'use client';\nimport React, { useEffect, useState } from 'react';\nimport { StepNavButtons } from '@/components/step-nav-buttons';\nimport { StepScreenProps } from '@/hooks/useSteps';\nimport { DropdownWithPrinterQuery } from '@/components/forms/dropdown';\nimport { usePrinterConfiguration } from '@/hooks/usePrinterConfiguration';\nimport { ErrorMessage } from '@/components/common/error-message';\nimport { Toggle } from '@/components/forms/toggle';\nimport { PrinterRailSettings } from '@/components/setup-steps/printer-rail-settings';\nimport { deserializePrinterRailDefinition } from '@/utils/serialization';\nimport { ToolheadSettings } from '@/components/setup-steps/toolhead-settings';\nimport { Spinner } from '@/components/common/spinner';\nimport { BasePrinterRail, PrinterAxis } from '@/zods/motion';\nimport { z } from 'zod';\nimport { AnimatePresence, LayoutGroup, motion } from 'framer-motion';\nimport { AnimatedContainer } from '@/components/common/animated-container';\n\nexport const HardwareSelection: React.FC<StepScreenProps> = (props) => {\n\tconst [advancedSteppers, setAdvancedSteppers] = useState(false);\n\tconst {\n\t\tselectedControllerFan,\n\t\tselectedBoard,\n\t\tselectedPrinter,\n\t\tperformanceMode,\n\t\tsetPerformanceMode,\n\t\tstealthchop,\n\t\tsetStealthchop,\n\t\tstandstillStealth,\n\t\tsetStandstillStealth,\n\t\tselectedPrinterRails,\n\t\tsetSelectedControllerFan: setControllerFan,\n\t\tserializedPrinterConfiguration,\n\t\tparsedPrinterConfiguration,\n\t\tpartialPrinterConfiguration,\n\t} = usePrinterConfiguration();\n\tconst errors: string[] = [];\n\tlet formattedErrors = parsedPrinterConfiguration.success === false ? parsedPrinterConfiguration.error.format() : null;\n\tconst railErrors: {\n\t\t[i: string]: z.inferFormattedError<typeof BasePrinterRail>;\n\t} = {};\n\tpartialPrinterConfiguration?.rails?.forEach((rail, ri) => {\n\t\tlet railError: string[] = [];\n\t\tif (![PrinterAxis.extruder, PrinterAxis.extruder1].includes(rail.axis)) {\n\t\t\tif (rail.motorSlot == null) {\n\t\t\t\terrors.push(`Motor slot for ${rail.axis.toUpperCase()} is not set`);\n\t\t\t\trailError = [`Motor slot for ${rail.axis.toUpperCase()} is not set`];\n\t\t\t}\n\t\t}\n\t\trailErrors[ri] = {\n\t\t\t...(formattedErrors?.rails?.[ri] ?? {}),\n\t\t\t_errors: formattedErrors?.rails?.[ri]?._errors?.concat(railError ?? []) ?? railError,\n\t\t};\n\t});\n\tif (partialPrinterConfiguration != null) {\n\t\tif (parsedPrinterConfiguration.success === false) {\n\t\t\tparsedPrinterConfiguration.error.flatten().formErrors.forEach((message) => {\n\t\t\t\terrors.push(message);\n\t\t\t});\n\t\t}\n\t}\n\tuseEffect(() => {\n\t\tif (parsedPrinterConfiguration.success === false) {\n\t\t\tif (parsedPrinterConfiguration.error.errors.some((e) => e.path[0] === 'rails')) {\n\t\t\t\tsetAdvancedSteppers(true);\n\t\t\t}\n\t\t}\n\t}, [parsedPrinterConfiguration]);\n\treturn (\n\t\t<div>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\tSelect your printer hardware\n\t\t\t\t\t</h3>\n\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\tIf your hardware isn't listed, pick the one closest to it and override as necessary in printer.cfg later\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<AnimatedContainer>\n\t\t\t\t\t{errors.length > 0 && (\n\t\t\t\t\t\t<ErrorMessage className=\"mb-4\">\n\t\t\t\t\t\t\t<AnimatePresence>\n\t\t\t\t\t\t\t\t{errors.map((e) => (\n\t\t\t\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\t\t\t\tclassName=\"mt-2\"\n\t\t\t\t\t\t\t\t\t\tkey={e}\n\t\t\t\t\t\t\t\t\t\texit={{ opacity: 0, scale: 0.9, y: -40 }}\n\t\t\t\t\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.9, y: 40 }}\n\t\t\t\t\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1, y: 0 }}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{e}\n\t\t\t\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</AnimatePresence>\n\t\t\t\t\t\t</ErrorMessage>\n\t\t\t\t\t)}\n\t\t\t\t\t<AnimatedContainer className=\"space-y-4\">\n\t\t\t\t\t\t<AnimatePresence>\n\t\t\t\t\t\t\t{serializedPrinterConfiguration?.toolheads?.map((th, i) =>\n\t\t\t\t\t\t\t\tth == null || th.axis == null ? null : (\n\t\t\t\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\texit={{ opacity: 0, scale: 0.9, y: -40 }}\n\t\t\t\t\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.9, y: 40 }}\n\t\t\t\t\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1, y: 0 }}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<React.Suspense fallback={<Spinner />}>\n\t\t\t\t\t\t\t\t\t\t\t<ToolheadSettings toolOrAxis={th.axis} />\n\t\t\t\t\t\t\t\t\t\t</React.Suspense>\n\t\t\t\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</AnimatePresence>\n\t\t\t\t\t</AnimatedContainer>\n\t\t\t\t\t<div className=\"mt-4 border-t border-zinc-100 pt-8 dark:border-zinc-700\">\n\t\t\t\t\t\t<div className=\"flex\">\n\t\t\t\t\t\t\t<h3 className=\"flex-1 text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100\">Electronics</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\tConfigure miscellaneous electronics settings\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\t\t\tlabel=\"Controller fan\"\n\t\t\t\t\t\t\t\tquery=\"controllerFanOptions\"\n\t\t\t\t\t\t\t\tvars={{ config: serializedPrinterConfiguration }}\n\t\t\t\t\t\t\t\tonSelect={setControllerFan}\n\t\t\t\t\t\t\t\tvalue={selectedControllerFan}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mt-4 border-t border-zinc-100 pt-8 dark:border-zinc-700\">\n\t\t\t\t\t\t<div className=\"flex\">\n\t\t\t\t\t\t\t<h3 className=\"flex-1 text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100\">Motion</h3>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Toggle label=\"Simple\" onLabel=\"Advanced\" onChange={setAdvancedSteppers} value={!!advancedSteppers} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\tConfigure your stepper motor and driver settings\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t{selectedPrinter?.speedLimits.performance && (\n\t\t\t\t\t\t\t<div className=\"col-span-2\">\n\t\t\t\t\t\t\t\t<Toggle\n\t\t\t\t\t\t\t\t\tlabel=\"Performance mode\"\n\t\t\t\t\t\t\t\t\tdescription=\"Increases the stepper power, max acceleration and velocity. Not recommended for initial setup. Requires actively cooled drivers (controller fan).\"\n\t\t\t\t\t\t\t\t\tonChange={setPerformanceMode}\n\t\t\t\t\t\t\t\t\tvalue={!!performanceMode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<div className=\"col-span-2\">\n\t\t\t\t\t\t\t<Toggle\n\t\t\t\t\t\t\t\tlabel=\"Stealtchop\"\n\t\t\t\t\t\t\t\tdescription=\"Silent operation at the cost of a 135 mm/s velocity limit and less positional accuracy. Not recommended unless quiteness is absolutely necessary.\"\n\t\t\t\t\t\t\t\tonChange={setStealthchop}\n\t\t\t\t\t\t\t\tvalue={!!stealthchop}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"col-span-2\">\n\t\t\t\t\t\t\t<Toggle\n\t\t\t\t\t\t\t\tlabel=\"Standstill Stealth\"\n\t\t\t\t\t\t\t\tdescription=\"Makes steppers silent when idling, but can cause unpredictable behavior on some drivers. Can result in skipped steps and positional errors, use with caution.\"\n\t\t\t\t\t\t\t\tonChange={setStandstillStealth}\n\t\t\t\t\t\t\t\tvalue={!!standstillStealth}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</AnimatedContainer>\n\t\t\t\t<div>\n\t\t\t\t\t{selectedPrinter && (\n\t\t\t\t\t\t<LayoutGroup id=\"rails\">\n\t\t\t\t\t\t\t<AnimatedContainer className=\"grid gap-4 py-4 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t{selectedPrinterRails.map((rail, ri) => {\n\t\t\t\t\t\t\t\t\tconst defaultRail = selectedPrinter.defaults.rails.find((r) => r.axis === rail.axis);\n\t\t\t\t\t\t\t\t\tif (defaultRail == null) {\n\t\t\t\t\t\t\t\t\t\tthrow new Error('No printer default for axis ' + rail.axis);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst errorCount =\n\t\t\t\t\t\t\t\t\t\trailErrors[ri] == null\n\t\t\t\t\t\t\t\t\t\t\t? 0\n\t\t\t\t\t\t\t\t\t\t\t: Object.keys(railErrors[ri]).reduce((acc, key) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst objKey = key as keyof (typeof railErrors)[number];\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst keyErrors = railErrors[ri][objKey];\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (keyErrors == null) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn acc;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst count = Array.isArray(keyErrors) ? keyErrors.length : keyErrors._errors?.length ?? 0;\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn acc + count;\n\t\t\t\t\t\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<PrinterRailSettings\n\t\t\t\t\t\t\t\t\t\t\tkey={rail.axis}\n\t\t\t\t\t\t\t\t\t\t\terrors={railErrors[ri]}\n\t\t\t\t\t\t\t\t\t\t\tselectedBoard={selectedBoard}\n\t\t\t\t\t\t\t\t\t\t\tprinterRail={rail}\n\t\t\t\t\t\t\t\t\t\t\tprinterRailDefault={deserializePrinterRailDefinition(defaultRail)}\n\t\t\t\t\t\t\t\t\t\t\tperformanceMode={performanceMode}\n\t\t\t\t\t\t\t\t\t\t\tisVisible={advancedSteppers || errorCount > 0}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</AnimatedContainer>\n\t\t\t\t\t\t</LayoutGroup>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<StepNavButtons\n\t\t\t\tleft={{ onClick: props.previousScreen }}\n\t\t\t\tright={{\n\t\t\t\t\tonClick: props.nextScreen,\n\t\t\t\t\tdisabled: !parsedPrinterConfiguration.success || errors.length > 0,\n\t\t\t\t\ttitle:\n\t\t\t\t\t\tparsedPrinterConfiguration.success === false || errors.length > 0\n\t\t\t\t\t\t\t? 'Invalid printer configuration selected'\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t);\n};\n","'use client';\nimport { TRPCClientErrorLike } from '@trpc/client';\nimport { UseTRPCQueryResult } from '@trpc/react-query/src/shared/hooks/types';\nimport { AppRouter } from '@/server/routers';\nimport { ErrorMessage } from '@/components/common/error-message';\nimport { Spinner } from '@/components/common/spinner';\nimport { motion } from 'framer-motion';\nimport { AnimatedContainer } from '@/components/common/animated-container';\nimport { UseQueryResult } from '@tanstack/react-query';\n\nexport const QueryStatus = (query: UseQueryResult<any, any>) => {\n\tlet content = null;\n\tif (query.isError) {\n\t\tcontent = (\n\t\t\t<div className=\"mb-4\">\n\t\t\t\t<ErrorMessage>{query.error?.message}</ErrorMessage>\n\t\t\t</div>\n\t\t);\n\t}\n\tif (query.isLoading) {\n\t\tcontent = (\n\t\t\t<div className=\"mb-4 flex items-center justify-center\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t);\n\t}\n\treturn <AnimatedContainer>{content}</AnimatedContainer>;\n};\n","'use client';\nimport { TRPCClientErrorLike } from '@trpc/client';\nimport { UseMutationResult } from '@tanstack/react-query';\nimport { AppRouter } from '@/server/routers';\nimport { ErrorMessage } from '@/components/common/error-message';\nimport { Spinner } from '@/components/common/spinner';\n\nexport const MutationStatus = (mutation: UseMutationResult<any, TRPCClientErrorLike<AppRouter>, any, any>) => {\n\tif (mutation.isError) {\n\t\treturn (\n\t\t\t<div className=\"mb-4 h-48\">\n\t\t\t\t<ErrorMessage>{mutation.error?.message}</ErrorMessage>\n\t\t\t</div>\n\t\t);\n\t}\n\tif (mutation.isLoading && !mutation.isIdle && !mutation.isPaused) {\n\t\treturn (\n\t\t\t<div className=\"absolute right-5 top-9 mb-4 flex items-center\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t);\n\t}\n\treturn null;\n};\n","import { InformationCircleIcon } from '@heroicons/react/24/solid';\nimport React from 'react';\nimport { Banner } from '@/components/common/banner';\n\nexport type InfoMessageProps = React.PropsWithChildren<{\n\ttitle?: string;\n\tclassName?: string;\n}>;\n\nexport const InfoMessage: React.FC<InfoMessageProps> = (props) => {\n\treturn (\n\t\t<Banner\n\t\t\tcolor=\"blue\"\n\t\t\tIcon={InformationCircleIcon}\n\t\t\ttitle={props.title ? props.title : 'Info'}\n\t\t\tclassName={props.className}\n\t\t>\n\t\t\t{props.children}\n\t\t</Banner>\n\t);\n};\n","/* eslint-disable @next/next/no-img-element */\nimport React, { useCallback, useState } from 'react';\nimport { ToolheadHelper } from '@/helpers/toolhead';\nimport { trpc } from '@/helpers/trpc';\nimport { Board } from '@/zods/boards';\nimport { Button } from '@/components/common/button';\nimport { ErrorMessage } from '@/components/common/error-message';\nimport { InfoMessage } from '@/components/common/info-message';\n\ninterface DFUFlashProps {\n\tboard: Board;\n\ttoolhead?: ToolheadHelper<any> | null;\n\tonSuccess?: () => void;\n}\n\nexport const DFUFlash: React.FC<DFUFlashProps> = (props) => {\n\tconst { data: dfuDetected, error } = trpc.mcu.dfuDetect.useQuery(\n\t\t{ boardPath: props.board.path, toolhead: props.toolhead?.serialize() },\n\t\t{\n\t\t\trefetchInterval: 1000,\n\t\t},\n\t);\n\tconst flashDfuMutation = trpc.mcu.dfuFlash.useMutation({ onSuccess: props.onSuccess });\n\tconst [isFlashing, setIsFlashing] = useState(false);\n\n\tconst startFlash = useCallback(async () => {\n\t\tsetIsFlashing(true);\n\t\tflashDfuMutation.mutate(\n\t\t\t{ boardPath: props.board.path, toolhead: props.toolhead?.serialize() },\n\t\t\t{\n\t\t\t\tonSettled: () => setIsFlashing(false),\n\t\t\t},\n\t\t);\n\t}, [flashDfuMutation, props.board.path, props.toolhead]);\n\n\tconst dfuError = error ? <ErrorMessage>{error.message}</ErrorMessage> : null;\n\n\tconst flashButtonTitle = isFlashing ? 'Flashing...' : dfuDetected ? 'Flash' : 'Waiting for DFU...';\n\n\tconst boardPathUri = 'boardPath=' + encodeURIComponent(props.board.path);\n\n\tconst instructions = props.board.dfu?.instructions.map((step, index) => <li key={index}>{step}</li>);\n\n\tconst detectionText = dfuDetected ? 'DFU device detected' : 'DFU not detected';\n\tconst jumperReminder =\n\t\tdfuDetected && props.board.dfu?.hasBoot0Jumper ? (\n\t\t\t<InfoMessage title=\"Reminder\">Make sure to remove the BOOT0 jumper from the board before flashing.</InfoMessage>\n\t\t) : null;\n\n\treturn (\n\t\t<div className=\"space-y-4\">\n\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">Flashing {props.board.name} via DFU</h3>\n\t\t\t{dfuError}\n\t\t\t{}\n\t\t\t<p className=\"mt-4 text-zinc-500 dark:text-zinc-400\">Status: {detectionText}</p>\n\t\t\t{jumperReminder}\n\t\t\t<Button variant=\"primary\" disabled={!dfuDetected || isFlashing} onClick={startFlash}>\n\t\t\t\t{flashButtonTitle}\n\t\t\t</Button>\n\t\t\t<h4 className=\"text-sm font-medium text-zinc-900 dark:text-zinc-100\">DFU Boot Instructions</h4>\n\t\t\t<div className=\"prose mt-4 text-base text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t<ol className=\"mb-4 list-decimal pl-4\">{instructions}</ol>\n\t\t\t\t<img src={'/configure/api/dfu-image?' + boardPathUri} alt=\"DFU boot buttons and/or jumper visualization\" />\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","'use client';\n/* This example requires Tailwind CSS v2.0+ */\nimport React, { Fragment, useCallback, useState } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { CheckIcon } from '@heroicons/react/24/outline';\n\ninterface ModalProps {\n\ttitle: string;\n\tbody: string;\n\tsuccess?: boolean;\n\tbuttonLabel: string;\n\tonClick?: () => void;\n\tonClose?: () => void;\n}\n\nexport const Modal: React.FC<ModalProps> = (props) => {\n\tconst { onClick, onClose } = props;\n\tconst [open, setOpen] = useState(true);\n\tconst onButtonClick = useCallback(() => {\n\t\tonClick?.();\n\t\tsetOpen(false);\n\t}, [onClick]);\n\n\tconst onDialogClose = useCallback(() => {\n\t\tonClose?.();\n\t\tsetOpen(false);\n\t}, [onClose]);\n\n\tconst success = props.success ? (\n\t\t<div className=\"mx-auto flex h-12 w-12 items-center justify-center rounded-full  bg-green-100 dark:bg-green-700\">\n\t\t\t<CheckIcon className=\"h-6 w-6 text-green-600 dark:text-green-100\" aria-hidden=\"true\" />\n\t\t</div>\n\t) : null;\n\n\treturn (\n\t\t<Transition.Root show={open} as={Fragment} appear={true}>\n\t\t\t<Dialog\n\t\t\t\tas=\"div\"\n\t\t\t\tclassName=\"fixed inset-0 z-10 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600\"\n\t\t\t\tonClose={onDialogClose}\n\t\t\t>\n\t\t\t\t<div className=\"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0\">\n\t\t\t\t\t<Transition.Child\n\t\t\t\t\t\tas={Fragment}\n\t\t\t\t\t\tenter=\"ease-out duration-300\"\n\t\t\t\t\t\tenterFrom=\"opacity-0\"\n\t\t\t\t\t\tenterTo=\"opacity-100\"\n\t\t\t\t\t\tleave=\"ease-in duration-200\"\n\t\t\t\t\t\tleaveFrom=\"opacity-100\"\n\t\t\t\t\t\tleaveTo=\"opacity-0\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Dialog.Overlay className=\"fixed inset-0 bg-zinc-500 bg-opacity-75 transition-opacity dark:bg-zinc-800 dark:bg-opacity-75\" />\n\t\t\t\t\t</Transition.Child>\n\n\t\t\t\t\t{/* This element is to trick the browser into centering the modal contents. */}\n\t\t\t\t\t<span className=\"hidden sm:inline-block sm:h-screen sm:align-middle\" aria-hidden=\"true\">\n\t\t\t\t\t\t&#8203;\n\t\t\t\t\t</span>\n\t\t\t\t\t<Transition.Child\n\t\t\t\t\t\tas={Fragment}\n\t\t\t\t\t\tenter=\"ease-out duration-300\"\n\t\t\t\t\t\tenterFrom=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n\t\t\t\t\t\tenterTo=\"opacity-100 translate-y-0 sm:scale-100\"\n\t\t\t\t\t\tleave=\"ease-in duration-200\"\n\t\t\t\t\t\tleaveFrom=\"opacity-100 translate-y-0 sm:scale-100\"\n\t\t\t\t\t\tleaveTo=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"relative inline-block transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left align-bottom shadow-xl transition-all dark:bg-zinc-900 sm:my-8 sm:w-full sm:max-w-sm sm:p-6 sm:align-middle\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{success}\n\t\t\t\t\t\t\t\t<div className=\"mt-3 text-center sm:mt-5\">\n\t\t\t\t\t\t\t\t\t<Dialog.Title as=\"h3\" className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t{props.title}\n\t\t\t\t\t\t\t\t\t</Dialog.Title>\n\t\t\t\t\t\t\t\t\t<div className=\"mt-2\">\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-zinc-500 dark:text-zinc-400\">{props.body}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"mt-5 sm:mt-6\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tclassName=\"inline-flex w-full justify-center rounded-md border border-transparent bg-brand-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 sm:text-sm\"\n\t\t\t\t\t\t\t\t\tonClick={onButtonClick}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{props.buttonLabel}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Transition.Child>\n\t\t\t\t</div>\n\t\t\t</Dialog>\n\t\t</Transition.Root>\n\t);\n};\n","/**\n * 1) Check if board is already flashed and connected, if yes proceed to ?.\n * 2) Compile firmware for board and start download (if flash via sd card)\n * 3) Tell the user to follow the flashing instructions at os.ratrig.com. Poll board serial path in the background. Show tips about flashing.\n * 4) Once board presence is confirmed, verify automatic flashing if supported. (allow skipping)\n * 5) Printer configuration!\n */\n\nimport { ArrowDownTrayIcon, PlayIcon } from '@heroicons/react/24/solid';\nimport React, { useState } from 'react';\nimport { useMutation } from '@tanstack/react-query';\nimport { trpc } from '@/helpers/trpc';\nimport { Button } from '@/components/common/button';\nimport { Modal } from '@/components/common/modal';\nimport { Spinner } from '@/components/common/spinner';\nimport { useMoonraker } from '@/moonraker/hooks';\nimport { Board } from '@/zods/boards';\nimport { ToolheadHelper } from '@/helpers/toolhead';\nimport { ErrorMessage } from '@/components/common/error-message';\n\ninterface SDCardFlashingProps {\n\tboard: Board;\n\ttoolhead?: ToolheadHelper<any> | null;\n\tonSuccess?: () => void;\n}\n\nexport const SDCardFlashing: React.FC<SDCardFlashingProps> = (props) => {\n\tconst [shutdownModalVisible, setShutdownModalVisible] = useState(false);\n\tconst { query: moonrakerQuery, isReady } = useMoonraker();\n\tconst [isFirmwareReady, setIsFirmwareReady] = useState(false);\n\tconst compile = trpc.mcu.compile.useMutation({\n\t\tonSuccess: () => setIsFirmwareReady(true),\n\t\tonError: () => setIsFirmwareReady(false),\n\t});\n\tconst shutdownMutation = useMutation<void, string>({\n\t\tmutationFn: () => {\n\t\t\tif (isReady) {\n\t\t\t\tmoonrakerQuery('machine.shutdown');\n\t\t\t}\n\t\t\treturn Promise.reject('Cannot reboot raspberry pi: No connection to moonraker');\n\t\t},\n\t});\n\n\tconst shutdown = () => {\n\t\tshutdownMutation.mutate();\n\t};\n\tconst onShutdown = () => {\n\t\tsetShutdownModalVisible(true);\n\t};\n\n\tconst compileButton = compile.isLoading ? (\n\t\t<span>\n\t\t\tCompiling... <Spinner className=\"ml-1 inline\" noMargin={true} />\n\t\t</span>\n\t) : (\n\t\t<span>\n\t\t\tCompile firmware <PlayIcon className=\"inline h-5 w-5\" />\n\t\t</span>\n\t);\n\n\treturn (\n\t\t<div className=\"space-y-4\">\n\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t{props.board.manufacturer} {props.board.name} was not detected\n\t\t\t</h3>\n\n\t\t\t<Button\n\t\t\t\tvariant=\"primary\"\n\t\t\t\tonClick={\n\t\t\t\t\tisFirmwareReady\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: () => compile.mutate({ boardPath: props.board.path, toolhead: props.toolhead?.serialize() })\n\t\t\t\t}\n\t\t\t\tclassName=\"w-52 justify-center\"\n\t\t\t\tdisabled={compile.isLoading && !isFirmwareReady}\n\t\t\t\thref={isFirmwareReady ? `/api/download-firmware?boardPath=${encodeURIComponent(props.board.path)}` : undefined}\n\t\t\t>\n\t\t\t\t{isFirmwareReady ? (\n\t\t\t\t\t<span>\n\t\t\t\t\t\tDownload firmware <ArrowDownTrayIcon className=\"inline h-5 w-5\" />\n\t\t\t\t\t</span>\n\t\t\t\t) : (\n\t\t\t\t\tcompileButton\n\t\t\t\t)}\n\t\t\t</Button>\n\n\t\t\t{compile.error?.message ? <ErrorMessage>{compile.error?.message}</ErrorMessage> : null}\n\n\t\t\t<div className=\"prose mt-4 text-base text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t<ol className=\"mb-4 list-decimal pl-4\">\n\t\t\t\t\t<li>Disconnect all wires except Power and USB, and make sure your jumpers are set correctly.</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\tFormat the sd card for your board to FAT16 (sometimes just called FAT), or FAT32 with a clustersize of 8kb\n\t\t\t\t\t\tor 4kb.\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\tIf you're reusing a card you've used for flashing before, be sure to delete ALL files on the card (or\n\t\t\t\t\t\treformat it).\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>Copy the firmware binary onto the sd card for your board</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\tMake sure the firmware file is called firmware.bin on the sd card (enable \"display file extensions\" in your\n\t\t\t\t\t\tfile explorer). The file you downloaded will already have the correct name.\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>Safely eject the SD card through your operating system.</li>\n\t\t\t\t\t<li>Physically take out the sd card and insert it into your control board.</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\tClick the reset button on the board, or turn it off and back on again. NOTE: if the Raspberry Pi running\n\t\t\t\t\t\tRatOS is currently powered by your control board or the same power source, please shut it down safely first\n\t\t\t\t\t\tby using the button below. When the green light stops blinking and is turned off, you can cut the power.\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>Click \"Check board status\" below.</li>\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"flex gap-x-4\">\n\t\t\t\t\t<Button variant=\"indeterminate\" onClick={onShutdown}>\n\t\t\t\t\t\tShutdown RatOS\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button variant=\"primary\" onClick={props.onSuccess}>\n\t\t\t\t\t\tCheck board status\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{shutdownModalVisible ? (\n\t\t\t\t<Modal\n\t\t\t\t\ttitle=\"Shutdown RatOS?\"\n\t\t\t\t\tbody={`You raspberry pi will shutdown and this page will become unresponsive until it's powered back on. Do not remove power before the green light on the Rasperry Pi has stopped blinking.`}\n\t\t\t\t\tbuttonLabel=\"Shutdown\"\n\t\t\t\t\tonClick={shutdown}\n\t\t\t\t\tonClose={() => setTimeout(() => setShutdownModalVisible(false), 500)}\n\t\t\t\t/>\n\t\t\t) : null}\n\t\t</div>\n\t);\n};\n","import { CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { Fragment, useCallback, useState } from 'react';\nimport { trpc } from '@/helpers/trpc';\nimport { Button } from '@/components/common/button';\nimport { MutationStatus } from '@/components/common/mutation-status';\nimport { InfoMessage } from '@/components/common/info-message';\nimport { Spinner } from '@/components/common/spinner';\nimport { StepNavButton, StepNavButtons } from '@/components/step-nav-buttons';\nimport { WarningMessage } from '@/components/warning-message';\nimport { MCUStepScreenProps } from '@/components/setup-steps/mcu-preparation';\nimport { DFUFlash } from '@/components/setup-steps/mcu/dfu-flash';\nimport { SDCardFlashing } from '@/components/setup-steps/mcu/sd-card-flash';\n\nexport const MCUFlashing = (props: MCUStepScreenProps) => {\n\tconst [forceReflash, setForceReflash] = useState(false);\n\tconst [flashStrategy, setFlashStrategy] = useState<null | 'dfu' | 'sdcard' | 'path'>(null);\n\tconst [flashPath, setFlashPath] = useState<string | null>(null);\n\tconst { selectedControlboard, selectedToolboard, toolhead } = props;\n\tconst selectedBoardToFlash = toolhead ? selectedToolboard : selectedControlboard;\n\tconst selectedBoard = selectedBoardToFlash;\n\tconst boardDetected = trpc.mcu.detect.useQuery(\n\t\t{ boardPath: selectedBoardToFlash?.path ?? '', toolhead: toolhead?.serialize() },\n\t\t{\n\t\t\trefetchInterval: (data) => {\n\t\t\t\tif (data === true) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn 1000;\n\t\t\t},\n\t\t\tenabled: selectedBoardToFlash !== null,\n\t\t},\n\t);\n\tconst unidentifiedBoards = trpc.mcu.unidentifiedDevices.useQuery();\n\tconst boardVersion = trpc.mcu.boardVersion.useQuery(\n\t\t{ boardPath: selectedBoardToFlash?.path ?? '', toolhead: toolhead?.serialize() },\n\t\t{\n\t\t\tenabled: selectedBoardToFlash !== null && !!boardDetected.data && forceReflash === false,\n\t\t\trefetchOnWindowFocus: false,\n\t\t\trefetchOnMount: false,\n\t\t\trefetchOnReconnect: false,\n\t\t},\n\t);\n\tconst { data: klipperVersion } = trpc.klipperVersion.useQuery(undefined, {\n\t\trefetchInterval: 60000,\n\t});\n\tconst flashViaPath = trpc.mcu.flashViaPath.useMutation({ onSuccess: () => setForceReflash(false) });\n\n\tconst reflash = useCallback(() => {\n\t\tsetFlashStrategy(null);\n\t\tsetForceReflash(true);\n\t\tsetFlashPath(null);\n\t\tboardDetected.remove();\n\t\tboardVersion.remove();\n\t}, [boardVersion, boardDetected]);\n\n\tlet rightButton: StepNavButton = {\n\t\tonClick: props.nextScreen,\n\t\tlabel: 'Next',\n\t\tdisabled: !boardDetected.data || forceReflash,\n\t};\n\tlet leftButton: StepNavButton = {\n\t\tonClick: props.previousScreen,\n\t};\n\n\tconst onFlashViaPath = useCallback(() => {\n\t\tif (selectedBoard == null) return;\n\t\tsetFlashStrategy('path');\n\t\tflashViaPath.mutate({ boardPath: selectedBoard.path, toolhead: toolhead?.serialize() });\n\t}, [flashViaPath, selectedBoard, toolhead]);\n\n\tlet content = null;\n\tif (boardVersion.error && !forceReflash) {\n\t\tcontent = (\n\t\t\t<Fragment>\n\t\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t{selectedBoard?.name} detected but is unresponsive.\n\t\t\t\t</h3>\n\t\t\t\t<p>\n\t\t\t\t\tKlipper doesn't seem to be running on your board, which may indicate faulty firmware or a faulty board. Please\n\t\t\t\t\tcheck your board and try flashing it again.\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\t<Button variant=\"indeterminate\" onClick={reflash}>\n\t\t\t\t\t\t<span>Flash again</span> <ArrowPathIcon className=\"inline h-5 w-5\" />\n\t\t\t\t\t</Button>\n\t\t\t\t</p>\n\t\t\t</Fragment>\n\t\t);\n\t} else if (boardVersion.isFetching) {\n\t\tcontent = (\n\t\t\t<Fragment>\n\t\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t<Spinner className=\"relative -top-0.5 mr-2 inline\" noMargin={true} /> {selectedBoard?.name} detected, checking\n\t\t\t\t\tversion...\n\t\t\t\t</h3>\n\t\t\t\t<p>Please wait while RatOS queries your board..</p>\n\t\t\t</Fragment>\n\t\t);\n\t} else if (boardVersion.data || (boardDetected.data && !forceReflash)) {\n\t\tconst dfuReminder =\n\t\t\tflashStrategy === 'dfu' && selectedBoard?.dfu?.reminder ? (\n\t\t\t\t<InfoMessage title=\"Reminder\">{selectedBoard?.dfu?.reminder}</InfoMessage>\n\t\t\t) : null;\n\t\tconst versionMismatch =\n\t\t\tboardVersion.data != null && klipperVersion != null && boardVersion.data !== klipperVersion ? (\n\t\t\t\t<WarningMessage title=\"Version mismatch\">\n\t\t\t\t\tThe board is running version {boardVersion.data} but you your pi is on version {klipperVersion}. If you want\n\t\t\t\t\tto update your board click 'flash again' below.\n\t\t\t\t</WarningMessage>\n\t\t\t) : null;\n\t\tcontent = (\n\t\t\t<Fragment>\n\t\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t<CheckCircleIcon className=\"relative -top-0.5 inline h-7 w-7 text-brand-700 dark:text-brand-500\" />{' '}\n\t\t\t\t\t{selectedBoard?.name} detected\n\t\t\t\t</h3>\n\t\t\t\t{dfuReminder}\n\t\t\t\t{versionMismatch}\n\t\t\t\t<p>\n\t\t\t\t\tProceed to the next step or{' '}\n\t\t\t\t\t<Button variant=\"indeterminate\" onClick={reflash}>\n\t\t\t\t\t\t<span>Flash again</span> <ArrowPathIcon className=\"inline h-5 w-5\" />\n\t\t\t\t\t</Button>\n\t\t\t\t</p>\n\t\t\t</Fragment>\n\t\t);\n\t} else if (flashStrategy == null) {\n\t\tconst dfuStrategyEnabled = selectedBoard?.dfu != null;\n\t\tconst sdCardStrategyEnabled = !selectedBoard?.isToolboard;\n\t\tconst pathStrategyEnabled = boardDetected.data && selectedBoard?.flashScript != null;\n\t\tconst unidentifiedPathStrategyEnabled = unidentifiedBoards.data?.length;\n\t\tconst dfu = (\n\t\t\t<Button\n\t\t\t\tvariant=\"indeterminate\"\n\t\t\t\tonClick={() => setFlashStrategy('dfu')}\n\t\t\t\tdisabled={!dfuStrategyEnabled}\n\t\t\t\tclassName=\"justify-center\"\n\t\t\t\ttitle={dfuStrategyEnabled ? undefined : 'This board does not support DFU flashing.'}\n\t\t\t>\n\t\t\t\tFlash manually via DFU\n\t\t\t</Button>\n\t\t);\n\t\tconst sdCard = (\n\t\t\t<Button\n\t\t\t\tvariant=\"indeterminate\"\n\t\t\t\tonClick={() => setFlashStrategy('sdcard')}\n\t\t\t\tdisabled={!sdCardStrategyEnabled}\n\t\t\t\tclassName=\"justify-center\"\n\t\t\t\ttitle={sdCardStrategyEnabled ? undefined : 'This board does not support SD card flashing.'}\n\t\t\t>\n\t\t\t\tFlash manually via SD card\n\t\t\t</Button>\n\t\t);\n\t\tconst path = (\n\t\t\t<Button\n\t\t\t\tvariant=\"indeterminate\"\n\t\t\t\tonClick={onFlashViaPath}\n\t\t\t\tdisabled={!pathStrategyEnabled}\n\t\t\t\tclassName=\"justify-center\"\n\t\t\t\ttitle={pathStrategyEnabled ? undefined : 'Board was not detected.'}\n\t\t\t>\n\t\t\t\tFlash automatically\n\t\t\t</Button>\n\t\t);\n\t\tconst unidentifiedPath = (\n\t\t\t<Button\n\t\t\t\tvariant=\"indeterminate\"\n\t\t\t\tclassName=\"justify-center\"\n\t\t\t\tdisabled={!unidentifiedPathStrategyEnabled}\n\t\t\t\ttitle={unidentifiedPathStrategyEnabled ? undefined : 'No unidentified boards detected.'}\n\t\t\t\tdropdownItems={unidentifiedBoards.data?.map((ub) => ({\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tif (selectedBoard == null) return;\n\t\t\t\t\t\tsetFlashStrategy('path');\n\t\t\t\t\t\tsetFlashPath(ub);\n\t\t\t\t\t\tflashViaPath.mutate({ boardPath: selectedBoard.path, flashPath: ub, toolhead: toolhead?.serialize() });\n\t\t\t\t\t},\n\t\t\t\t\ttitle: ub,\n\t\t\t\t}))}\n\t\t\t>\n\t\t\t\tFlash unidentified board\n\t\t\t</Button>\n\t\t);\n\t\tcontent = (\n\t\t\t<Fragment>\n\t\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\tHow do you want to flash your {selectedBoard?.name}?\n\t\t\t\t</h3>\n\t\t\t\t<div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-3\">\n\t\t\t\t\t{path}\n\t\t\t\t\t{dfu}\n\t\t\t\t\t{sdCard}\n\t\t\t\t\t{unidentifiedPath}\n\t\t\t\t</div>\n\t\t\t</Fragment>\n\t\t);\n\t} else {\n\t\tif (selectedBoard == null) {\n\t\t\tcontent = (\n\t\t\t\t<div>\n\t\t\t\t\t<div className=\"prose mt-4 text-base text-red-700\">\n\t\t\t\t\t\tYou have to select a board before navigating to this screen.\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\tswitch (flashStrategy) {\n\t\t\t\tcase 'dfu':\n\t\t\t\t\tcontent = <DFUFlash board={selectedBoard} onSuccess={() => setForceReflash(false)} toolhead={toolhead} />;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sdcard':\n\t\t\t\t\tcontent = (\n\t\t\t\t\t\t<SDCardFlashing board={selectedBoard} onSuccess={() => setForceReflash(false)} toolhead={toolhead} />\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'path':\n\t\t\t\t\tcontent = (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 className=\"text-xl font-medium text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\tFlashing {selectedBoard.name}\n\t\t\t\t\t\t\t\t{flashPath ? ` at ${flashPath}` : ''}...\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<div className=\"prose mt-4 text-base text-zinc-500\">Please wait while RatOS flashes your board.</div>\n\t\t\t\t\t\t\t<MutationStatus {...flashViaPath} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\treturn (\n\t\t<Fragment>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t{' '}\n\t\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">{props.name}</h3>\n\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">{props.description}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"space-y-4 text-zinc-700 dark:text-zinc-300\">\n\t\t\t\t\t{props.children}\n\t\t\t\t\t{content}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<StepNavButtons right={rightButton} left={leftButton} />\n\t\t</Fragment>\n\t);\n};\n","'use client';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { RadioGroup } from '@headlessui/react';\nimport { twJoin } from 'tailwind-merge';\nimport { useAutoAnimate } from '@formkit/auto-animate/react';\nimport { motion } from 'framer-motion';\n\nexport interface SelectableCard {\n\tid: string | number;\n\tname: string;\n\tright?: React.ReactNode | null;\n\tleft?: React.ReactNode | null;\n\tdetails: React.ReactNode | string;\n}\n\ninterface CardSelectorProps<Selectable extends SelectableCard = SelectableCard> {\n\tcards: Selectable[];\n\tonSelect?: (card: Selectable) => void;\n\tvalue?: Selectable | null;\n\ttitle?: (card: Selectable) => React.ReactNode;\n}\n\nexport const CardSelector = <Selectable extends SelectableCard = SelectableCard>(\n\tprops: CardSelectorProps<Selectable>,\n) => {\n\tconst [selected, setSelected] = useState<Selectable | null>(null);\n\tconst { onSelect: _onSelect } = props;\n\n\tconst onSelect = useCallback(\n\t\t(card: Selectable) => {\n\t\t\tif (props.value === undefined) {\n\t\t\t\tsetSelected(card);\n\t\t\t}\n\t\t\t_onSelect?.(card);\n\t\t},\n\t\t[_onSelect, props.value],\n\t);\n\n\tuseEffect(() => {\n\t\tif (props.value !== undefined) {\n\t\t\tsetSelected(props.value);\n\t\t}\n\t}, [props.value]);\n\n\treturn (\n\t\t<RadioGroup value={selected} onChange={onSelect}>\n\t\t\t<RadioGroup.Label className=\"sr-only\">Selector</RadioGroup.Label>\n\t\t\t<motion.div className=\"space-y-4\">\n\t\t\t\t{props.cards.map((card, i) => (\n\t\t\t\t\t<RadioGroup.Option\n\t\t\t\t\t\tkey={card.id}\n\t\t\t\t\t\tvalue={card}\n\t\t\t\t\t\tclassName={({ checked, active }) =>\n\t\t\t\t\t\t\ttwJoin(\n\t\t\t\t\t\t\t\tchecked ? 'border-transparent' : 'border-zinc-300 dark:border-zinc-700',\n\t\t\t\t\t\t\t\tactive ? 'ring-2 ring-brand-600' : '',\n\t\t\t\t\t\t\t\t'relative flex cursor-pointer items-center justify-between rounded-lg border bg-white px-4 py-4 shadow-sm focus:outline-none dark:bg-zinc-900',\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t{({ active, checked }) => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{card.left && (\n\t\t\t\t\t\t\t\t\t<RadioGroup.Description as=\"div\" className=\"mr-4 mt-2 flex text-sm sm:mt-0 sm:block sm:text-left\">\n\t\t\t\t\t\t\t\t\t\t{card.left}\n\t\t\t\t\t\t\t\t\t</RadioGroup.Description>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t\t\t\t<RadioGroup.Label\n\t\t\t\t\t\t\t\t\t\tas=\"p\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"mb-1 flex items-center space-x-2 text-sm font-bold text-zinc-900 dark:text-zinc-100\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{props.title ? props.title(card) : card.name}\n\t\t\t\t\t\t\t\t\t</RadioGroup.Label>\n\t\t\t\t\t\t\t\t\t<RadioGroup.Description as=\"div\" className=\"text-xs text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"sm:inline\">{card.details}</div>\n\t\t\t\t\t\t\t\t\t</RadioGroup.Description>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{card.right && (\n\t\t\t\t\t\t\t\t\t<RadioGroup.Description as=\"div\" className=\"ml-4 mt-2 flex text-sm sm:mt-0 sm:block sm:text-right\">\n\t\t\t\t\t\t\t\t\t\t{card.right}\n\t\t\t\t\t\t\t\t\t</RadioGroup.Description>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\tactive ? 'border' : 'border-2',\n\t\t\t\t\t\t\t\t\t\tchecked ? 'border-brand-600' : 'border-transparent',\n\t\t\t\t\t\t\t\t\t\t'pointer-events-none absolute -inset-px rounded-lg',\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</RadioGroup.Option>\n\t\t\t\t))}\n\t\t\t</motion.div>\n\t\t</RadioGroup>\n\t);\n};\n","import React, { Fragment, useCallback } from 'react';\nimport { CardSelector } from '@/components/card-selector';\nimport { StepNavButton, StepNavButtons } from '@/components/step-nav-buttons';\nimport { MCUStepScreenProps, SelectableBoard } from '@/components/setup-steps/mcu-preparation';\nimport { Button } from '@/components/common/button';\nimport { Badge } from '@/components/common/badge';\nimport { BoardWithDetectionStatus } from '@/zods/boards';\nimport { PrinterAxis } from '@/zods/motion';\nimport { AnimatedContainer } from '@/components/common/animated-container';\n\nexport const MCUPicker: React.FC<MCUStepScreenProps> = (props) => {\n\tconst { toolhead, skipSteps, setSelectedBoard, selectedControlboard, selectedToolboard, selectedPrinter, cards } =\n\t\tprops;\n\n\t// TODO: This should be determined on the basis of defined board drivers / heaters (check pins), whether it has an extruderless config and how many drivers and which axes the printer requires.\n\tconst isToolboardRequired = useCallback(\n\t\t(controlboard: BoardWithDetectionStatus | null = selectedControlboard) => {\n\t\t\treturn selectedPrinter != null && (controlboard?.driverCount ?? 0) < selectedPrinter.driverCountRequired;\n\t\t},\n\t\t[selectedControlboard, selectedPrinter],\n\t);\n\n\tconst isBoardDetected = toolhead ? selectedToolboard?.detected : selectedControlboard?.detected;\n\n\tlet content = (\n\t\t<CardSelector<SelectableBoard>\n\t\t\tcards={cards}\n\t\t\tvalue={cards.find((c) => c.id === (toolhead ? selectedToolboard : selectedControlboard)?.id)}\n\t\t\tonSelect={setSelectedBoard}\n\t\t\ttitle={(card) => (\n\t\t\t\t<>\n\t\t\t\t\t<span>{card.name}</span>\n\t\t\t\t\t{card.board.detected && (\n\t\t\t\t\t\t<Badge color=\"green\" size=\"sm\">\n\t\t\t\t\t\t\tDetected\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t)}\n\t\t\t\t\t{!toolhead && isToolboardRequired(card.board) && (\n\t\t\t\t\t\t<Badge color=\"yellow\" size=\"sm\">\n\t\t\t\t\t\t\tToolboard required\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t)}\n\t\t/>\n\t);\n\n\tlet rightButton: StepNavButton = {\n\t\tonClick: props.nextScreen,\n\t\tlabel: 'Next',\n\t\tdisabled: true,\n\t};\n\tlet leftButton: StepNavButton = {\n\t\tonClick: props.previousScreen,\n\t};\n\n\tconst skip = useCallback(() => {\n\t\tskipSteps?.();\n\t}, [skipSteps]);\n\n\tlet skipButton: StepNavButton | undefined =\n\t\t((toolhead && !isToolboardRequired()) || isBoardDetected) && skipSteps && skip\n\t\t\t? {\n\t\t\t\t\tonClick: skip,\n\t\t\t\t\tlabel: 'Skip',\n\t\t\t\t}\n\t\t\t: undefined;\n\n\tif (\n\t\t(toolhead && (!isToolboardRequired() || selectedToolboard != null)) ||\n\t\t(!toolhead && selectedControlboard != null)\n\t) {\n\t\trightButton = {\n\t\t\tonClick: props.nextScreen,\n\t\t\tlabel: 'Next',\n\t\t};\n\t}\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t{' '}\n\t\t\t\t<div className=\"mb-5 flex border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">{props.name}</h3>\n\t\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">{props.description}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{toolhead && toolhead.getMotionAxis() === PrinterAxis.x && selectedToolboard != null && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Button onClick={() => setSelectedBoard(null)} variant=\"danger\">\n\t\t\t\t\t\t\t\tClear selection\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<AnimatedContainer>\n\t\t\t\t\t{props.children}\n\t\t\t\t\t{content}\n\t\t\t\t</AnimatedContainer>\n\t\t\t</div>\n\t\t\t<StepNavButtons right={rightButton} left={leftButton} skip={skipButton} />\n\t\t</Fragment>\n\t);\n};\n","import React, { useCallback, useMemo } from 'react';\nimport { trpc } from '@/helpers/trpc';\nimport { usePrinterConfiguration } from '@/hooks/usePrinterConfiguration';\nimport { StepScreen, StepScreenProps, useSteps } from '@/hooks/useSteps';\nimport { Board, BoardWithDetectionStatus, Toolboard } from '@/zods/boards';\nimport { SelectableCard } from '@/components/card-selector';\nimport { QueryStatus } from '@/components/common/query-status';\nimport { MCUFlashing } from '@/components/setup-steps/mcu/flash';\nimport { MCUPicker } from '@/components/setup-steps/mcu/pick';\nimport { PrinterDefinitionWithResolvedToolheads } from '@/zods/printer';\nimport { ToolOrAxis } from '@/zods/toolhead';\nimport { ToolheadHelper } from '@/helpers/toolhead';\nimport { useToolheadConfiguration } from '@/hooks/useToolheadConfiguration';\nimport { Cpu } from 'lucide-react';\n\nexport interface SelectableBoard extends SelectableCard {\n\tboard: BoardWithDetectionStatus;\n}\n\ninterface ExtraStepProps {\n\tselectedControlboard: BoardWithDetectionStatus | null;\n\tselectedToolboard: BoardWithDetectionStatus | null;\n\tcards: SelectableBoard[];\n\tsetSelectedBoard: (board: SelectableBoard | null) => void;\n\tselectedPrinter: PrinterDefinitionWithResolvedToolheads | null;\n\ttoolhead: ToolheadHelper<any> | null;\n}\n\ninterface ExtraProps {\n\ttoolOrAxis?: ToolOrAxis;\n}\n\nexport type MCUStepScreenProps = StepScreenProps & ExtraStepProps;\n\nconst MCUSteps: StepScreen<ExtraStepProps>[] = [\n\t{\n\t\tid: '01',\n\t\tname: (screenProps) =>\n\t\t\t`Pick ${screenProps.toolhead ? `${screenProps.toolhead.getToolCommand()} Toolboard` : 'Control board'}`,\n\t\tdescription: (screenProps) =>\n\t\t\t`Pick the ${\n\t\t\t\tscreenProps.toolhead\n\t\t\t\t\t? `toolboard for ${screenProps.toolhead.getDescription()}.`\n\t\t\t\t\t: 'control board. Toolboard(s) can be added in a later step.'\n\t\t\t}`,\n\t\thref: '#',\n\t\trenderScreen: (screenProps) => <MCUPicker {...screenProps} key={screenProps.key} />,\n\t},\n\t{\n\t\tid: '02',\n\t\tname: (screenProps) =>\n\t\t\t`${screenProps.toolhead ? `${screenProps.toolhead.getToolCommand()} Toolboard` : 'Control board'} flashing`,\n\t\tdescription: (screenProps) =>\n\t\t\t`Make sure your ${\n\t\t\t\tscreenProps.toolhead ? `toolboard for ${screenProps.toolhead.getDescription()}` : 'control board'\n\t\t\t} is flashed and up to date.`,\n\t\thref: '#',\n\t\trenderScreen: (screenProps) => <MCUFlashing {...screenProps} key={screenProps.key} />,\n\t},\n];\n\nexport const MCUPreparation: React.FC<StepScreenProps & ExtraProps> = (props) => {\n\tconst {\n\t\tselectedPrinter,\n\t\tselectedBoard: _controlBoard,\n\t\tsetSelectedBoard: _setControlboard,\n\t} = usePrinterConfiguration();\n\tconst { toolhead, setToolhead } = useToolheadConfiguration(props.toolOrAxis, false);\n\n\tconst boardsQuery = trpc.mcu.boards.useQuery(\n\t\t{\n\t\t\tboardFilters: {\n\t\t\t\tdriverCountRequired:\n\t\t\t\t\ttoolhead != null\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: (selectedPrinter?.driverCountRequired ?? 0) - (selectedPrinter?.defaults.toolheads.length ?? 1),\n\t\t\t},\n\t\t\ttoolhead: toolhead?.serialize(),\n\t\t},\n\t\t{ keepPreviousData: true },\n\t);\n\n\tconst cards: SelectableBoard[] = useMemo(() => {\n\t\tif (boardsQuery.isError || boardsQuery.data == null) return [];\n\t\treturn boardsQuery.data\n\t\t\t.filter((b) => b.isToolboard == (toolhead != null ? true : null))\n\t\t\t.map((b) => ({\n\t\t\t\tid: b.id,\n\t\t\t\tboard: b,\n\t\t\t\tname: `${b.manufacturer} ${b.name}`,\n\t\t\t\tdetails: (\n\t\t\t\t\t<span>\n\t\t\t\t\t\t<span className=\"font-semibold\">Automatic flashing:</span>{' '}\n\t\t\t\t\t\t{b.flashScript && !b.disableAutoFlash ? 'Yes' : 'No'}\n\t\t\t\t\t</span>\n\t\t\t\t),\n\t\t\t\tright: <Cpu className=\"h-8 w-8 text-zinc-500\" />,\n\t\t\t}));\n\t}, [boardsQuery.isError, boardsQuery.data, toolhead]);\n\n\tconst selectedControlboard = boardsQuery.data?.find((c) => c.id == _controlBoard?.id) ?? null;\n\tconst selectedToolboard = boardsQuery.data?.find((c) => c.id == toolhead?.getToolboard()?.id) ?? null;\n\n\tconst setSelectedBoard = useCallback(\n\t\t(newBoard: SelectableBoard | null) => {\n\t\t\tif (toolhead) {\n\t\t\t\tsetToolhead({\n\t\t\t\t\t...toolhead.getConfig(),\n\t\t\t\t\ttoolboard: newBoard == null ? null : Toolboard.parse(newBoard.board),\n\t\t\t\t});\n\t\t\t} else if (newBoard != null) {\n\t\t\t\t_setControlboard(Board.parse(newBoard.board));\n\t\t\t}\n\t\t},\n\t\t[_setControlboard, setToolhead, toolhead],\n\t);\n\n\tconst extraScreenProps: ExtraStepProps = {\n\t\tselectedControlboard,\n\t\tselectedToolboard,\n\t\tcards,\n\t\tsetSelectedBoard,\n\t\tselectedPrinter,\n\t\ttoolhead,\n\t};\n\tconst { currentStep, screenProps } = useSteps<ExtraStepProps>({\n\t\tsteps: MCUSteps,\n\t\tparentScreenProps: props,\n\t\textraScreenProps: extraScreenProps,\n\t});\n\n\treturn currentStep.renderScreen({\n\t\t...screenProps,\n\t\t...extraScreenProps,\n\t\tchildren: <QueryStatus {...boardsQuery} />,\n\t});\n};\n","'use client';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { RadioGroup } from '@headlessui/react';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport { badgeBackgroundColorStyle, badgeBorderColorStyle, badgeTextColorStyle } from '@/components/common/badge';\nimport { useAutoAnimate } from '@formkit/auto-animate/react';\n\nexport interface SelectableOption {\n\tname: string;\n\tid: string | number;\n}\n\nexport interface SelectableCardWithOptions<Option extends SelectableOption = SelectableOption> {\n\tid: string | number;\n\tname: string;\n\tright: JSX.Element | null;\n\tdetails: JSX.Element | string;\n\toptions?: Option[];\n}\n\nexport type SelectedCard<Selectable> = Selectable;\n\ninterface CardSelectorProps<\n\tOption extends SelectableOption = SelectableOption,\n\tSelectable extends SelectableCardWithOptions<Option> = SelectableCardWithOptions<Option>,\n> {\n\tcards: Selectable[];\n\tonSelect?: (card: SelectedCard<Selectable>, option: Option | null) => void;\n\tvalue?: SelectedCard<Selectable> | null;\n\toptionValue?: Option | null;\n}\n\nexport const CardSelectorWithOptions = <\n\tOption extends SelectableOption = SelectableOption,\n\tSelectable extends SelectableCardWithOptions<Option> = SelectableCardWithOptions<Option>,\n>(\n\tprops: CardSelectorProps<Option, Selectable>,\n) => {\n\tconst [selected, setSelected] = useState<SelectedCard<Selectable> | null>(null);\n\tconst [selectedOption, setSelectedOption] = useState<Option | null>(null);\n\tconst selectedRef = useRef({ selected, selectedOption });\n\tconst { onSelect: _onSelect } = props;\n\tconst [parent] = useAutoAnimate();\n\n\tconst onSelect = useCallback(\n\t\t(card: Selectable) => {\n\t\t\t// Do not select the same card twice, since onSelectOption might have been called first.\n\t\t\tif (selectedRef.current.selected !== card) {\n\t\t\t\tif (props.value === undefined) {\n\t\t\t\t\tsetSelected(card);\n\t\t\t\t\tif (props.optionValue === undefined) {\n\t\t\t\t\t\tsetSelectedOption(card.options?.[0] ?? null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tselectedRef.current.selected = card;\n\t\t\t\tselectedRef.current.selectedOption = card.options?.[0] ?? null;\n\t\t\t\t_onSelect?.(card, card.options?.[0] ?? null);\n\t\t\t}\n\t\t},\n\t\t[_onSelect, props.value, props.optionValue],\n\t);\n\n\tconst onSelectOption = useCallback(\n\t\t(card: Selectable, option: Option | null) => {\n\t\t\tif (props.value === undefined) {\n\t\t\t\tsetSelected(card);\n\t\t\t\tsetSelectedOption(option);\n\t\t\t}\n\t\t\tselectedRef.current.selected = card;\n\t\t\tselectedRef.current.selectedOption = option;\n\t\t\t_onSelect?.(card, option);\n\t\t},\n\t\t[_onSelect, props.value],\n\t);\n\n\tuseEffect(() => {\n\t\tif (props.value !== undefined && props.value !== selectedRef.current.selected) {\n\t\t\tsetSelected(props.value);\n\t\t}\n\t\tif (props.optionValue !== undefined && props.optionValue !== selectedRef.current.selectedOption) {\n\t\t\tsetSelectedOption(props.optionValue);\n\t\t}\n\t}, [props.value, props.optionValue]);\n\n\treturn (\n\t\t<RadioGroup value={selected} onChange={onSelect}>\n\t\t\t<RadioGroup.Label className=\"sr-only\">Selector</RadioGroup.Label>\n\t\t\t<div className=\"space-y-4\" ref={parent}>\n\t\t\t\t{props.cards.map((card, i) => (\n\t\t\t\t\t<RadioGroup.Option\n\t\t\t\t\t\tkey={card.id}\n\t\t\t\t\t\tvalue={card}\n\t\t\t\t\t\tclassName={({ checked, active }) =>\n\t\t\t\t\t\t\ttwJoin(\n\t\t\t\t\t\t\t\tchecked ? 'border-transparent' : 'border-zinc-300 dark:border-zinc-700',\n\t\t\t\t\t\t\t\tactive ? 'ring-2 ring-brand-600 dark:ring-brand-500' : '',\n\t\t\t\t\t\t\t\t'relative cursor-pointer rounded-lg border bg-white px-4 py-4 shadow-sm focus:outline-none dark:bg-zinc-800',\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t{({ active, checked }) => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t<RadioGroup.Label as=\"p\" className=\"text-sm font-bold text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t{card.name}\n\t\t\t\t\t\t\t\t\t\t</RadioGroup.Label>\n\t\t\t\t\t\t\t\t\t\t<RadioGroup.Description as=\"div\" className=\"text-xs text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:inline\">{card.details}</div>\n\t\t\t\t\t\t\t\t\t\t</RadioGroup.Description>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<RadioGroup.Description as=\"div\" className=\"mb-2 ml-4 flex text-sm sm:block sm:text-right\">\n\t\t\t\t\t\t\t\t\t\t{card.right}\n\t\t\t\t\t\t\t\t\t</RadioGroup.Description>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{card.options != null && (\n\t\t\t\t\t\t\t\t\t<RadioGroup\n\t\t\t\t\t\t\t\t\t\tvalue={selected?.id === card.id ? selectedOption : null}\n\t\t\t\t\t\t\t\t\t\tonChange={(option: Option) => onSelectOption(card, option)}\n\t\t\t\t\t\t\t\t\t\tclassName=\"mt-2\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<RadioGroup.Label className=\"sr-only\"> Choose a memory option </RadioGroup.Label>\n\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 gap-3 sm:grid-cols-6\">\n\t\t\t\t\t\t\t\t\t\t\t{card.options.map((option) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<RadioGroup.Option\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={option.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={option}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={({ active, checked }) =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttwMerge(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tactive || checked ? 'ring-2' : 'ring-1',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'flex items-center justify-center rounded-md px-3 py-3 text-sm font-semibold uppercase ring-inset sm:flex-1',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbadgeBackgroundColorStyle({ color: checked ? 'brand' : 'gray' }),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbadgeBorderColorStyle({ color: active || checked ? 'brand' : 'gray' }),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbadgeTextColorStyle({ color: active || checked ? 'brand' : 'gray' }),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<RadioGroup.Label as=\"span\">{option.name}</RadioGroup.Label>\n\t\t\t\t\t\t\t\t\t\t\t\t</RadioGroup.Option>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</RadioGroup>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\tactive ? 'border' : 'border-2',\n\t\t\t\t\t\t\t\t\t\tchecked ? 'border-brand-600' : 'border-transparent',\n\t\t\t\t\t\t\t\t\t\t'pointer-events-none absolute -inset-px rounded-lg',\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</RadioGroup.Option>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</RadioGroup>\n\t);\n};\n","import { ErrorMessage } from '@/components/common/error-message';\nimport { Spinner } from '@/components/common/spinner';\nimport React from 'react';\nimport { AnimatedContainer } from '@/components/common/animated-container';\n\nexport const ShowWhenReady: React.FC<\n\tReact.PropsWithChildren<{ queryErrors: string[]; isReady: boolean; showErrors?: boolean }>\n> = (props) => {\n\tif (props.queryErrors.length > 0 && props.showErrors) {\n\t\treturn (\n\t\t\t<ErrorMessage className=\"mb-4\">\n\t\t\t\t{props.queryErrors.map((e) => (\n\t\t\t\t\t<div className=\"mt-2\" key={e}>\n\t\t\t\t\t\t{e}\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</ErrorMessage>\n\t\t);\n\t}\n\tif (!props.isReady && props.queryErrors.length === 0) {\n\t\treturn (\n\t\t\t<div className=\"flex min-h-12 flex-1 items-center justify-center\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t);\n\t}\n\treturn <AnimatedContainer>{props.children as React.ReactElement}</AnimatedContainer>;\n};\n","'use client';\nimport React from 'react';\nimport Image from 'next/image';\nimport { StepNavButtons } from '@/components/step-nav-buttons';\nimport { StepScreenProps } from '@/hooks/useSteps';\nimport {\n\tCardSelectorWithOptions,\n\tSelectableCardWithOptions,\n\tSelectableOption,\n\tSelectedCard,\n} from '@/components/card-selector-with-options';\nimport { trpc } from '@/helpers/trpc';\nimport { ShowWhenReady } from '@/components/common/show-when-ready';\nimport { useAutoAnimate } from '@formkit/auto-animate/react';\nimport { useRecoilValue, useRecoilCallback } from 'recoil';\nimport {\n\tPrinterSizeState,\n\tPrinterState,\n\tLoadablePrinterState,\n\tPrinterRailsState,\n\tControlboardState,\n} from '@/recoil/printer';\nimport { PrinterDefinitionWithResolvedToolheads } from '@/zods/printer';\nimport { PrinterToolheadState, PrinterToolheadsState } from '@/recoil/toolhead';\nimport { ToolheadHelper } from '@/helpers/toolhead';\nimport {\n\tControllerFanState,\n\tPerformanceModeState,\n\tStandstillStealthState,\n\tStealthchopState,\n} from '@/hooks/usePrinterConfiguration';\nimport { AnimatedContainer } from '@/components/common/animated-container';\n\ninterface SelectablePrinter<Option extends SelectableOption = SelectableOption>\n\textends SelectableCardWithOptions<Option> {\n\tprinter: PrinterDefinitionWithResolvedToolheads;\n}\n\nexport const PrinterSelection: React.FC<StepScreenProps> = (props) => {\n\tconst printerQuery = trpc.printer.printers.useQuery();\n\tconst boardQuery = trpc.mcu.boards.useQuery({});\n\tconst selectedPrinter = useRecoilValue(LoadablePrinterState);\n\tconst selectedPrinterOption = useRecoilValue(PrinterSizeState);\n\n\tconst cards = printerQuery.data\n\t\t? (printerQuery.data\n\t\t\t\t.slice()\n\t\t\t\t.sort((a, b) =>\n\t\t\t\t\ta.manufacturer === 'Rat Rig' && (b.manufacturer !== 'Rat Rig' || b.description.indexOf('Discontinued') > -1)\n\t\t\t\t\t\t? -1\n\t\t\t\t\t\t: a.name.localeCompare(b.name),\n\t\t\t\t)\n\t\t\t\t.map((p) => {\n\t\t\t\t\tconst printerImgUri = 'printerId=' + encodeURIComponent(p.id);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: p.id,\n\t\t\t\t\t\tname: `${p.manufacturer} ${p.name}`,\n\t\t\t\t\t\tdetails: p.description,\n\t\t\t\t\t\tprinter: p,\n\t\t\t\t\t\tright: (\n\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\tsrc={'/configure/api/printer-image?' + printerImgUri}\n\t\t\t\t\t\t\t\twidth={50}\n\t\t\t\t\t\t\t\tclassName=\"rounded-lg bg-white p-1 shadow-md dark:shadow-zinc-900\"\n\t\t\t\t\t\t\t\theight={50}\n\t\t\t\t\t\t\t\talt={`${p.manufacturer} ${p.name}`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t),\n\t\t\t\t\t\toptions:\n\t\t\t\t\t\t\tObject.values(p.sizes).length > 1\n\t\t\t\t\t\t\t\t? Object.entries(p.sizes).map(([key, volume]) => ({ id: key, name: key + '', volume }))\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t};\n\t\t\t\t}) satisfies SelectablePrinter[])\n\t\t: [];\n\n\tconst selectedCard = cards.find((c) => c.id === selectedPrinter?.id);\n\tconst selectedPrinterOptionFromCard = selectedCard?.options?.find((o) => {\n\t\tif (typeof selectedPrinterOption !== 'string' && typeof selectedPrinterOption !== 'number') {\n\t\t\treturn (\n\t\t\t\tselectedPrinterOption?.x === o.volume.x &&\n\t\t\t\tselectedPrinterOption?.y === o.volume.y &&\n\t\t\t\tselectedPrinterOption?.z === o.volume.z\n\t\t\t);\n\t\t}\n\t\treturn o.id === selectedPrinterOption;\n\t});\n\n\tconst onSelectPrinter = useRecoilCallback(\n\t\t({ set, reset, snapshot }) =>\n\t\t\tasync (card: SelectedCard<Unpacked<typeof cards>>, option: SelectableOption | null) => {\n\t\t\t\tconst printer = card.printer;\n\t\t\t\tif (printer == null) {\n\t\t\t\t\tconsole.error('No printer found matching the criteria');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst oldToolheads = await snapshot.getPromise(PrinterToolheadsState);\n\t\t\t\tconst oldControllerBoard = await snapshot.getPromise(ControlboardState);\n\t\t\t\toldToolheads.forEach((th) => {\n\t\t\t\t\treset(PrinterToolheadState(th.toolNumber));\n\t\t\t\t});\n\t\t\t\tset(PrinterState, printer);\n\t\t\t\tif (Object.values(printer.sizes).length > 1) {\n\t\t\t\t\tif (option == null || typeof option.id !== 'string') {\n\t\t\t\t\t\tthrow new Error('An option must be selected for printers that come in different size configurations');\n\t\t\t\t\t}\n\t\t\t\t\tset(PrinterSizeState, printer.sizes[option.id]);\n\t\t\t\t} else {\n\t\t\t\t\tset(PrinterSizeState, printer.sizes[Object.keys(printer.sizes)[0]]);\n\t\t\t\t}\n\t\t\t\tset(\n\t\t\t\t\tPrinterToolheadsState,\n\t\t\t\t\tprinter.defaults.toolheads.map((th) => ({ ...th, toolNumber: new ToolheadHelper(th).getTool() })),\n\t\t\t\t);\n\t\t\t\treset(PerformanceModeState);\n\t\t\t\treset(StealthchopState);\n\t\t\t\treset(StandstillStealthState);\n\t\t\t\treset(ControllerFanState);\n\t\t\t\treset(PrinterRailsState);\n\t\t\t\tconst defaultBoard = boardQuery.data?.find((b) => b.id === printer.defaults.board);\n\t\t\t\tif (oldControllerBoard == null && defaultBoard != null) {\n\t\t\t\t\tset(ControlboardState, defaultBoard);\n\t\t\t\t}\n\t\t\t\tif (printer.defaults.controllerFan) {\n\t\t\t\t\tset(ControllerFanState, { id: printer.defaults.controllerFan, title: printer.defaults.controllerFan });\n\t\t\t\t} else {\n\t\t\t\t\treset(ControllerFanState);\n\t\t\t\t}\n\t\t\t},\n\t\t[printerQuery.data],\n\t);\n\n\tconst errors = printerQuery.error ? [printerQuery.error?.message] : [];\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Select your printer</h3>\n\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\tThis will determine the template used for printer.cfg\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<ShowWhenReady isReady={printerQuery.isFetched} queryErrors={errors}>\n\t\t\t\t\t<CardSelectorWithOptions\n\t\t\t\t\t\tcards={cards}\n\t\t\t\t\t\tonSelect={onSelectPrinter}\n\t\t\t\t\t\tvalue={selectedCard}\n\t\t\t\t\t\toptionValue={selectedPrinterOptionFromCard}\n\t\t\t\t\t/>\n\t\t\t\t</ShowWhenReady>\n\t\t\t</div>\n\t\t\t<StepNavButtons\n\t\t\t\tleft={{ onClick: props.previousScreen }}\n\t\t\t\tright={{\n\t\t\t\t\tonClick: props.nextScreen,\n\t\t\t\t\tdisabled: selectedPrinter == null,\n\t\t\t\t\ttitle: selectedPrinter == null ? 'You have to select a printer' : undefined,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</>\n\t);\n};\n","import { Signal, SignalHigh, SignalLow, SignalMedium, SignalZero } from 'lucide-react';\nimport { twMerge } from 'tailwind-merge';\n\nexport const parseSignal = (dBm: number) => {\n\tif (dBm >= -40) {\n\t\treturn <span className=\"font-semibold text-green-700\">Excellent</span>;\n\t}\n\tif (dBm >= -67) {\n\t\treturn <span className=\"font-semibold text-lime-600\">Very good</span>;\n\t}\n\tif (dBm >= -70) {\n\t\treturn <span className=\"font-semibold text-yellow-600\">Okay</span>;\n\t}\n\tif (dBm >= -80) {\n\t\treturn <span className=\"font-semibold text-orange-500\">Not good</span>;\n\t}\n\tif (dBm >= -100) {\n\t\treturn <span className=\"font-semibold text-red-600\">Unusable</span>;\n\t}\n};\n\nexport const signalIcon = (dBm: number, className?: string) => {\n\tlet icon = <></>;\n\tif (dBm >= -100) {\n\t\ticon = <SignalZero className=\"absolute inset-0 h-full w-full text-red-600\" />;\n\t}\n\tif (dBm >= -80) {\n\t\ticon = <SignalLow className=\"absolute inset-0 h-full w-full text-orange-500\" />;\n\t}\n\tif (dBm >= -70) {\n\t\ticon = <SignalMedium className=\"absolute inset-0 h-full w-full text-yellow-600\" />;\n\t}\n\tif (dBm >= -67) {\n\t\ticon = <SignalHigh className=\"absolute inset-0 h-full w-full text-lime-600\" />;\n\t}\n\tif (dBm >= -40) {\n\t\ticon = <Signal className=\"absolute inset-0 h-full w-full text-green-700\" />;\n\t}\n\treturn (\n\t\t<div className={twMerge('relative inline-block h-8 w-8', className)}>\n\t\t\t<Signal className=\"absolute inset-0 h-full w-full text-zinc-700\" />\n\t\t\t{icon}\n\t\t</div>\n\t);\n};\n","import { z } from 'zod';\n\nexport const hostnameInput = z.object({\n\thostname: z\n\t\t.string()\n\t\t.min(2)\n\t\t.regex(/^([a-zA-Z0-9]|-)+$/, 'Hostname can only include a-Z, 0-9 and dashes.'),\n});\n\nexport const joinInput = z.object({\n\tssid: z.string().min(1).max(32),\n\tpassphrase: z.string().min(8).max(63),\n\tfrequencies: z.string(),\n\tcountry: z.string().optional(),\n\thidden: z.boolean().optional(),\n});\n","'use client';\nimport React, { Fragment, useCallback, useEffect, useMemo, useState } from 'react';\nimport { CardSelector, SelectableCard } from '@/components/card-selector';\nimport { Spinner } from '@/components/common/spinner';\nimport { ErrorMessage } from '@/components/common/error-message';\nimport { WifiIcon } from '@heroicons/react/24/solid';\nimport { TextInput } from '@/components/forms/text-input';\nimport { StepNavButton, StepNavButtons } from '@/components/step-nav-buttons';\nimport type { Network } from '@/server/helpers/iw';\nimport { Modal } from '@/components/common/modal';\nimport { parseSignal, signalIcon } from '@/helpers/wifi';\nimport { StepScreenProps } from '@/hooks/useSteps';\nimport { trpc } from '@/helpers/trpc';\nimport { hostnameInput, joinInput } from '@/helpers/validators/wifi';\nimport { Button } from '@/components/common/button';\nimport { Eye, EyeOff } from 'lucide-react';\nimport { InfoMessage } from '@/components/common/info-message';\nimport { MutationStatus } from '@/components/common/mutation-status';\n\ninterface APList {\n\t[id: string]: Network;\n}\n\ninterface SelectableNetwork extends SelectableCard {\n\tid: string;\n}\n\nexport const WifiSetup: React.FC<StepScreenProps> = (props) => {\n\tconst [apList, setApList] = useState<APList>({});\n\tconst [selectedNetwork, setSelectedNetwork] = useState<null | Network>(null);\n\tconst [password, setPassword] = useState('');\n\tconst [hostname, setHostname] = useState('RatOS');\n\tconst [hostnameCompleted, setHostnameCompleted] = useState(false);\n\tconst [showHidden, setShowHidden] = useState(true);\n\tconst [overrideSSID, setOverrideSSID] = useState<string | null>(null);\n\n\tconst { isError, error, data } = trpc.wifi.scan.useQuery(\n\t\t{ showHidden },\n\t\t{\n\t\t\trefetchInterval: (data, query) => {\n\t\t\t\tif (query.state.error) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn 1000;\n\t\t\t},\n\t\t\tretry: false,\n\t\t},\n\t);\n\tconst hostnameMutation = trpc.wifi.hostname.useMutation();\n\tconst wifiMutation = trpc.wifi.join.useMutation();\n\n\tuseEffect(() => {\n\t\tsetApList((apList) => {\n\t\t\tconst newList = {\n\t\t\t\t...apList,\n\t\t\t};\n\t\t\tdata?.forEach((ap) => {\n\t\t\t\tnewList[ap.address] = ap;\n\t\t\t});\n\t\t\treturn newList;\n\t\t});\n\t}, [data]);\n\n\t// Find all frequencies for SSID that are near the selected one.\n\tconst frequencies = useMemo(\n\t\t() =>\n\t\t\tObject.values(apList)\n\t\t\t\t.filter(\n\t\t\t\t\t(ap) =>\n\t\t\t\t\t\tselectedNetwork != null &&\n\t\t\t\t\t\tap.ssid === selectedNetwork.ssid &&\n\t\t\t\t\t\tMath.abs(ap.frequency - selectedNetwork?.frequency) < 1000,\n\t\t\t\t)\n\t\t\t\t.map((ap) => ap.frequency)\n\t\t\t\t.join(' '),\n\t\t[apList, selectedNetwork],\n\t);\n\tconst hostnameValidation = hostnameInput.safeParse({ hostname });\n\tconst passwordValidation = joinInput.safeParse({\n\t\tpassphrase: password,\n\t\tssid: selectedNetwork?.ssid ?? overrideSSID,\n\t\tcountry: selectedNetwork?.country,\n\t\tfrequencies,\n\t\thidden: selectedNetwork?.ssid == null,\n\t});\n\n\tconst cards: SelectableNetwork[] = useMemo(() => {\n\t\tif (isError) return [];\n\t\treturn Object.keys(apList)\n\t\t\t.filter((ap) => apList[ap].ssid != null || showHidden)\n\t\t\t.map((ap) => ({\n\t\t\t\tname: apList[ap].ssid ?? 'Hidden SSID',\n\t\t\t\tid: ap,\n\t\t\t\tdetails: (\n\t\t\t\t\t<div className=\"gap-4 md:grid md:grid-cols-2\">\n\t\t\t\t\t\t<div className=\"md:col-span-1\">\n\t\t\t\t\t\t\t<span className=\"font-semibold\">Signal Strength:</span> {parseSignal(apList[ap].signal)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"md:col-span-1\">\n\t\t\t\t\t\t\t<span className=\"font-semibold\">Frequency:</span> {Math.round(apList[ap].frequency / 100) / 10}GHz\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t),\n\t\t\t\tright: signalIcon(apList[ap].signal),\n\t\t\t}))\n\t\t\t.sort((a, b) => {\n\t\t\t\tif (apList[a.id].signal > apList[b.id].signal) return -1;\n\t\t\t\tif (apList[a.id].signal < apList[b.id].signal) return 1;\n\t\t\t\treturn 0;\n\t\t\t});\n\t}, [isError, apList, showHidden]);\n\n\tconst onSelectCard = useCallback(\n\t\t(card: SelectableNetwork) => {\n\t\t\tsetSelectedNetwork(apList[card.id]);\n\t\t},\n\t\t[apList],\n\t);\n\n\tconst connectToWifi = useCallback(() => {\n\t\tif (selectedNetwork == null) {\n\t\t\tthrow new Error('Cannot join wifi without selecting a network');\n\t\t}\n\n\t\tif (passwordValidation.success) {\n\t\t\twifiMutation.mutate(passwordValidation.data);\n\t\t}\n\t}, [passwordValidation, selectedNetwork, wifiMutation]);\n\n\tconst rebootMutation = trpc.reboot.useMutation();\n\n\tconst rebootAndClose = useCallback(async () => {\n\t\tawait rebootMutation.mutateAsync();\n\t\twindow.close();\n\t}, [rebootMutation]);\n\n\tconst confirmHostname = useCallback(async () => {\n\t\tawait hostnameMutation.mutateAsync({ hostname });\n\t\tsetHostnameCompleted(true);\n\t}, [hostnameMutation, hostname]);\n\n\tconst content =\n\t\tselectedNetwork &&\n\t\twifiMutation.isSuccess &&\n\t\thostnameCompleted &&\n\t\t!rebootMutation.isSuccess &&\n\t\t!rebootMutation.isError ? (\n\t\t\t<Modal\n\t\t\t\ttitle=\"Settings saved!\"\n\t\t\t\tbody={`RatOS is now setup to connect to ${selectedNetwork.ssid}! Your raspberry pi will now reboot, and join your local wifi network. Click the button below to reboot the pi and close this window. You can then reconnect to your local network where http://${hostname}.local/ should be available in a few minutes. If RatOS fails to join ${selectedNetwork.ssid}, it will recreate the \"ratos\" hotspot and you'll have to try again.`}\n\t\t\t\tbuttonLabel=\"Got it!\"\n\t\t\t\tonClick={rebootAndClose}\n\t\t\t/>\n\t\t) : rebootMutation.isError ? (\n\t\t\t<div className=\"mb-4 h-48\">\n\t\t\t\t<ErrorMessage>{rebootMutation.error.message}</ErrorMessage>\n\t\t\t</div>\n\t\t) : rebootMutation.isLoading || rebootMutation.isSuccess ? (\n\t\t\t<div className=\"mb-4 h-48\">\n\t\t\t\t<div className=\"mb-4 flex items-center justify-center font-bold text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\tRebooting...\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mb-4 flex items-center justify-center  text-zinc-600 dark:text-zinc-400\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\tPlease reconnect to {selectedNetwork?.ssid ?? 'your local network'} and visit{' '}\n\t\t\t\t\t\t<a href={`http://${hostname}.local/configure?step=1`} className=\"text-brand-600 dark:text-brand-400\">\n\t\t\t\t\t\t\thttp://{hostname}.local/configure?step=1\n\t\t\t\t\t\t</a>{' '}\n\t\t\t\t\t\tin a few minutes.\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t) : selectedNetwork && wifiMutation.isSuccess ? (\n\t\t\t<TextInput\n\t\t\t\tlabel=\"Printer hostname\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tkey=\"hostname\"\n\t\t\t\tvalue={hostname}\n\t\t\t\terror={\n\t\t\t\t\thostnameMutation.isError\n\t\t\t\t\t\t? hostnameMutation.error.message\n\t\t\t\t\t\t: hostnameValidation.success\n\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t: hostnameValidation.error.issues[0].message\n\t\t\t\t}\n\t\t\t\tonChange={(val) => setHostname(val as string)}\n\t\t\t\thelp='Only use characters from a-Z and dashes. For example, entering \"RatOS\" will make your printer available at http://RatOS.local/'\n\t\t\t/>\n\t\t) : selectedNetwork ? (\n\t\t\t<div className=\"grid gap-4\">\n\t\t\t\t{selectedNetwork.ssid == null ? (\n\t\t\t\t\t<div className=\"mb-4\">\n\t\t\t\t\t\t<InfoMessage title=\"Hidden SSID\">\n\t\t\t\t\t\t\tYou have selected a hidden SSID. Please enter the SSID and password manually.\n\t\t\t\t\t\t</InfoMessage>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div className=\"mb-4 inline-flex gap-4 rounded-md border-2 border-brand-400/45 bg-brand-400/5 p-4\">\n\t\t\t\t\t\t\t<div className=\"\">{signalIcon(selectedNetwork.signal, 'h-12 w-12')}</div>\n\t\t\t\t\t\t\t<div className=\"flex flex-col gap-2 text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t{selectedNetwork.ssid}\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t{selectedNetwork.country} - {Math.round(selectedNetwork.frequency / 100) / 10}GHz\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{selectedNetwork.ssid == null && (\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tlabel=\"SSID\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tkey=\"ssid\"\n\t\t\t\t\t\tvalue={overrideSSID ?? ''}\n\t\t\t\t\t\terror={\n\t\t\t\t\t\t\twifiMutation.isError\n\t\t\t\t\t\t\t\t? wifiMutation.error.message\n\t\t\t\t\t\t\t\t: passwordValidation.success\n\t\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t\t: passwordValidation.error.formErrors.fieldErrors.ssid?.join('\\n')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={setOverrideSSID}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<TextInput\n\t\t\t\t\tlabel={selectedNetwork.security.toLocaleUpperCase() + ' Password'}\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tkey=\"password\"\n\t\t\t\t\tvalue={password}\n\t\t\t\t\terror={\n\t\t\t\t\t\twifiMutation.isError\n\t\t\t\t\t\t\t? wifiMutation.error.message\n\t\t\t\t\t\t\t: passwordValidation.success\n\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t: passwordValidation.error.formErrors.fieldErrors.passphrase?.join('\\n')\n\t\t\t\t\t}\n\t\t\t\t\tonChange={(val) => setPassword(val + '')}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t) : isError ? (\n\t\t\t<div className=\"mb-4 h-48\">\n\t\t\t\t<ErrorMessage title=\"Unable to scan for wifi access points\">{error?.message}</ErrorMessage>\n\t\t\t</div>\n\t\t) : Object.keys(apList).length === 0 ? (\n\t\t\t<div className=\"mb-4 flex h-48 items-center justify-center\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t) : (\n\t\t\t<CardSelector<SelectableNetwork> cards={cards} onSelect={onSelectCard} />\n\t\t);\n\n\tlet rightButton: StepNavButton = {\n\t\tonClick: props.nextScreen,\n\t\tlabel: 'Skip',\n\t};\n\tlet leftButton: StepNavButton = {\n\t\tonClick: props.previousScreen,\n\t};\n\n\tlet subtext = 'Pick an access point to join';\n\n\tif (selectedNetwork) {\n\t\trightButton = {\n\t\t\tlabel: 'Submit',\n\t\t\tdisabled: !passwordValidation.success || wifiMutation.isLoading,\n\t\t\tisLoading: wifiMutation.isLoading,\n\t\t\ttitle: !passwordValidation.success\n\t\t\t\t? passwordValidation.error.errors\n\t\t\t\t\t\t.map((e) => (['ssid', 'password'].includes(e.path.pop() + '') ? null : `${e.path}: ${e.message}`))\n\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t.join('\\n')\n\t\t\t\t: undefined,\n\t\t\tonClick: connectToWifi,\n\t\t};\n\t\tleftButton = {\n\t\t\tonClick: () => setSelectedNetwork(null),\n\t\t\tlabel: 'Back',\n\t\t\tdisabled: wifiMutation.isLoading,\n\t\t};\n\t\tsubtext = 'Enter password for ' + selectedNetwork.ssid;\n\t\tif (wifiMutation.isSuccess) {\n\t\t\trightButton = {\n\t\t\t\tlabel: 'Save and Connect',\n\t\t\t\tdisabled: !hostnameValidation.success || hostnameMutation.isLoading,\n\t\t\t\tonClick: confirmHostname,\n\t\t\t};\n\t\t\tleftButton = {\n\t\t\t\tonClick: () => wifiMutation.reset(),\n\t\t\t\tlabel: 'Back',\n\t\t\t\tdisabled: wifiMutation.isLoading,\n\t\t\t};\n\t\t\tsubtext = 'Enter the hostname you want to use for the printer';\n\t\t\tif (hostnameCompleted) {\n\t\t\t\trightButton = {\n\t\t\t\t\tonClick: props.nextScreen,\n\t\t\t\t};\n\t\t\t\tleftButton = {};\n\t\t\t\tsubtext = 'Proceed to next step';\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t<div className=\"mb-5 flex border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Configure Wifi Setup</h3>\n\t\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">{subtext}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{selectedNetwork == null && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Button variant=\"indeterminate\" onClick={() => setShowHidden((org) => !org)}>\n\t\t\t\t\t\t\t\t{showHidden ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}{' '}\n\t\t\t\t\t\t\t\t{showHidden ? 'Hide Hidden SSIDs' : 'Show Hidden SSIDs'}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<MutationStatus {...wifiMutation} />\n\t\t\t\t<MutationStatus {...hostnameMutation} />\n\t\t\t\t{content}\n\t\t\t</div>\n\t\t\t<StepNavButtons right={rightButton} left={leftButton} />\n\t\t</Fragment>\n\t);\n};\n","'use client';\n/* This example requires Tailwind CSS v2.0+ */\nimport React, { Fragment, useCallback, useMemo, useState } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { parseDiff, Diff, DiffType, ViewType, HunkData, TokenizeOptions, tokenize, markEdits } from 'react-diff-view';\nimport type { FileState } from '@/server/routers/printer';\nimport 'react-diff-view/style/index.css';\nimport { XMarkIcon } from '@heroicons/react/20/solid';\nimport { Button } from '@/components/common/button';\nimport { twJoin, twMerge } from 'tailwind-merge';\n\ninterface ModalProps {\n\ttitle: string;\n\tdiff: string;\n\tstate: FileState;\n\tisOpen: boolean;\n\tbuttons?: React.ReactNode;\n\toverwrite?: () => void;\n\tignore?: () => void;\n\tsetIsOpen: (open: boolean) => void;\n}\n\nconst TwoColumns = (props: { className?: string }) => {\n\treturn (\n\t\t<svg\n\t\t\tviewBox=\"0 0 24 24\"\n\t\t\tfill=\"none\"\n\t\t\tstrokeWidth=\"1.5\"\n\t\t\tstroke=\"currentColor\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\tclassName={twMerge('h-6 w-6', props.className)}\n\t\t>\n\t\t\t<path\n\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\td=\"M 12 4.5 L 12 19.5 M 4.125 19.5 L 19.875 19.5 C 20.496 19.5 21 18.996 21 18.375 L 21 5.625 C 21 5.004 20.496 4.5 19.875 4.5 L 4.125 4.5 C 3.504 4.5 3 5.004 3 5.625 L 3 18.375 C 3 18.996 3.504 19.5 4.125 19.5 Z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n};\nconst SingleColumn = (props: { className?: string }) => {\n\treturn (\n\t\t<svg\n\t\t\tviewBox=\"0 0 24 24\"\n\t\t\tfill=\"none\"\n\t\t\tstrokeWidth=\"1.5\"\n\t\t\tstroke=\"currentColor\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\tclassName={twMerge('h-6 w-6', props.className)}\n\t\t>\n\t\t\t<path\n\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\td=\"M 4.125 19.5 L 19.875 19.5 C 20.496 19.5 21 18.996 21 18.375 L 21 5.625 C 21 5.004 20.496 4.5 19.875 4.5 L 4.125 4.5 C 3.504 4.5 3 5.004 3 5.625 L 3 18.375 C 3 18.996 3.504 19.5 4.125 19.5 Z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n};\n\nconst proccessTokens = (hunks: HunkData[]) => {\n\tif (!hunks) {\n\t\treturn undefined;\n\t}\n\n\tconst options: TokenizeOptions = {\n\t\thighlight: false,\n\t\tenhancers: [markEdits(hunks, { type: 'block' })],\n\t};\n\n\ttry {\n\t\treturn tokenize(hunks, options);\n\t} catch (ex) {\n\t\treturn undefined;\n\t}\n};\n\nexport const DiffModal: React.FC<ModalProps> = (props) => {\n\tconst { isOpen, setIsOpen } = props;\n\tconst [viewType, setViewType] = useState<ViewType>('unified');\n\n\tconst close = useCallback(() => {\n\t\tsetIsOpen(false);\n\t}, [setIsOpen]);\n\n\tconst files = useMemo(() => {\n\t\treturn parseDiff(props.diff);\n\t}, [props.diff]);\n\tconst diffType: DiffType = props.state === 'changed' ? 'modify' : props.state === 'created' ? 'add' : 'delete';\n\n\treturn (\n\t\t<Transition.Root show={isOpen} as={Fragment} appear={true}>\n\t\t\t<Dialog\n\t\t\t\tas=\"div\"\n\t\t\t\tclassName=\"git-diff fixed inset-0 z-10 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600\"\n\t\t\t\tonClose={close}\n\t\t\t>\n\t\t\t\t<div className=\"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0\">\n\t\t\t\t\t<Transition.Child\n\t\t\t\t\t\tas={Fragment}\n\t\t\t\t\t\tenter=\"ease-out duration-300\"\n\t\t\t\t\t\tenterFrom=\"opacity-0\"\n\t\t\t\t\t\tenterTo=\"opacity-100\"\n\t\t\t\t\t\tleave=\"ease-in duration-200\"\n\t\t\t\t\t\tleaveFrom=\"opacity-100\"\n\t\t\t\t\t\tleaveTo=\"opacity-0\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Dialog.Overlay className=\"fixed inset-0 bg-zinc-500 bg-opacity-75 transition-opacity dark:bg-zinc-950 dark:bg-opacity-75\" />\n\t\t\t\t\t</Transition.Child>\n\n\t\t\t\t\t{/* This element is to trick the browser into centering the modal contents. */}\n\t\t\t\t\t<span className=\"hidden sm:inline-block sm:h-screen sm:align-middle\" aria-hidden=\"true\">\n\t\t\t\t\t\t&#8203;\n\t\t\t\t\t</span>\n\t\t\t\t\t<Transition.Child\n\t\t\t\t\t\tas={Fragment}\n\t\t\t\t\t\tenter=\"ease-out duration-300\"\n\t\t\t\t\t\tenterFrom=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n\t\t\t\t\t\tenterTo=\"opacity-100 translate-y-0 sm:scale-100\"\n\t\t\t\t\t\tleave=\"ease-in duration-200\"\n\t\t\t\t\t\tleaveFrom=\"opacity-100 translate-y-0 sm:scale-100\"\n\t\t\t\t\t\tleaveTo=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"relative inline-flex max-h-[80vh] max-w-screen-2xl transform flex-col overflow-hidden rounded-lg bg-white py-4 text-left align-bottom shadow-xl transition-all dark:bg-zinc-800 sm:my-8 sm:w-full sm:py-6 sm:align-middle\">\n\t\t\t\t\t\t\t<Dialog.Title\n\t\t\t\t\t\t\t\tas=\"h3\"\n\t\t\t\t\t\t\t\tclassName=\"flex items-center justify-between border-b border-zinc-200 px-4 pb-4 text-lg font-semibold leading-6 text-zinc-900 dark:border-zinc-700 dark:text-zinc-100 sm:px-6\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div>{props.title}</div>\n\t\t\t\t\t\t\t\t<div className=\"relative flex flex-nowrap items-center space-x-2 text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\tviewType === 'unified'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'cursor-default text-sky-600 dark:text-sky-400'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'hover:text-zinc-800 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => setViewType('unified')}\n\t\t\t\t\t\t\t\t\t\ttitle=\"Unified View\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<SingleColumn className=\"h-6 w-6\" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\tviewType === 'split'\n\t\t\t\t\t\t\t\t\t\t\t\t? 'cursor-default text-sky-600 dark:text-sky-400'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'hover:text-zinc-800 dark:hover:text-zinc-100',\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tonClick={() => setViewType('split')}\n\t\t\t\t\t\t\t\t\t\ttitle=\"Split View\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<TwoColumns className=\"h-6 w-6\" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<div className=\"!ml-4 !mr-1 h-6 border-l border-l-zinc-200 dark:border-l-zinc-800\"></div>\n\t\t\t\t\t\t\t\t\t<button className=\"hover:text-zinc-800 dark:hover:text-zinc-100\" onClick={close}>\n\t\t\t\t\t\t\t\t\t\t<XMarkIcon className=\"h-6 w-6\" />\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Dialog.Title>\n\t\t\t\t\t\t\t<div className=\"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600\">\n\t\t\t\t\t\t\t\t{files.map(({ hunks }, i) => (\n\t\t\t\t\t\t\t\t\t<Diff key={i} hunks={hunks} viewType={viewType} diffType={diffType} tokens={proccessTokens(hunks)} />\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-end flex flex-row items-center justify-end space-x-2 border-t border-zinc-200 px-4 pt-4 dark:border-zinc-700 sm:px-6 sm:pt-6\">\n\t\t\t\t\t\t\t\t{props.buttons ?? null}\n\t\t\t\t\t\t\t\t<Button variant=\"plain\" onClick={close}>\n\t\t\t\t\t\t\t\t\tClose\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Transition.Child>\n\t\t\t\t</div>\n\t\t\t</Dialog>\n\t\t</Transition.Root>\n\t);\n};\n","import { cva, VariantProps } from 'class-variance-authority';\nimport React from 'react';\nimport { twMerge } from 'tailwind-merge';\nimport type { Intents } from '@/components/common/button';\n\ntype IntentNoOutline = Exclude<Intents, 'outline'>;\n\ntype StateIntents = { [key in IntentNoOutline]: string };\n\nexport const StateCircleVariants = cva('flex-none rounded-full p-1 relative flex', {\n\tvariants: {\n\t\tstate: {\n\t\t\tsuccess: 'dark:text-green-400 text-green-500 bg-green-400/20',\n\t\t\tinfo: 'dark:text-sky-400 text-sky-500 bg-sky-400/20',\n\t\t\twarning: 'dark:text-yellow-400 text-yellow-500 bg-yellow-400/20',\n\t\t\tdanger: 'dark:text-rose-400 text-rose-500 bg-rose-400/20',\n\t\t\tindeterminate: 'dark:text-zinc-400 text-zinc-500 bg-zinc-500/20',\n\t\t\tplain: 'dark:text-zinc-400 text-zinc-500 bg-zinc-500/20',\n\t\t\tprimary: 'dark:text-brand-400 text-brand-500 bg-brand-500/20',\n\t\t} satisfies StateIntents,\n\t},\n});\n\nexport type StateCircleProps = VariantProps<typeof StateCircleVariants> & {\n\tping?: boolean;\n\ttitle?: string;\n\tpingClassName?: string;\n};\n\nexport const StateCircle: React.FC<StateCircleProps> = (props) => {\n\treturn (\n\t\t<div className={StateCircleVariants(props)}>\n\t\t\t<div\n\t\t\t\ttitle={props.title}\n\t\t\t\tclassName={twMerge(\n\t\t\t\t\t'absolute inset-0 transition-all duration-700',\n\t\t\t\t\tprops.ping ? 'opacity-100' : 'opacity-0',\n\t\t\t\t\tprops.pingClassName ?? 'z-2',\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={twMerge('absolute inset-0 inline-flex animate-ping rounded-full bg-current opacity-0 ease-out')}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"h-2 w-2 rounded-full bg-current\" />\n\t\t</div>\n\t);\n};\n","import React, { Fragment, useCallback, useEffect, useMemo, useState } from 'react';\nimport { SerializedPrinterConfiguration } from '@/zods/printer-configuration';\nimport { trpc } from '@/utils/trpc';\nimport { useQuery } from '@tanstack/react-query';\nimport type { FilesToWriteWithState, FileState } from '@/server/routers/printer';\nimport { DiffModal } from '@/components/setup-steps/diff-modal';\nimport { twJoin } from 'tailwind-merge';\nimport { Menu, Transition } from '@headlessui/react';\nimport { EllipsisVerticalIcon } from '@heroicons/react/20/solid';\nimport { StateCircle } from '@/components/common/state-circle';\nimport { Badge } from '@/components/common/badge';\nimport { Button, Intents } from '@/components/common/button';\nimport { useChangeEffect } from '@/hooks/useChangeEffect';\nimport { CheckIcon } from '@heroicons/react/24/outline';\nimport { QueryStatus } from '@/components/common/query-status';\n\ninterface FileChangesProps {\n\tserializedConfig: SerializedPrinterConfiguration | null;\n\tonFilesToOverwriteChange: (files: string[]) => void;\n\tonFilesToIgnoreChange: (files: string[]) => void;\n}\n\ninterface ChangedFileProps {\n\tfile: Unpacked<FilesToWriteWithState>;\n\tisMarkedOverwritten: boolean;\n\tisMarkedIgnored: boolean;\n\taddFileToOverwrite: (fileName: string) => void;\n\tremoveFileToOverwrite: (fileName: string) => void;\n\taddFileToIgnore: (fileName: string) => void;\n\tremoveFileToIgnore: (fileName: string) => void;\n}\n\nconst statuses: { [key in FileState]: string } = {\n\tcreated: 'text-green-700 bg-green-50 ring-green-600/20',\n\tunchanged: 'text-zinc-600 bg-zinc-50 ring-zinc-500/10',\n\tchanged: 'text-yellow-800 bg-yellow-50 ring-yellow-600/20',\n\tremoved: 'text-rose-700 bg-rose-50 ring-rose-600/20',\n};\n\ntype Action = {\n\taction: (fileName: string) => void;\n\tintent: Intents;\n\ttitle: string;\n};\n\nconst ChangedFile: React.FC<ChangedFileProps> = (props) => {\n\tconst {\n\t\taddFileToIgnore,\n\t\taddFileToOverwrite,\n\t\tfile,\n\t\tremoveFileToIgnore,\n\t\tremoveFileToOverwrite,\n\t\tisMarkedIgnored,\n\t\tisMarkedOverwritten,\n\t} = props;\n\n\tconst [isDiffModalOpen, setIsDiffModalOpen] = useState(false);\n\tconst showDiffModal = useCallback((file: Unpacked<FilesToWriteWithState>) => {\n\t\tsetIsDiffModalOpen(true);\n\t}, []);\n\n\tconst wouldOtherwiseBeWritten =\n\t\t(file.state === 'changed' && (file.overwrite || isMarkedOverwritten)) ||\n\t\tfile.state === 'created' ||\n\t\tfile.state === 'removed';\n\tconst isOverwritable = file.state === 'changed';\n\tconst isIgnorable = file.state === 'created' || file.state === 'removed' || file.state === 'changed';\n\tconst isIgnored = isMarkedIgnored;\n\tconst isOverwritten = isMarkedOverwritten || (file.overwrite && file.exists);\n\tconst needsExplicitAction =\n\t\tisIgnorable && !isIgnored && !isOverwritten && !wouldOtherwiseBeWritten && file.changedFromConfig === true;\n\tconst isDeleted = file.state === 'removed' && !isIgnored;\n\tconst isCreated = file.state === 'created' && !isIgnored;\n\tconst isChanged = file.state === 'changed' && !isIgnored && isOverwritten;\n\n\tconst actions = useMemo(() => {\n\t\tif (file.fileName === 'RatOS.cfg') {\n\t\t\treturn [];\n\t\t}\n\t\tlet skip: null | Action = null;\n\t\tlet ignore: null | Action = null;\n\t\tlet overwrite: null | Action = null;\n\t\tlet write: null | Action = null;\n\t\tlet remove: null | Action = null;\n\t\tif (isOverwritten && !isIgnored) {\n\t\t\tskip = {\n\t\t\t\ttitle: 'Skip',\n\t\t\t\tintent: 'indeterminate',\n\t\t\t\taction: isMarkedOverwritten ? removeFileToOverwrite : addFileToIgnore,\n\t\t\t};\n\t\t} else if (isOverwritable) {\n\t\t\toverwrite = {\n\t\t\t\ttitle: 'Overwrite',\n\t\t\t\tintent: 'warning',\n\t\t\t\taction: isMarkedIgnored ? removeFileToIgnore : addFileToOverwrite,\n\t\t\t};\n\t\t}\n\t\tif (isIgnorable && !isIgnored) {\n\t\t\tignore = {\n\t\t\t\ttitle: 'Ignore',\n\t\t\t\tintent: needsExplicitAction ? 'danger' : 'indeterminate',\n\t\t\t\taction: addFileToIgnore,\n\t\t\t};\n\t\t} else if (isIgnored) {\n\t\t\tif (file.state === 'removed') {\n\t\t\t\tremove = {\n\t\t\t\t\ttitle: 'Delete',\n\t\t\t\t\tintent: 'danger',\n\t\t\t\t\taction: removeFileToIgnore,\n\t\t\t\t};\n\t\t\t} else if (isIgnorable) {\n\t\t\t\twrite = {\n\t\t\t\t\ttitle: 'Write',\n\t\t\t\t\tintent: 'success',\n\t\t\t\t\taction: removeFileToIgnore,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn [skip, ignore, overwrite, write, remove].filter(Boolean);\n\t}, [\n\t\taddFileToIgnore,\n\t\taddFileToOverwrite,\n\t\tfile.fileName,\n\t\tfile.state,\n\t\tisIgnorable,\n\t\tisIgnored,\n\t\tisMarkedIgnored,\n\t\tisMarkedOverwritten,\n\t\tisOverwritable,\n\t\tisOverwritten,\n\t\tneedsExplicitAction,\n\t\tremoveFileToIgnore,\n\t\tremoveFileToOverwrite,\n\t]);\n\n\tconst fileState: Intents = useMemo(() => {\n\t\tif (needsExplicitAction) {\n\t\t\treturn 'danger';\n\t\t}\n\t\tif (file.state === 'changed') {\n\t\t\tif ((isIgnored && file.overwrite) || (isOverwritten && !file.overwrite)) {\n\t\t\t\treturn 'warning';\n\t\t\t} else if (isOverwritten) {\n\t\t\t\treturn 'success';\n\t\t\t} else {\n\t\t\t\treturn 'indeterminate';\n\t\t\t}\n\t\t}\n\t\tif (file.state === 'created') {\n\t\t\tif (isIgnored) {\n\t\t\t\treturn 'danger';\n\t\t\t} else {\n\t\t\t\treturn 'success';\n\t\t\t}\n\t\t}\n\t\tif (file.state === 'removed') {\n\t\t\tif (!isIgnored) {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\t\t}\n\t\treturn 'indeterminate';\n\t}, [file.overwrite, file.state, isIgnored, isOverwritten, needsExplicitAction]);\n\n\tconst [shouldPing] = useChangeEffect([fileState], 4000);\n\n\treturn (\n\t\t<li key={file.fileName} className=\"flex items-center justify-between gap-x-6 py-5\">\n\t\t\t{file?.diff != null && (\n\t\t\t\t<DiffModal\n\t\t\t\t\tdiff={file.diff}\n\t\t\t\t\ttitle={`Changes to ${file.fileName}`}\n\t\t\t\t\tstate={file.state}\n\t\t\t\t\tsetIsOpen={setIsDiffModalOpen}\n\t\t\t\t\tbuttons={actions.map((a) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\ta.action(file.fileName);\n\t\t\t\t\t\t\t\t\tsetIsDiffModalOpen(false);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvariant={a.intent}\n\t\t\t\t\t\t\t\tkey={a.title}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{a.title}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t\tisOpen={isDiffModalOpen}\n\t\t\t\t></DiffModal>\n\t\t\t)}\n\t\t\t<div className=\"min-w-0\">\n\t\t\t\t<div className=\"flex items-center gap-x-3\">\n\t\t\t\t\t<StateCircle state={fileState} ping={shouldPing} />\n\t\t\t\t\t<p className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">{file.fileName}</p>\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\tfile.state === 'changed'\n\t\t\t\t\t\t\t\t? !file.changedFromConfig\n\t\t\t\t\t\t\t\t\t? 'sky'\n\t\t\t\t\t\t\t\t\t: 'yellow'\n\t\t\t\t\t\t\t\t: file.state === 'created'\n\t\t\t\t\t\t\t\t\t? 'green'\n\t\t\t\t\t\t\t\t\t: file.state === 'removed'\n\t\t\t\t\t\t\t\t\t\t? 'rose'\n\t\t\t\t\t\t\t\t\t\t: 'gray'\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t{file.state === 'changed'\n\t\t\t\t\t\t\t? file.changedFromConfig\n\t\t\t\t\t\t\t\t? 'Pending changes'\n\t\t\t\t\t\t\t\t: 'Changed on disk'\n\t\t\t\t\t\t\t: file.state === 'created'\n\t\t\t\t\t\t\t\t? 'New file'\n\t\t\t\t\t\t\t\t: file.state === 'removed'\n\t\t\t\t\t\t\t\t\t? 'Deleted'\n\t\t\t\t\t\t\t\t\t: 'No updates'}\n\t\t\t\t\t</Badge>\n\t\t\t\t\t{file.changedOnDisk && (\n\t\t\t\t\t\t<Badge size=\"sm\" color=\"sky\">\n\t\t\t\t\t\t\tChanged on disk\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-1 flex items-center gap-x-2 text-xs leading-5 text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t<p className=\"\">\n\t\t\t\t\t\t{file.state === 'changed' &&\n\t\t\t\t\t\t\t(isOverwritten && !isIgnored\n\t\t\t\t\t\t\t\t? 'File will be backed up and overwritten.' +\n\t\t\t\t\t\t\t\t\t(file.fileName != 'RatOS.cfg' ? ` Any changes you've made can be recovered from the backup.` : '')\n\t\t\t\t\t\t\t\t: !needsExplicitAction\n\t\t\t\t\t\t\t\t\t? 'File will be skipped.'\n\t\t\t\t\t\t\t\t\t: 'Please review the changes and make a decision.')}\n\t\t\t\t\t\t{file.state === 'created' && (isIgnored ? 'File will be skipped.' : 'File will be created.')}\n\t\t\t\t\t\t{file.state === 'removed' && (!isIgnored ? 'File will be deleted.' : 'File will remain untouched.')}\n\t\t\t\t\t\t{file.state === 'unchanged' &&\n\t\t\t\t\t\t\t(file.changedOnDisk ? 'File has user modifications.' : 'File remains untouched.')}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"flex flex-none items-center gap-x-4\">\n\t\t\t\t<div className=\"flex flex-none items-center\">\n\t\t\t\t\t{needsExplicitAction ? (\n\t\t\t\t\t\t<Button variant=\"info\" onClick={() => showDiffModal(file)}>\n\t\t\t\t\t\t\tReview changes\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<CheckIcon className=\"h-5 w-5 text-green-500 dark:text-brand-500\" aria-hidden=\"true\" />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<Menu as=\"div\" className=\"relative flex-none\">\n\t\t\t\t\t<Menu.Button className=\"-m-2.5 block p-2.5 text-zinc-500 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-100\">\n\t\t\t\t\t\t<span className=\"sr-only\">Open options</span>\n\t\t\t\t\t\t<EllipsisVerticalIcon className=\"h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t\t</Menu.Button>\n\t\t\t\t\t<Transition\n\t\t\t\t\t\tas={Fragment}\n\t\t\t\t\t\tenter=\"transition ease-out duration-100\"\n\t\t\t\t\t\tenterFrom=\"transform opacity-0 scale-95\"\n\t\t\t\t\t\tenterTo=\"transform opacity-100 scale-100\"\n\t\t\t\t\t\tleave=\"transition ease-in duration-75\"\n\t\t\t\t\t\tleaveFrom=\"transform opacity-100 scale-100\"\n\t\t\t\t\t\tleaveTo=\"transform opacity-0 scale-95\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Menu.Items className=\"absolute right-0 z-10 mt-2 w-32 origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-zinc-900/5 focus:outline-none dark:bg-zinc-900 dark:ring-zinc-100/5\">\n\t\t\t\t\t\t\t{actions.map((action) => (\n\t\t\t\t\t\t\t\t<Menu.Item key={action.title}>\n\t\t\t\t\t\t\t\t\t{({ active, disabled }) => (\n\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => action.action(file.fileName)}\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\t\tactive ? 'bg-zinc-50 dark:bg-zinc-800' : '',\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled ? 'cursor-not-allowed opacity-50' : 'cursor-pointer',\n\t\t\t\t\t\t\t\t\t\t\t\t'block px-3 py-1 text-sm leading-6 text-zinc-800 dark:text-zinc-200',\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{action.title}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t<Menu.Item disabled={file.diff == null}>\n\t\t\t\t\t\t\t\t{({ active, disabled }) => (\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tonClick={() => showDiffModal(file)}\n\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\tactive ? 'bg-zinc-50 dark:bg-zinc-800' : '',\n\t\t\t\t\t\t\t\t\t\t\tdisabled ? 'cursor-not-allowed opacity-50' : 'cursor-pointer',\n\t\t\t\t\t\t\t\t\t\t\t'block px-3 py-1 text-sm leading-6 text-zinc-800 dark:text-zinc-200',\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tView diff\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t</Menu.Items>\n\t\t\t\t\t</Transition>\n\t\t\t\t</Menu>\n\t\t\t</div>\n\t\t</li>\n\t);\n};\n\nexport const FileChanges: React.FC<FileChangesProps> = (props) => {\n\tconst { serializedConfig, onFilesToIgnoreChange, onFilesToOverwriteChange } = props;\n\tconst [filesToOverwrite, setFilesToOverwrite] = useState<string[]>([]);\n\n\tconst addFileToOverwrite = useCallback((fileName: string) => {\n\t\tsetFilesToOverwrite((files) => (files.includes(fileName) ? files : [...files, fileName]));\n\t}, []);\n\n\tconst removeFileToOverwrite = useCallback((fileName: string) => {\n\t\tsetFilesToOverwrite((files) => (files.includes(fileName) ? files.filter((file) => file !== fileName) : files));\n\t}, []);\n\n\tconst [filesToIgnore, setFilesToIgnore] = useState<string[]>([]);\n\n\tconst addFileToIgnore = useCallback((fileName: string) => {\n\t\tsetFilesToIgnore((files) => (files.includes(fileName) ? files : [...files, fileName]));\n\t}, []);\n\n\tconst removeFileToIgnore = useCallback((fileName: string) => {\n\t\tsetFilesToIgnore((files) => (files.includes(fileName) ? files.filter((file) => file !== fileName) : files));\n\t}, []);\n\n\tuseEffect(() => {\n\t\tonFilesToOverwriteChange(filesToOverwrite);\n\t}, [filesToOverwrite, onFilesToOverwriteChange]);\n\tuseEffect(() => {\n\t\tonFilesToIgnoreChange(filesToIgnore);\n\t}, [filesToIgnore, onFilesToIgnoreChange]);\n\n\tconst client = trpc.useUtils().client;\n\tconst filesToWrite = useQuery({\n\t\tqueryKey: ['printer.filesToWrite', serializedConfig],\n\t\tqueryFn: async () => {\n\t\t\tconst res = await client.printer.getFilesToWrite.mutate({\n\t\t\t\tconfig: serializedConfig ?? ({} as any),\n\t\t\t});\n\t\t\treturn res;\n\t\t},\n\t\tenabled: serializedConfig != null,\n\t});\n\treturn (\n\t\t<ul role=\"list\" className=\"divide-y divide-zinc-100 dark:divide-zinc-800\">\n\t\t\t{filesToWrite.data?.map((fileToWrite) => {\n\t\t\t\treturn (\n\t\t\t\t\t<ChangedFile\n\t\t\t\t\t\tkey={fileToWrite.fileName}\n\t\t\t\t\t\tfile={fileToWrite}\n\t\t\t\t\t\tisMarkedIgnored={filesToIgnore.includes(fileToWrite.fileName)}\n\t\t\t\t\t\tisMarkedOverwritten={filesToOverwrite.includes(fileToWrite.fileName)}\n\t\t\t\t\t\taddFileToIgnore={addFileToIgnore}\n\t\t\t\t\t\taddFileToOverwrite={addFileToOverwrite}\n\t\t\t\t\t\tremoveFileToIgnore={removeFileToIgnore}\n\t\t\t\t\t\tremoveFileToOverwrite={removeFileToOverwrite}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t\t<QueryStatus {...filesToWrite} />\n\t\t</ul>\n\t);\n};\n","'use client';\nimport React, { Fragment, useCallback, useMemo, useState } from 'react';\nimport {\n\tPrinterConfigurationState,\n\tserializePartialPrinterConfiguration,\n\tserializePrinterConfiguration,\n\tusePrinterConfiguration,\n} from '@/hooks/usePrinterConfiguration';\nimport { StepScreen, StepScreenProps, useSteps } from '@/hooks/useSteps';\nimport { StepNavButtons } from '@/components/step-nav-buttons';\nimport { ErrorMessage } from '@/components/common/error-message';\nimport { trpc } from '@/helpers/trpc';\nimport { Badge } from '@/components/common/badge';\nimport { InfoMessage } from '@/components/common/info-message';\nimport { WarningMessage } from '@/components/warning-message';\nimport { Button } from '@/components/common/button';\nimport { useRecoilCallback } from 'recoil';\nimport { xEndstopOptions } from '@/data/endstops';\nimport { PrinterConfiguration } from '@/zods/printer-configuration';\nimport { PrinterAxis } from '@/zods/motion';\nimport { ToolOrAxis } from '@/zods/toolhead';\nimport { useToolheadConfiguration } from '@/hooks/useToolheadConfiguration';\nimport { Spinner } from '@/components/common/spinner';\nimport { useQuery } from '@tanstack/react-query';\nimport { FileChanges } from '@/components/setup-steps/file-changes';\nimport { Disclosure } from '@headlessui/react';\nimport { ChevronRightIcon } from '@heroicons/react/20/solid';\nimport { twJoin } from 'tailwind-merge';\nimport { AnimatedContainer } from '@/components/common/animated-container';\n\nconst CompletionSteps: StepScreen[] = [\n\t{\n\t\tid: '01',\n\t\tname: 'Confirm configuration',\n\t\tdescription: 'Confirm your printer configuration',\n\t\thref: '#',\n\t\trenderScreen: (screenProps) => <ConfirmConfig {...screenProps} key={screenProps.key} />,\n\t},\n\t{\n\t\tid: '02',\n\t\tname: 'Setup complete',\n\t\tdescription: \"You've completed the initial setup, congratulations!\",\n\t\thref: '#',\n\t\trenderScreen: (screenProps) => <ProceedToMainsail {...screenProps} key={screenProps.key} />,\n\t},\n];\n\ninterface ConfirmToolheadProps {\n\ttoolOrAxis: ToolOrAxis;\n}\n\nexport const ConfirmToolhead: React.FC<ConfirmToolheadProps> = (props) => {\n\tconst { toolhead, setToolhead } = useToolheadConfiguration(props.toolOrAxis);\n\tconst toolboardDetected = trpc.mcu.detect.useQuery(\n\t\t{ boardPath: toolhead.getToolboard()?.path ?? '', toolhead: toolhead.serialize() },\n\t\t{\n\t\t\tenabled: toolhead.getToolboard() != null,\n\t\t},\n\t);\n\tconst [ignoreEndstopWarning, setIgnoreEndstopWarning] = useState(false);\n\tconst setToolboardEndstop = useRecoilCallback(\n\t\t({ snapshot, set }) =>\n\t\t\tasync () => {\n\t\t\t\tconst printerConfig = await snapshot.getPromise(PrinterConfigurationState);\n\t\t\t\tif (printerConfig == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst toolboardEndstop = xEndstopOptions(\n\t\t\t\t\tserializePartialPrinterConfiguration(printerConfig),\n\t\t\t\t\ttoolhead.serialize(),\n\t\t\t\t).find((x) => x.id === 'endstop-toolboard');\n\t\t\t\tif (toolboardEndstop != null && toolhead != null) {\n\t\t\t\t\tsetToolhead({\n\t\t\t\t\t\t...toolhead.getConfig(),\n\t\t\t\t\t\txEndstop: toolboardEndstop,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t[],\n\t);\n\tif (toolhead == null) {\n\t\treturn (\n\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 border-t border-zinc-100 py-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t<div className=\"space-x-2 text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</dl>\n\t\t);\n\t}\n\tconst hasWarnings =\n\t\t(toolhead.getToolboard() != null && !toolboardDetected.data) ||\n\t\t(toolhead.getToolboard()?.alternativePT1000Resistor && toolhead.getThermistor() === 'PT1000');\n\treturn (\n\t\t<Disclosure as=\"div\" className=\"\">\n\t\t\t{({ open }) => (\n\t\t\t\t<>\n\t\t\t\t\t<Disclosure.Button as=\"div\" className=\"cursor-pointer border-b border-zinc-100 py-4 dark:border-zinc-800\">\n\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t<h3 className=\"flex items-center space-x-2 text-base font-bold leading-7 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t<span>Toolhead {toolhead.getToolCommand()}</span>\n\t\t\t\t\t\t\t\t{hasWarnings && (\n\t\t\t\t\t\t\t\t\t<Badge color=\"yellow\" size=\"md\">\n\t\t\t\t\t\t\t\t\t\tHas Warnings\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<button>\n\t\t\t\t\t\t\t\t<ChevronRightIcon\n\t\t\t\t\t\t\t\t\tclassName={twJoin('h-6 w-6 transition-all duration-200 ease-in-out', open ? 'rotate-90' : 'rotate-0')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm\">{toolhead.getDescription()}</p>\n\t\t\t\t\t</Disclosure.Button>\n\t\t\t\t\t<AnimatedContainer>\n\t\t\t\t\t\t<Disclosure.Panel className=\"pt-4\">\n\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"space-x-2 text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t<span>Toolboard</span>{' '}\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().toolboard && (\n\t\t\t\t\t\t\t\t\t\t\t<Badge color={toolboardDetected.data === true ? 'green' : 'red'}>\n\t\t\t\t\t\t\t\t\t\t\t\t{toolboardDetected.data === true ? 'Detected' : 'Not detected'}\n\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().toolboard == null\n\t\t\t\t\t\t\t\t\t\t\t? 'None selected'\n\t\t\t\t\t\t\t\t\t\t\t: `${toolhead.getConfig().toolboard?.manufacturer} ${toolhead.getConfig().toolboard?.name}`}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{toolhead.getToolboard() != null && !toolboardDetected.data && (\n\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<WarningMessage>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\tThe toolboard you have selected does not seem to be connected, you can still save the config\n\t\t\t\t\t\t\t\t\t\t\t\t\tand proceed to mainsail, but you will get an 'mcu' connection error.\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</WarningMessage>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Extruder</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().extruder?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Hotend</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().hotend?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Thermistor</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().thermistor ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{toolhead.getToolboard()?.alternativePT1000Resistor && toolhead.getThermistor() === 'PT1000' && (\n\t\t\t\t\t\t\t\t\t<div className=\"col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<WarningMessage title=\"RatOS uses your toolboards alternate pullup resistor setting\">\n\t\t\t\t\t\t\t\t\t\t\tYour toolboard has an option to use a separate pullup resistor for PT1000 sensors. This is usually\n\t\t\t\t\t\t\t\t\t\t\tdone by inserting a jumper. Make sure you read the documentation for your board on how to enable\n\t\t\t\t\t\t\t\t\t\t\tthe alternative resistor or you'll get ADC temperature errors in klipper.\n\t\t\t\t\t\t\t\t\t\t</WarningMessage>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 border-t border-zinc-100 py-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">X Endstop</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().xEndstop?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Y Endstop</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().yEndstop?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Probe</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().probe?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{toolhead.getConfig().toolboard != null &&\n\t\t\t\t\t\t\t\t\ttoolhead.getConfig().xEndstop?.id === 'endstop' &&\n\t\t\t\t\t\t\t\t\t!ignoreEndstopWarning && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t\t\t\t\t\t\t<WarningMessage>\n\t\t\t\t\t\t\t\t\t\t\t\tThe current configuration assumes the X endstop is connected to your controlboard, do you want\n\t\t\t\t\t\t\t\t\t\t\t\tto use an endstop connected to the toolboard instead?\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"mt-4 flex justify-end space-x-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button onClick={setToolboardEndstop} variant=\"warning\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tYes, use the toolboard connection\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button onClick={() => setIgnoreEndstopWarning(true)} variant=\"plain\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tNo, use the controlboard connection\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</WarningMessage>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 border-t border-zinc-100 py-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Part cooling fan</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().partFan?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Hotend cooling fan</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().hotendFan?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 border-t border-zinc-100 py-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">X Accelerometer</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().xAccelerometer?.title ?? 'None'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Y Accelerometer</dt>\n\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t{toolhead.getConfig().yAccelerometer?.title ?? 'None'}\n\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t</Disclosure.Panel>\n\t\t\t\t\t</AnimatedContainer>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</Disclosure>\n\t);\n};\n\nexport const ConfirmConfig: React.FC<StepScreenProps> = (props) => {\n\tconst { parsedPrinterConfiguration, partialPrinterConfiguration } = usePrinterConfiguration();\n\n\tconst serializedPrinterConfiguration = useMemo(() => {\n\t\tif (parsedPrinterConfiguration.success === true) {\n\t\t\treturn serializePrinterConfiguration(parsedPrinterConfiguration.data);\n\t\t}\n\t\treturn null;\n\t}, [parsedPrinterConfiguration]);\n\n\tconst errors: React.ReactNode[] = [];\n\n\tconst [filesToOverwrite, setFilesToOverwrite] = useState<string[]>([]);\n\n\tconst [filesToIgnore, setFilesToIgnore] = useState<string[]>([]);\n\n\tconst controlboardDetected = trpc.mcu.detect.useQuery(\n\t\t{ boardPath: partialPrinterConfiguration != null ? partialPrinterConfiguration.controlboard?.path ?? '' : '' },\n\t\t{\n\t\t\tenabled: partialPrinterConfiguration?.controlboard != null,\n\t\t},\n\t);\n\tconst saveConfigurationMutation = trpc.printer.saveConfiguration.useMutation();\n\tconst saveConfiguration = useCallback(async () => {\n\t\tif (parsedPrinterConfiguration.success) {\n\t\t\tsaveConfigurationMutation.mutate(\n\t\t\t\t{\n\t\t\t\t\tconfig: serializePrinterConfiguration(parsedPrinterConfiguration.data),\n\t\t\t\t\toverwriteFiles: filesToOverwrite,\n\t\t\t\t\tskipFiles: filesToIgnore,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tonSuccess: props.nextScreen,\n\t\t\t\t\tonError: () => window.scrollTo(0, 0),\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}, [parsedPrinterConfiguration, saveConfigurationMutation, filesToOverwrite, filesToIgnore, props.nextScreen]);\n\n\tconst client = trpc.useContext().client;\n\tconst filesToWrite = useQuery({\n\t\tqueryKey: ['filesToWrite', serializedPrinterConfiguration],\n\t\tqueryFn: async () => {\n\t\t\tconst res = await client.printer.getFilesToWrite.mutate({\n\t\t\t\tconfig: serializedPrinterConfiguration ?? ({} as any),\n\t\t\t});\n\t\t\treturn res;\n\t\t},\n\t\tenabled: parsedPrinterConfiguration.success,\n\t});\n\n\tconst requiresExplicitFileActions = filesToWrite.data?.some(\n\t\t(f) =>\n\t\t\tf.state === 'changed' &&\n\t\t\tf.changedFromConfig === true &&\n\t\t\tf.overwrite === false &&\n\t\t\t!filesToIgnore.includes(f.fileName) &&\n\t\t\t!filesToOverwrite.includes(f.fileName),\n\t);\n\n\tif (saveConfigurationMutation.error) {\n\t\terrors.push(saveConfigurationMutation.error.message);\n\t}\n\tif (parsedPrinterConfiguration.success === false) {\n\t\t// console.error(parsedPrinterConfiguration.error);\n\t\tconst formErrors = parsedPrinterConfiguration.error.flatten().formErrors;\n\t\tconst fieldErrors = parsedPrinterConfiguration.error.flatten().fieldErrors;\n\t\tif (formErrors.length) {\n\t\t\tformErrors.forEach((message) => {\n\t\t\t\terrors.push(message);\n\t\t\t});\n\t\t} else {\n\t\t\tfor (const field in fieldErrors) {\n\t\t\t\terrors.push(\n\t\t\t\t\t<>\n\t\t\t\t\t\t<span className=\"capitalize\">{field}</span>: {fieldErrors[field as keyof PrinterConfiguration]?.[0]}\n\t\t\t\t\t</>,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tconst motionErrors = useMemo(() => {\n\t\tif (parsedPrinterConfiguration.success) {\n\t\t\treturn parsedPrinterConfiguration.data.rails\n\t\t\t\t.filter((r) => r.axis.startsWith('x') || r.axis.startsWith('y'))\n\t\t\t\t?.map((rail) => {\n\t\t\t\t\tconst board = parsedPrinterConfiguration.data.controlboard;\n\t\t\t\t\tconst motorSlot = rail.motorSlot;\n\t\t\t\t\tif (motorSlot == null || board?.motorSlots?.[motorSlot].title == null) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tconst hasDiagPin = board.motorSlots?.[motorSlot].diag_pin != null;\n\t\t\t\t\tconst isSensorless =\n\t\t\t\t\t\t(rail.axis.startsWith('x') &&\n\t\t\t\t\t\t\tparsedPrinterConfiguration.data.toolheads.some((t) => t.xEndstop?.id === 'sensorless')) ||\n\t\t\t\t\t\t(rail.axis.startsWith('y') &&\n\t\t\t\t\t\t\tparsedPrinterConfiguration.data.toolheads.some((t) => t.yEndstop?.id === 'sensorless'));\n\t\t\t\t\treturn !hasDiagPin && isSensorless ? (\n\t\t\t\t\t\t<ErrorMessage key={rail.axis} className=\"col-span-2\" title=\"Driver Slot Allocation Invalid\">\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<span className=\"capitalize\">{rail.axis}</span> is configured to use sensorless homing, but the{' '}\n\t\t\t\t\t\t\t\t\t<span className=\"capitalize\">{board.motorSlots?.[motorSlot].title}</span> motor slot does not have a\n\t\t\t\t\t\t\t\t\tdiag pin connected.\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</ErrorMessage>\n\t\t\t\t\t) : null;\n\t\t\t\t})\n\t\t\t\t.filter(Boolean);\n\t\t}\n\t\treturn null;\n\t}, [parsedPrinterConfiguration]);\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t{' '}\n\t\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">{props.name}</h3>\n\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">{props.description}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"space-y-4 text-zinc-700 dark:text-zinc-300\">\n\t\t\t\t\t{parsedPrinterConfiguration.success && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t{errors.length > 0 && (\n\t\t\t\t\t\t\t\t<div className=\"mt-2\">\n\t\t\t\t\t\t\t\t\t<ErrorMessage>\n\t\t\t\t\t\t\t\t\t\t{errors.map((e, i) => (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"mt-2\" key={i}>\n\t\t\t\t\t\t\t\t\t\t\t\t{e}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</ErrorMessage>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<AnimatedContainer className=\"mt-4\">\n\t\t\t\t\t\t\t\t<Disclosure as={Fragment}>\n\t\t\t\t\t\t\t\t\t{({ open }) => (\n\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t<Disclosure.Button as=\"div\" className=\"border-b border-zinc-100 py-4 dark:border-zinc-800\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"flex items-center space-x-2 text-base font-bold leading-7 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>General</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.controlboard != null && !controlboardDetected.data && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge color=\"yellow\">Has Warnings</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRightIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'h-6 w-6 transition-all duration-200 ease-in-out',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen ? 'rotate-90' : 'rotate-0',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Disclosure.Button>\n\t\t\t\t\t\t\t\t\t\t\t<Disclosure.Panel as=\"dl\" className=\"grid grid-cols-1 gap-x-4 gap-y-4 py-4 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Printer</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.printer != null\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `${parsedPrinterConfiguration.data.printer.manufacturer} ${parsedPrinterConfiguration.data.printer.name} ${Object.keys(parsedPrinterConfiguration.data.printer.sizes).length > 1 ? parsedPrinterConfiguration.data.size.x : ''}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'None selected'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"space-x-2 text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>Controlboard</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.controlboard && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge color={controlboardDetected.data === true ? 'green' : 'red'}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{controlboardDetected.data === true ? 'Detected' : 'Not detected'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.controlboard != null\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `${parsedPrinterConfiguration.data.controlboard.manufacturer} ${parsedPrinterConfiguration.data.controlboard.name}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'None selected'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tController cooling fan\n\t\t\t\t\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.controllerFan?.title ?? 'None selected'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.controlboard != null && !controlboardDetected.data && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<WarningMessage>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tThe controlboard you have selected does not seem to be connected, you can still save\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthe config and proceed to mainsail, but you will get an 'mcu' connection error.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</WarningMessage>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</Disclosure.Panel>\n\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</Disclosure>\n\t\t\t\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.toolheads.map((tool) => (\n\t\t\t\t\t\t\t\t\t\t<ConfirmToolhead key={tool.axis} toolOrAxis={tool.axis} />\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Disclosure as={Fragment} defaultOpen={false}>\n\t\t\t\t\t\t\t\t\t{({ open }) => (\n\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t<Disclosure.Button as=\"div\" className=\"border-b border-zinc-100 py-4 dark:border-zinc-800\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex cursor-pointer items-center justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"flex items-center space-x-2 text-base font-bold leading-7 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>Motion</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(motionErrors?.length ?? 0) > 0 && <Badge color=\"red\">Has Errors</Badge>}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRightIcon\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'h-6 w-6 transition-all duration-200 ease-in-out',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topen ? 'rotate-90' : 'rotate-0',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</Disclosure.Button>\n\t\t\t\t\t\t\t\t\t\t\t<Disclosure.Panel>\n\t\t\t\t\t\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 py-4 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPerformance mode\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.performanceMode ? 'Enabled' : 'Disabled'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tStealtchop\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.stealthchop ? 'Enabled' : 'Disabled'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tStandstill Stealth\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.standstillStealth ? 'Enabled' : 'Disabled'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 border-t border-zinc-100 py-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{parsedPrinterConfiguration.data.rails?.map((rail, i) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"sm:col-span-1\" key={i}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dt className=\"text-sm font-medium capitalize leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{rail.axis === PrinterAxis.extruder ? rail.axis : rail.axis.toLocaleUpperCase()} Motion\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tConfiguration\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dt>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dd className=\"mt-1 text-sm leading-6 text-zinc-600 dark:text-zinc-400 sm:mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{rail.driver.title} @ {rail.voltage}V\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{rail.stepper.title} @ {rail.current}A RMS\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"font-medium\">{rail.microstepping} microsteps</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t\t\t\t\t</Disclosure.Panel>\n\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</Disclosure>\n\n\t\t\t\t\t\t\t\t<div className=\"mb-5 mt-10 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\t\t\t\t\t\tConfiguration Files\n\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\t\t\t\tPlease review the changes to the configuration files.\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<dl className=\"gap-y-4py-4 grid grid-cols-1 gap-x-4 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t\t<div className=\" space-y-4 dark:border-zinc-700 sm:col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<FileChanges\n\t\t\t\t\t\t\t\t\t\t\tserializedConfig={parsedPrinterConfiguration.success ? serializedPrinterConfiguration : null}\n\t\t\t\t\t\t\t\t\t\t\tonFilesToIgnoreChange={setFilesToIgnore}\n\t\t\t\t\t\t\t\t\t\t\tonFilesToOverwriteChange={setFilesToOverwrite}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t\t<dl className=\"grid grid-cols-1 gap-x-4 gap-y-4 border-t border-zinc-100 py-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t\t\t\t\t<div className=\" space-y-4 dark:border-zinc-700 sm:col-span-2\">\n\t\t\t\t\t\t\t\t\t\t<InfoMessage>\n\t\t\t\t\t\t\t\t\t\t\tIf the above information is correct, go ahead and save the configuration. If not, go back and\n\t\t\t\t\t\t\t\t\t\t\tchange the configuration by clicking the steps in the \"Setup Progress\" panel.\n\t\t\t\t\t\t\t\t\t\t</InfoMessage>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t</AnimatedContainer>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<StepNavButtons\n\t\t\t\tleft={{ onClick: props.previousScreen }}\n\t\t\t\tright={{\n\t\t\t\t\tonClick: saveConfiguration,\n\t\t\t\t\tdisabled:\n\t\t\t\t\t\t!parsedPrinterConfiguration.success || (motionErrors?.length ?? 0) > 0 || requiresExplicitFileActions,\n\t\t\t\t\ttitle: requiresExplicitFileActions\n\t\t\t\t\t\t? 'You need to explicitly overwrite or ignore one or more files'\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tisLoading: saveConfigurationMutation.isLoading,\n\t\t\t\t\tlabel: 'Confirm and save',\n\t\t\t\t}}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport const ProceedToMainsail: React.FC<StepScreenProps> = (props) => {\n\tconst openMainsail = () => {\n\t\twindow.location.href = 'http://' + window.location.hostname;\n\t};\n\treturn (\n\t\t<>\n\t\t\t<div className=\"p-8\">\n\t\t\t\t{' '}\n\t\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">{props.name}</h3>\n\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">{props.description}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"space-y-4 text-zinc-700 dark:text-zinc-300\">\n\t\t\t\t\tNow that the base configuration has been saved, you can connect to your printer via Mainsail and start\n\t\t\t\t\tcalibrating your printer.\n\t\t\t\t\t<div className=\"mt-5\">\n\t\t\t\t\t\tYou can now continue to{' '}\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref=\"https://os.ratrig.com/docs/configuration#initial-configuration\"\n\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\trel=\"noreferrer\"\n\t\t\t\t\t\t\tclassName=\"cursor-pointer text-brand-700 hover:text-brand-600\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tthe next step in the documentation.\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<StepNavButtons\n\t\t\t\tleft={{ onClick: props.previousScreen }}\n\t\t\t\tright={{\n\t\t\t\t\tonClick: openMainsail,\n\t\t\t\t\tlabel: 'Open Mainsail',\n\t\t\t\t}}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport const WizardComplete: React.FC<StepScreenProps> = (props) => {\n\tconst { currentStep, screenProps } = useSteps({\n\t\tsteps: CompletionSteps,\n\t\tparentScreenProps: props,\n\t});\n\n\treturn currentStep.renderScreen({\n\t\t...screenProps,\n\t});\n};\n","import React, { useMemo } from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { ToolheadHelper } from '@/helpers/toolhead';\nimport { StepScreen, useSteps } from '@/hooks/useSteps';\nimport { LoadablePrinterToolheadsState } from '@/recoil/toolhead';\nimport { ToolheadConfiguration } from '@/zods/toolhead';\nimport { Spinner } from '@/components/common/spinner';\nimport { VerticalSteps } from '@/components/common/vertical-steps';\nimport { HardwareSelection } from '@/components/setup-steps/hardware-selection';\nimport { MCUPreparation } from '@/components/setup-steps/mcu-preparation';\nimport { PrinterSelection } from '@/components/setup-steps/printer-selection';\nimport { WifiSetup } from '@/components/setup-steps/wifi-setup';\nimport { WizardComplete } from '@/components/setup-steps/wizard-complete';\nimport { useSearchParams, useRouter } from 'next/navigation';\nimport { useLocalPathname } from '@/app/_hooks/navigation';\nimport { Card } from '@/components/common/card';\n\ninterface WizardProps {\n\tisConnectedToWifi?: boolean;\n\thasWifiInterface?: boolean;\n}\n\nconst makeSteps = (toolheads: ToolheadConfiguration<any>[], isConfigValid: boolean): StepScreen[] => {\n\tlet nextIndex = 0;\n\tconst getNextIndex = () => {\n\t\tnextIndex++;\n\t\treturn (nextIndex + '').padStart(2, '0');\n\t};\n\tconst result: StepScreen[] = [\n\t\t{\n\t\t\tid: getNextIndex(),\n\t\t\tname: 'Network connectivity',\n\t\t\tdescription: 'Setup Wifi or Ethernet',\n\t\t\thref: '#',\n\t\t\trenderScreen: (screenProps) => <WifiSetup {...screenProps} key={screenProps.key} />,\n\t\t},\n\t\t{\n\t\t\tid: getNextIndex(),\n\t\t\tname: 'Printer Selection',\n\t\t\tdescription: 'Select your printer',\n\t\t\thref: '#',\n\t\t\trenderScreen: (screenProps) => <PrinterSelection {...screenProps} key={screenProps.key} />,\n\t\t},\n\t\t{\n\t\t\tid: getNextIndex(),\n\t\t\tname: 'Control board preparation',\n\t\t\tcanBeSkippedTo: isConfigValid,\n\t\t\tdescription: 'Firmware flashing and connectivity',\n\t\t\thref: '#',\n\t\t\trenderScreen: (screenProps) => <MCUPreparation {...screenProps} key={screenProps.key} />,\n\t\t},\n\t];\n\ttoolheads.forEach((toolhead) => {\n\t\tconst th = new ToolheadHelper(toolhead);\n\t\tresult.push({\n\t\t\tid: getNextIndex(),\n\t\t\tname: `${th.getToolCommand()} Toolboard Preparation`,\n\t\t\tcanBeSkippedTo: isConfigValid,\n\t\t\tdescription: `Firmware flashing and connectivity for toolboard on ${th.getDescription().toLocaleLowerCase()}`,\n\t\t\thref: '#',\n\t\t\trenderScreen: (screenProps) => (\n\t\t\t\t<MCUPreparation {...screenProps} key={screenProps.key} toolOrAxis={toolhead.axis} />\n\t\t\t),\n\t\t});\n\t});\n\tresult.push({\n\t\tid: getNextIndex(),\n\t\tname: 'Hardware Selection',\n\t\tcanBeSkippedTo: isConfigValid,\n\t\tdescription: 'Select your printer',\n\t\thref: '#',\n\t\trenderScreen: (screenProps) => <HardwareSelection {...screenProps} key={screenProps.key} />,\n\t});\n\tresult.push({\n\t\tid: getNextIndex(),\n\t\tname: 'Confirm your setup',\n\t\tcanBeSkippedTo: isConfigValid,\n\t\tdescription: 'Confirm your setup and start printing',\n\t\thref: '#',\n\t\trenderScreen: (screenProps) => <WizardComplete {...screenProps} key={screenProps.key} />,\n\t});\n\t// {\n\t// \tid: '06',\n\t// \tname: 'Kinematics',\n\t// \tdescription: 'Check directionality of your steppers',\n\t// \thref: '#',\n\t// \trenderScreen: (screenProps) => <CoreXYKinematics {...screenProps} />,\n\t// },\n\t// {\n\t// \tid: '07',\n\t// \tname: 'Heaters',\n\t// \tdescription: 'Calibrate your heaters',\n\t// \thref: '#',\n\t// \trenderScreen: () => null,\n\t// },\n\treturn result;\n};\n\nconst LoadScreen: React.FC = () => {\n\treturn (\n\t\t<div className=\"p-8\">\n\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-700\">\n\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\tLoading printer configuration...\n\t\t\t\t</h3>\n\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\tPlease wait while RatOS loads your printer configuration\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div className=\"mt-4 flex h-48 items-center justify-center\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport const SetupSteps: React.FC<WizardProps> = (props) => {\n\tconst searchParams = useSearchParams();\n\tconst router = useRouter();\n\tconst pathname = useLocalPathname();\n\tconst ths = useRecoilValue(LoadablePrinterToolheadsState);\n\tconst steps = useMemo(() => makeSteps(ths, ths?.length > 0), [ths]);\n\tconst uriStep = searchParams?.get('step') ? parseInt(searchParams?.get('step') ?? '', 10) : null;\n\tconst defaultStep = props.hasWifiInterface && !props.isConnectedToWifi ? 0 : 1;\n\n\tconst { currentStepIndex, setCurrentStepIndex, screenProps, currentStep } = useSteps({\n\t\tstep: uriStep != null && uriStep < steps.length ? uriStep : defaultStep,\n\t\tonStepChange: (step) => {\n\t\t\t'use client';\n\t\t\trouter.push(`${pathname}?step=${step}`, undefined);\n\t\t\twindow.scrollTo(0, 0);\n\t\t},\n\t\tsteps,\n\t});\n\n\tconst isReady = uriStep == null || uriStep === currentStepIndex;\n\n\treturn (\n\t\t<div className=\"mx-auto mt-8 grid max-w-3xl grid-cols-1 gap-4 px-4 lg:max-w-7xl lg:grid-flow-col-dense lg:grid-cols-3\">\n\t\t\t<div className=\"lg:col-span-2 lg:col-start-1\">\n\t\t\t\t<Card>\n\t\t\t\t\t<React.Suspense fallback={<LoadScreen />}>\n\t\t\t\t\t\t{isReady ? currentStep.renderScreen(screenProps) : <LoadScreen />}\n\t\t\t\t\t</React.Suspense>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t\t<div className=\"space-y-6 lg:col-span-1 lg:col-start-3\">\n\t\t\t\t<Card className=\"p-8\">\n\t\t\t\t\t<div className=\"mb-5 border-b border-zinc-200 pb-5 dark:border-zinc-800\">\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium leading-6 text-zinc-900 dark:text-zinc-100\">Setup Progress</h3>\n\t\t\t\t\t</div>\n\t\t\t\t\t<VerticalSteps\n\t\t\t\t\t\tsteps={steps}\n\t\t\t\t\t\tscreenProps={screenProps}\n\t\t\t\t\t\tcurrentStepIndex={currentStepIndex}\n\t\t\t\t\t\tsetCurrentStepIndex={setCurrentStepIndex}\n\t\t\t\t\t/>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","'use client';\n\nimport { KlippyStateBadge } from '@/components/klippy-state-badge';\nimport { MoonrakerStateBadge } from '@/components/moonraker-state-badge';\nimport { trpc } from '@/helpers/trpc';\nimport React from 'react';\nimport { SetupSteps } from '@/components/setup-steps';\n\ninterface WizardProps {\n\tisConnectedToWifi?: boolean;\n\thasWifiInterface?: boolean;\n}\n\nexport const Wizard: React.FC<WizardProps> = (props) => {\n\tconst { data: version } = trpc.version.useQuery(undefined, { keepPreviousData: true, refetchOnMount: false });\n\tconst { data: ip } = trpc.ipAddress.useQuery(undefined, { keepPreviousData: true, refetchOnMount: false });\n\treturn (\n\t\t<>\n\t\t\t{/* Page header */}\n\t\t\t<div className=\"mx-auto max-w-3xl px-4 md:flex md:items-center md:justify-between md:space-x-4 lg:max-w-7xl\">\n\t\t\t\t<div className=\"flex items-center\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h1 className=\"text-2xl font-bold text-zinc-900 dark:text-zinc-100\">Printer Setup</h1>\n\t\t\t\t\t\t<p className=\"text-sm font-medium text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t\tRatOS {version} @ {ip}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-6 flex flex-col items-stretch md:mt-0\">\n\t\t\t\t\t<div className=\"flex space-x-1 sm:flex-row-reverse sm:justify-end sm:space-x-2 sm:space-y-0 md:flex-row\">\n\t\t\t\t\t\t<KlippyStateBadge />\n\t\t\t\t\t\t<MoonrakerStateBadge />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{/* Page body */}\n\t\t\t<SetupSteps {...props} />\n\t\t</>\n\t);\n};\n","import { useDebounce } from '@/app/_hooks/debounce';\nimport useResizeObserver from '@react-hook/resize-observer';\nimport { motion } from 'framer-motion';\nimport { useState, useRef, PropsWithChildren, useCallback, useLayoutEffect, useEffect } from 'react';\nimport { twJoin } from 'tailwind-merge';\n\nexport const AnimatedContainer = (props: PropsWithChildren<{ containerClassName?: string; className?: string }>) => {\n\tconst [height, setHeight] = useState(0);\n\tconst heightRef = useRef(height);\n\theightRef.current = height;\n\tconst [isOverflowVisible, setIsOverflowVisible] = useState(false);\n\tconst isOverflowVisibleRef = useRef(isOverflowVisible);\n\tisOverflowVisibleRef.current = isOverflowVisible;\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\n\tuseResizeObserver(containerRef, (entry) => {\n\t\tif (entry.contentRect.height === heightRef.current) {\n\t\t\treturn;\n\t\t}\n\t\tsetHeight(entry.contentRect.height);\n\t});\n\n\tconst onComplete = useDebounce(\n\t\tuseCallback(() => {\n\t\t\tsetIsOverflowVisible(true);\n\t\t}, []),\n\t\t200,\n\t\ttrue,\n\t);\n\tconst onStart = useDebounce(\n\t\tuseCallback(() => {\n\t\t\tsetIsOverflowVisible(false);\n\t\t}, []),\n\t\t200,\n\t\ttrue,\n\t);\n\n\treturn (\n\t\t<motion.div\n\t\t\tclassName={twJoin(props.containerClassName, isOverflowVisible ? 'overflow-visible' : 'overflow-hidden')}\n\t\t\tstyle={{ height }}\n\t\t\tonAnimationComplete={onComplete}\n\t\t\tonAnimationStart={onStart}\n\t\t\tanimate={{ height }}\n\t\t>\n\t\t\t<div ref={containerRef} className={props.className}>\n\t\t\t\t{props.children}\n\t\t\t</div>\n\t\t</motion.div>\n\t);\n};\n","'use client';\nimport Link, { LinkProps } from 'next/link';\nimport { twJoin, twMerge } from 'tailwind-merge';\nimport React, { Fragment, forwardRef } from 'react';\nimport { VariantProps, cva } from 'class-variance-authority';\nimport { Menu, Transition } from '@headlessui/react';\nimport { ChevronDownIcon } from '@heroicons/react/20/solid';\nimport { Route } from 'next';\n\nexport const buttonVariants = cva(\n\t'inline-flex gap-2 items-center justify-center border font-semibold rounded-md shadow-sm focus:outline-none focus:ring-2 capitalize relative active:scale-95 transition-all',\n\t{\n\t\tvariants: {\n\t\t\tvariant: {\n\t\t\t\tdanger: twJoin(\n\t\t\t\t\t'text-red-50 bg-red-500/70 hover:bg-red-600 border-transparent focus:ring-offset-2 focus:ring-red-600 dark:focus:ring-offset-zinc-900',\n\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--red-900)),_0px_1px_0px_0px_hsl(var(--red-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\twarning:\n\t\t\t\t\t'text-white bg-yellow-500 hover:bg-yellow-600 border-transparent focus:ring-offset-2 focus:ring-yellow-600 dark:focus:ring-offset-zinc-900',\n\t\t\t\tinfo: twJoin(\n\t\t\t\t\t'text-blue-50 bg-sky-400/70 hover:bg-sky-600 border-transparent focus:ring-offset-2 focus:ring-sky-600 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--sky-900)),_0px_1px_0px_0px_hsl(var(--sky-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\tprimary: twJoin(\n\t\t\t\t\t'text-white bg-brand-400/50 hover:bg-brand-700 border-transparent focus:ring-offset-2 focus:ring-brand-600 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--brand-900)),_0px_1px_0px_0px_hsl(var(--brand-400)_/_50%)_inset]',\n\t\t\t\t),\n\t\t\t\tsuccess:\n\t\t\t\t\t'text-green-100 bg-green-500 hover:bg-green-600 border-transparent focus:ring-offset-2 focus:ring-green-600 dark:focus:ring-offset-zinc-900',\n\t\t\t\tindeterminate: twJoin(\n\t\t\t\t\t'border-transparent bg-zinc-100 hover:bg-zinc-200 text-black dark:text-zinc-300 dark:bg-zinc-800 dark:transparent dark:hover:bg-zinc-700 dark:hover:text-zinc-100 dark:hover:transparent focus:ring-offset-2 focus:ring-green-600 dark:focus:ring-offset-zinc-900',\n\t\t\t\t\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t\t\t\t\t'dark:before:-inset-px dark:before:rounded-lg',\n\t\t\t\t\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_hsl(var(--zinc-900)),_0px_1px_0px_0px_hsl(var(--zinc-400)_/_20%)_inset]',\n\t\t\t\t),\n\t\t\t\toutline:\n\t\t\t\t\t'border-zinc-700 shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 hover:bg-zinc-500/30 hover:border-zinc-500/50 hover:text-zinc-800 dark:hover:text-zinc-200 focus:ring-offset-2 focus:ring-zinc-900 dark:focus:ring-offset-zinc-100',\n\t\t\t\tplain:\n\t\t\t\t\t'border-transparent shadow-none bg-transparent text-zinc-700 dark:text-zinc-300 hover:underline hover:text-zinc-800 dark:hover:text-zinc-200 focus:ring-offset-2 focus:ring-zinc-900 dark:focus:ring-offset-zinc-100',\n\t\t\t},\n\t\t\tdisabled: {\n\t\t\t\ttrue: 'opacity-60 cursor-not-allowed',\n\t\t\t},\n\t\t\tsize: {\n\t\t\t\tsm: 'px-3 py-1 text-xs',\n\t\t\t\tlg: 'px-6 py-3 text-lg',\n\t\t\t\tdefault: 'px-4 py-2 text-sm',\n\t\t\t\ticon: 'h-9 w-9',\n\t\t\t\t'icon-sm': 'h-6 w-6',\n\t\t\t\t'icon-xs': 'h-4 w-4',\n\t\t\t},\n\t\t},\n\t\tcompoundVariants: [\n\t\t\t{\n\t\t\t\tvariant: 'primary',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-brand-400/50',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'danger',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-red-500/70',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'warning',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-yellow-500',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'indeterminate',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-zinc-100 dark:hover:bg-zinc-800',\n\t\t\t},\n\t\t\t{\n\t\t\t\tvariant: 'info',\n\t\t\t\tdisabled: true,\n\t\t\t\tclass: 'hover:bg-sky-400/70',\n\t\t\t},\n\t\t],\n\t\tdefaultVariants: {\n\t\t\tvariant: 'primary',\n\t\t\tsize: 'default',\n\t\t\tdisabled: false,\n\t\t},\n\t},\n);\n\nexport type ButtonVariantProps = VariantProps<typeof buttonVariants>;\nexport type Intents = NonNullable<Required<ButtonVariantProps>['variant']>;\n\nexport interface ButtonProps<T extends string>\n\textends React.PropsWithChildren<ButtonVariantProps & React.ButtonHTMLAttributes<HTMLButtonElement>> {\n\tonClick?: () => void;\n\tclassName?: string;\n\ttarget?: string;\n\tasChild?: boolean;\n\thref?: Route<T> | URL;\n\ttitle?: string;\n\trel?: string;\n\tdropdownItems?: {\n\t\tonClick: () => void;\n\t\ttitle: string;\n\t}[];\n}\n\nexport const Button = forwardRef(function Button<T extends string>(\n\tprops: ButtonProps<T>,\n\tref: React.ForwardedRef<HTMLButtonElement & HTMLAnchorElement>,\n) {\n\tconst {\n\t\tvariant,\n\t\tdisabled,\n\t\tsize,\n\t\thref,\n\t\ttarget,\n\t\tonClick,\n\t\ttitle,\n\t\trel,\n\t\tdropdownItems,\n\t\tclassName,\n\t\tchildren,\n\t\t...forwardProps\n\t} = props;\n\tconst buttonClasses = twMerge(buttonVariants({ variant: variant, disabled: disabled, size: size }), className);\n\tif (href) {\n\t\treturn (\n\t\t\t<Link<T>\n\t\t\t\thref={href}\n\t\t\t\tref={ref}\n\t\t\t\tclassName={buttonClasses}\n\t\t\t\ttarget={target}\n\t\t\t\tonClick={onClick}\n\t\t\t\ttitle={title}\n\t\t\t\trel={rel}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</Link>\n\t\t);\n\t}\n\tif (dropdownItems && onClick == null) {\n\t\treturn (\n\t\t\t<Menu as=\"span\" className=\"relative inline-block text-left\">\n\t\t\t\t<Menu.Button className={buttonClasses} title={title} disabled={!!disabled}>\n\t\t\t\t\t{children}\n\t\t\t\t\t<ChevronDownIcon className=\"-mr-1 ml-2 h-5 w-5\" aria-hidden=\"true\" />\n\t\t\t\t</Menu.Button>\n\n\t\t\t\t<Transition\n\t\t\t\t\tas={Fragment}\n\t\t\t\t\tenter=\"transition ease-out duration-100\"\n\t\t\t\t\tenterFrom=\"transform opacity-0 scale-95\"\n\t\t\t\t\tenterTo=\"transform opacity-100 scale-100\"\n\t\t\t\t\tleave=\"transition ease-in duration-75\"\n\t\t\t\t\tleaveFrom=\"transform opacity-100 scale-100\"\n\t\t\t\t\tleaveTo=\"transform opacity-0 scale-95\"\n\t\t\t\t>\n\t\t\t\t\t<Menu.Items className=\"absolute right-0 z-10 mt-2 w-56 origin-top-right divide-y divide-zinc-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none dark:divide-zinc-800 dark:bg-zinc-900 dark:shadow-black dark:ring-zinc-800\">\n\t\t\t\t\t\t{dropdownItems.map((item) => (\n\t\t\t\t\t\t\t<div className=\"py-1\" key={item.title}>\n\t\t\t\t\t\t\t\t<Menu.Item>\n\t\t\t\t\t\t\t\t\t{({ active }) => (\n\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\tonClick={item.onClick}\n\t\t\t\t\t\t\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\t\t\t\t\t\t\tactive\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-zinc-100 text-zinc-900 dark:bg-zinc-800 dark:text-zinc-100'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-zinc-700 dark:text-zinc-300',\n\t\t\t\t\t\t\t\t\t\t\t\t'block cursor-pointer break-words px-4 py-2 text-sm',\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{item.title}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</Menu.Item>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</Menu.Items>\n\t\t\t\t</Transition>\n\t\t\t</Menu>\n\t\t);\n\t}\n\treturn (\n\t\t<button\n\t\t\tref={ref}\n\t\t\tclassName={buttonClasses}\n\t\t\tonClick={disabled ? undefined : onClick}\n\t\t\ttitle={title}\n\t\t\t{...forwardProps}\n\t\t>\n\t\t\t{children}\n\t\t</button>\n\t);\n});\n","import { cva } from 'class-variance-authority';\nimport React from 'react';\n\nconst cardVariants = cva([\n\t'relative rounded-lg  bg-white dark:bg-zinc-900/60',\n\t'shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]',\n\t'dark:before:-inset-px dark:before:rounded-xl',\n\t'dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_rgba(0,_0,_0,_0.20),_0px_1px_0px_0px_rgba(255,_255,_255,_0.07)_inset]',\n]);\n\ntype CardProps = React.PropsWithChildren<{\n\tclassName?: string;\n}>;\n\nexport const Card: React.FC<CardProps> = (props) => {\n\treturn <div className={cardVariants({ className: props.className })}>{props.children}</div>;\n};\n","import { XCircleIcon } from '@heroicons/react/24/solid';\nimport React from 'react';\nimport { twMerge } from 'tailwind-merge';\nimport { Banner } from '@/components/common/banner';\n\nexport type ErrorMessageProps = React.PropsWithChildren<{\n\ttitle?: string;\n\tclassName?: string;\n}>;\n\nexport const ErrorMessage: React.FC<ErrorMessageProps> = (props) => {\n\treturn (\n\t\t<Banner\n\t\t\tcolor=\"red\"\n\t\t\tIcon={XCircleIcon}\n\t\t\ttitle={props.title ? 'Error: ' + props.title : 'Error'}\n\t\t\tclassName={twMerge(props.className, 'whitespace-pre-wrap')}\n\t\t>\n\t\t\t{props.children}\n\t\t</Banner>\n\t);\n};\n","import { Spinner } from '@/components/common/spinner';\nimport { twJoin } from 'tailwind-merge';\n\nexport const FullLoadScreen = (props: { className?: string }) => {\n\treturn (\n\t\t<div className={twJoin('flex h-full w-full flex-1 items-center justify-center', props.className)}>\n\t\t\t<Spinner className=\"h-8 w-8\" />\n\t\t</div>\n\t);\n};\n","'use client';\nimport { useIsClient } from '@/hooks/isClient';\nimport dynamic from 'next/dynamic';\nimport React, { lazy } from 'react';\nimport { FullLoadScreen } from '@/components/common/full-load-screen';\nexport const NoSSR = (props: React.PropsWithChildren<{ fallback?: React.ReactNode }>) => {\n\tconst isClient = useIsClient();\n\treturn isClient ? <DynamicImport>{props.children}</DynamicImport> : props.fallback ?? <FullLoadScreen />;\n};\nconst DynamicImport = lazy(() =>\n\tPromise.resolve({ default: (props: React.PropsWithChildren) => <>{props.children}</> }),\n);\n","import { Switch } from '@headlessui/react';\nimport React from 'react';\nimport { twJoin, twMerge } from 'tailwind-merge';\n\ninterface ToggleProps {\n\tlabel: string;\n\tonLabel?: string;\n\tdescription?: string;\n\tvalue: boolean;\n\tonChange: (value: boolean) => void;\n}\n\nexport const Toggle: React.FC<ToggleProps> = (props) => {\n\treturn (\n\t\t<Switch.Group as=\"div\" className=\"flex items-center justify-between gap-x-2\">\n\t\t\t<span className=\"flex flex-grow flex-col\">\n\t\t\t\t<Switch.Label\n\t\t\t\t\tas=\"span\"\n\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t'text-sm font-medium leading-6 text-zinc-700 dark:text-zinc-300',\n\t\t\t\t\t\tprops.onLabel && props.value && 'opacity-70',\n\t\t\t\t\t\tprops.onLabel && !props.value && 'text-brand-700 dark:text-brand-500',\n\t\t\t\t\t)}\n\t\t\t\t\tpassive\n\t\t\t\t>\n\t\t\t\t\t{props.label}\n\t\t\t\t</Switch.Label>\n\t\t\t\t{props.description && (\n\t\t\t\t\t<Switch.Description as=\"span\" className=\"text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\t{props.description}\n\t\t\t\t\t</Switch.Description>\n\t\t\t\t)}\n\t\t\t</span>\n\t\t\t<Switch\n\t\t\t\tchecked={props.value}\n\t\t\t\tonChange={props.onChange}\n\t\t\t\tclassName={twJoin(\n\t\t\t\t\tprops.value && props.onLabel == null ? 'bg-brand-600' : 'bg-zinc-200 dark:bg-zinc-950/50',\n\t\t\t\t\t'relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none',\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<span\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\tclassName={twJoin(\n\t\t\t\t\t\tprops.value ? 'translate-x-5' : 'translate-x-0',\n\t\t\t\t\t\t'pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow-md shadow-black/20 ring-0 transition duration-200 ease-in-out dark:border-t dark:border-zinc-600 dark:bg-zinc-700 dark:shadow-black/100 ',\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Switch>\n\t\t\t{props.onLabel && (\n\t\t\t\t<span className=\"flex flex-grow flex-col\">\n\t\t\t\t\t<Switch.Label\n\t\t\t\t\t\tas=\"span\"\n\t\t\t\t\t\tclassName={twMerge(\n\t\t\t\t\t\t\t'text-sm font-medium leading-6 text-zinc-700 dark:text-zinc-300',\n\t\t\t\t\t\t\tprops.onLabel && !props.value && 'opacity-70',\n\t\t\t\t\t\t\tprops.onLabel && props.value && 'text-brand-700 dark:text-brand-500',\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tpassive\n\t\t\t\t\t>\n\t\t\t\t\t\t{props.onLabel}\n\t\t\t\t\t</Switch.Label>\n\t\t\t\t</span>\n\t\t\t)}\n\t\t</Switch.Group>\n\t);\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport { useToolheadConfiguration } from '@/hooks/useToolheadConfiguration';\nimport { stringToTitleObject } from '@/utils/serialization';\nimport { ToolOrAxis, ToolheadConfiguration } from '@/zods/toolhead';\nimport { Dropdown, DropdownWithPrinterQuery } from '@/components/forms/dropdown';\nimport { Spinner } from '@/components/common/spinner';\nimport { twMerge } from 'tailwind-merge';\nimport { badgeBackgroundColorStyle, badgeBorderColorStyle, badgeTextColorStyle } from '@/components/common/badge';\nimport { WarningMessage } from '@/components/warning-message';\nimport { Nozzle } from '@/zods/hardware';\nimport { TextInput } from '@/components/forms/text-input';\nimport { z } from 'zod';\n\ninterface ToolheadSettingsProps {\n\ttoolOrAxis: ToolOrAxis;\n}\n\ntype ToolheadSettingsErrors = z.typeToFlattenedError<ToolheadConfiguration<any>>;\n\nexport const ToolheadSettings: React.FC<ToolheadSettingsProps> = (props) => {\n\tconst { toolhead, setToolhead } = useToolheadConfiguration(props.toolOrAxis);\n\tconst [errors, setErrors] = useState<ToolheadSettingsErrors | null>(null);\n\n\tconst setToolheadField = useCallback(\n\t\t<F extends keyof ToolheadConfiguration<any>, V extends ToolheadConfiguration<any>[F]>(field: F, value: V): void => {\n\t\t\tconst updated = toolhead.getChangeSet({ [field]: value });\n\t\t\tif (updated?.success && updated.data && Object.keys(updated.data).length > 0) {\n\t\t\t\tconst ret = setToolhead({ ...toolhead.getConfig(), ...updated.data });\n\t\t\t\tret.then((res) => {\n\t\t\t\t\tif (!res.success) {\n\t\t\t\t\t\tsetErrors(res.error.formErrors);\n\t\t\t\t\t} else if (res.data != null) {\n\t\t\t\t\t\tsetErrors(null);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (!updated?.success) {\n\t\t\t\tsetErrors(updated?.error.formErrors ?? null);\n\t\t\t} else {\n\t\t\t\tsetErrors(null);\n\t\t\t}\n\t\t},\n\t\t[toolhead, setToolhead],\n\t);\n\n\tif (toolhead == null) {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"mt-4\">\n\t\t\t\t\t<h3 className=\"text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100\">Toolhead...</h3>\n\t\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\t\tConfigure the hardware installed on your toolhead...\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-4 border-t border-zinc-100 pt-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t\t<div className=\"mb-4 flex h-96 items-center justify-center\">\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className={twMerge(badgeBorderColorStyle({ color: 'gray' }), 'col-span-1 rounded-md border p-4 shadow-lg')}>\n\t\t\t<div\n\t\t\t\tclassName={twMerge(\n\t\t\t\t\tbadgeBackgroundColorStyle({ color: 'gray' }),\n\t\t\t\t\tbadgeTextColorStyle({ color: 'gray' }),\n\t\t\t\t\tbadgeBorderColorStyle({ color: 'gray' }),\n\t\t\t\t\t'-m-4 mb-0 rounded-t-md border-b p-4',\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<h3 className=\"text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100\">\n\t\t\t\t\tToolhead {toolhead.getToolCommand()} Hardware\n\t\t\t\t</h3>\n\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm\">\n\t\t\t\t\tConfigure the hardware installed on {toolhead.getDescription().toLocaleLowerCase()}\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div className=\"grid grid-cols-1 gap-4 pt-4 sm:grid-cols-2\">\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tquery=\"hotends\"\n\t\t\t\t\t\tvalue={toolhead.getHotend()}\n\t\t\t\t\t\terror={errors?.fieldErrors.hotend?.join('\\n')}\n\t\t\t\t\t\tlabel=\"Hotend\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('hotend', value)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tlabel=\"Hotend Thermistor\"\n\t\t\t\t\t\tquery=\"thermistors\"\n\t\t\t\t\t\terror={errors?.fieldErrors.thermistor?.join('\\n')}\n\t\t\t\t\t\tonSelect={(thermistor) => setToolheadField('thermistor', thermistor.id)}\n\t\t\t\t\t\tvalue={stringToTitleObject(toolhead.getThermistor())}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<Dropdown\n\t\t\t\t\t\tlabel=\"Nozzle Type\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('nozzle', { ...toolhead.getNozzle(), type: value.id })}\n\t\t\t\t\t\terror={errors?.fieldErrors.nozzle?.join('\\n')}\n\t\t\t\t\t\toptions={Object.values(Nozzle.shape.type.Values).map(stringToTitleObject)}\n\t\t\t\t\t\tvalue={stringToTitleObject(toolhead.getNozzle().type)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tlabel=\"Nozzle Diameter\"\n\t\t\t\t\t\terror={errors?.fieldErrors.nozzle?.join('\\n')}\n\t\t\t\t\t\tvalue={toolhead.getNozzle().diameter}\n\t\t\t\t\t\tonChange={(value) => setToolheadField('nozzle', { ...toolhead.getNozzle(), diameter: value })}\n\t\t\t\t\t\tinputMode=\"decimal\"\n\t\t\t\t\t\tstep={0.1}\n\t\t\t\t\t\tmin={0.2}\n\t\t\t\t\t\tmax={1.8}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{toolhead.getToolboard()?.alternativePT1000Resistor && toolhead.getThermistor() === 'PT1000' && (\n\t\t\t\t\t<div className=\"col-span-2\">\n\t\t\t\t\t\t<WarningMessage title=\"RatOS uses your toolboards alternate pullup resistor setting\">\n\t\t\t\t\t\t\tYour toolboard has an option to use a separate pullup resistor for PT1000 sensors. This is usually done by\n\t\t\t\t\t\t\tinserting a jumper. Make sure you read the documentation for your board on how to enable the alternative\n\t\t\t\t\t\t\tresistor or you'll get ADC temperature errors in klipper.\n\t\t\t\t\t\t</WarningMessage>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tlabel=\"Extruder\"\n\t\t\t\t\t\tquery=\"extruders\"\n\t\t\t\t\t\terror={errors?.fieldErrors.extruder?.join('\\n')}\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('extruder', value)}\n\t\t\t\t\t\tvalue={toolhead.getExtruder()}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tlabel=\"Probe\"\n\t\t\t\t\t\tquery=\"probes\"\n\t\t\t\t\t\terror={errors?.fieldErrors.probe?.join('\\n')}\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('probe', value)}\n\t\t\t\t\t\tvalue={toolhead.getProbe()}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tvars={{ toolOrAxis: toolhead.getTool(), config: {} }}\n\t\t\t\t\t\tserializedPrinterConfiguration=\"config\"\n\t\t\t\t\t\tlabel=\"X Endstop\"\n\t\t\t\t\t\terror={errors?.fieldErrors.xEndstop?.join('\\n')}\n\t\t\t\t\t\tquery=\"xEndstops\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('xEndstop', value)}\n\t\t\t\t\t\tvalue={toolhead.getXEndstop()}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tvars={{ toolOrAxis: toolhead.getTool(), config: {} }}\n\t\t\t\t\t\tserializedPrinterConfiguration=\"config\"\n\t\t\t\t\t\tlabel=\"Y Endstop\"\n\t\t\t\t\t\terror={errors?.fieldErrors.yEndstop?.join('\\n')}\n\t\t\t\t\t\tquery=\"yEndstops\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('yEndstop', value)}\n\t\t\t\t\t\tvalue={toolhead.getYEndstop()}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tvars={{ toolOrAxis: toolhead.getTool(), config: {} }}\n\t\t\t\t\t\tserializedPrinterConfiguration=\"config\"\n\t\t\t\t\t\terror={errors?.fieldErrors.partFan?.join('\\n')}\n\t\t\t\t\t\tlabel=\"Part cooling fan\"\n\t\t\t\t\t\tquery=\"partFanOptions\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('partFan', value)}\n\t\t\t\t\t\tvalue={toolhead.getPartFan()}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tvars={{ toolOrAxis: toolhead.getTool(), config: {} }}\n\t\t\t\t\t\tserializedPrinterConfiguration=\"config\"\n\t\t\t\t\t\terror={errors?.fieldErrors.hotendFan?.join('\\n')}\n\t\t\t\t\t\tlabel=\"Hotend fan\"\n\t\t\t\t\t\tquery=\"hotendFanOptions\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('hotendFan', value)}\n\t\t\t\t\t\tvalue={toolhead.getHotendFan()}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"mt-4 border-t border-zinc-100 pt-4 dark:border-zinc-700\">\n\t\t\t\t<h3 className=\"text-base font-medium leading-7 text-zinc-900 dark:text-zinc-100\">Accelerometers</h3>\n\t\t\t\t<p className=\"mt-2 max-w-4xl text-sm text-zinc-500 dark:text-zinc-400\">\n\t\t\t\t\tYou can use the same accelerometer for both axes. If you don't plan on using an accelerometer, you can skip\n\t\t\t\t\tthis and come back later if you change your mind.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div className=\"mt-4 grid grid-cols-1 gap-4 border-t border-zinc-100 pt-4 dark:border-zinc-700 sm:grid-cols-2\">\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tvars={{ toolOrAxis: toolhead.getTool(), config: {} }}\n\t\t\t\t\t\tserializedPrinterConfiguration=\"config\"\n\t\t\t\t\t\tlabel=\"X axis accelerometer\"\n\t\t\t\t\t\terror={errors?.fieldErrors.xAccelerometer?.join('\\n')}\n\t\t\t\t\t\tquery=\"xAccelerometerOptions\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('xAccelerometer', value)}\n\t\t\t\t\t\tvalue={toolhead.getXAccelerometer()}\n\t\t\t\t\t\tsort={false}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownWithPrinterQuery\n\t\t\t\t\t\tvars={{ toolOrAxis: toolhead.getTool(), config: {} }}\n\t\t\t\t\t\tserializedPrinterConfiguration=\"config\"\n\t\t\t\t\t\tlabel=\"Y axis accelerometer\"\n\t\t\t\t\t\terror={errors?.fieldErrors.yAccelerometer?.join('\\n')}\n\t\t\t\t\t\tquery=\"yAccelerometerOptions\"\n\t\t\t\t\t\tonSelect={(value) => setToolheadField('yAccelerometer', value)}\n\t\t\t\t\t\tvalue={toolhead.getYAccelerometer()}\n\t\t\t\t\t\tsort={false}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","import { ExclamationCircleIcon } from '@heroicons/react/24/solid';\nimport React from 'react';\nimport { Banner } from '@/components/common/banner';\n\ninterface WarningMessageProps extends React.PropsWithChildren {\n\ttitle?: string;\n\tclassName?: string;\n}\n\nexport const WarningMessage: React.FC<WarningMessageProps> = (props) => {\n\treturn (\n\t\t<Banner\n\t\t\tcolor=\"yellow\"\n\t\t\tIcon={ExclamationCircleIcon}\n\t\t\ttitle={props.title ? 'Warning: ' + props.title : 'Warning'}\n\t\t\tclassName={props.className}\n\t\t>\n\t\t\t{props.children}\n\t\t</Banner>\n\t);\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\n\nexport const useChangeEffect = (deps: unknown[], clearAfter?: number, resetTimeoutOnChange: boolean = false) => {\n\tconst [hasChanged, setHasChanged] = useState(0);\n\tconst lastDeps = useRef([...deps]);\n\tuseEffect(() => {\n\t\tlet changed = false;\n\t\tlastDeps.current.forEach((dep, i) => {\n\t\t\tif (dep !== deps[i]) {\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\tif (changed) {\n\t\t\tsetHasChanged((hasChanged) => (resetTimeoutOnChange ? hasChanged + 1 : 1));\n\t\t}\n\t\tlastDeps.current = [...deps];\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [...deps]);\n\n\tconst clear = useCallback(() => {\n\t\tsetHasChanged(0);\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (clearAfter != null && hasChanged > 0) {\n\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\tsetHasChanged(0);\n\t\t\t}, clearAfter);\n\t\t\treturn () => {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t};\n\t\t}\n\t\treturn;\n\t}, [clearAfter, hasChanged]);\n\n\treturn [hasChanged > 0, clear] as const;\n};\n\nexport const useDelayedChangeEffect = (\n\tdeps: unknown[],\n\tdelay: number,\n\tclearAfter?: number,\n\tresetTimeoutOnChange: boolean = false,\n) => {\n\tconst [changeCount, setChangeCount] = useState(0);\n\tconst lastDeps = useRef([...deps]);\n\tconst timeout = useRef<number | null>(null);\n\tuseEffect(() => {\n\t\tif (typeof window === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tlet changed = false;\n\t\tlastDeps.current.forEach((dep, i) => {\n\t\t\tif (dep !== deps[i]) {\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t});\n\t\tif (changed) {\n\t\t\tconst trigger = () => setChangeCount((hasChanged) => (resetTimeoutOnChange ? hasChanged + 1 : 1));\n\t\t\ttimeout.current = window.setTimeout(() => {\n\t\t\t\ttrigger();\n\t\t\t\ttimeout.current = null;\n\t\t\t}, delay);\n\t\t}\n\t\tlastDeps.current = [...deps];\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [...deps]);\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (timeout.current) {\n\t\t\t\tclearTimeout(timeout.current);\n\t\t\t}\n\t\t};\n\t}, []);\n\tconst [hasChanged, clear] = useChangeEffect([changeCount], clearAfter, resetTimeoutOnChange);\n\treturn [hasChanged, clear] as const;\n};\n","'use client';\n\nimport { useCallback, useEffect, useState } from 'react';\nimport { atom, useSetRecoilState } from 'recoil';\nimport { useMoonraker } from '@/moonraker/hooks';\n\nexport type KlippyReadyStates = 'ready' | 'error' | 'shutdown' | 'startup' | 'unknown';\n\nexport const useKlippyStateHandler = () => {\n\tconst { query, lastMessage } = useMoonraker({\n\t\tpassThroughUpdateMethods: ['notify_klippy_ready', 'notify_klippy_shutdown', 'notify_klippy_disconnected'],\n\t});\n\tconst [klippyReadyState, setKlippyReadyState] = useState<KlippyReadyStates>('unknown');\n\n\tconst queryKlippyState = useCallback(async () => {\n\t\tif (query != null) {\n\t\t\ttry {\n\t\t\t\tconst serverInfo = await query('server.info');\n\t\t\t\tif (serverInfo?.klippy_state == null) return;\n\t\t\t\tconst klippyState: KlippyReadyStates = serverInfo.klippy_state;\n\t\t\t\tsetKlippyReadyState(klippyState);\n\t\t\t\tif (klippyState === 'startup') {\n\t\t\t\t\t// Query for server info in two seconds as instructed by the moonraker docs.\n\t\t\t\t\t// Seems unnecessary with globally published events?\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tqueryKlippyState();\n\t\t\t\t\t}, 2000);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tsetKlippyReadyState('unknown');\n\t\t\t}\n\t\t}\n\t}, [query, setKlippyReadyState]);\n\n\tuseEffect(() => {\n\t\tif (query != null) {\n\t\t\tqueryKlippyState();\n\t\t}\n\t}, [query, queryKlippyState]);\n\n\tuseEffect(() => {\n\t\tif (lastMessage && 'method' in lastMessage && lastMessage.method === 'notify_klippy_ready') {\n\t\t\tsetKlippyReadyState('ready');\n\t\t}\n\t\tif (lastMessage && 'method' in lastMessage && lastMessage.method === 'notify_klippy_shutdown') {\n\t\t\tsetKlippyReadyState('shutdown');\n\t\t}\n\t\tif (lastMessage && 'method' in lastMessage && lastMessage.method === 'notify_klippy_disconnected') {\n\t\t\tsetKlippyReadyState('unknown');\n\t\t\tqueryKlippyState();\n\t\t}\n\t}, [lastMessage, queryKlippyState, setKlippyReadyState]);\n\n\treturn klippyReadyState;\n};\n"],"names":["Promise","resolve","then","__webpack_require__","bind","useDebounce","fn","delay","refreshTimeout","timeoutRef","useRef","argsRef","useEffect","current","clearTimeout","useCallback","args","undefined","setTimeout","useLocalPathname","usePathname","pathname","replace","useIsRouteActive","startsWith","href","routes","name","icon","Wand2","Monitor","Video","AreaChart","useNavigation","isRouteActive","prevActive","result","forEach","n","i","length","push","Redirecter","router","useRouter","hasLastPrinterSettings","props","children","klipperStateToText","klippyState","KlippyStateBadge","useKlippyStateHandler","color","jsx_runtime","jsxs","Badge","title","jsx","svg","className","twJoin","badgeTextColorStyle","fill","viewBox","circle","cx","cy","r","moonrakerStatusToText","moonrakerState","MoonrakerStateBadge","status","useMoonraker","useSteps","onStepChange","currentStepIndex","_setCurrentStepIndex","useState","step","isNaN","steps","currentStep","currentStepRef","setCurrentStepIndex","stepIndex","hasNextScreen","hasPreviousScreen","incrementStep","csi","decrementStep","partialScreenProps","extraScreenProps","key","parentScreenProps","nextScreen","previousScreen","skipSteps","description","screenProps","VerticalSteps","nav","aria-label","ol","role","map","stepIdx","li","Fragment","div","aria-hidden","span","onClick","CheckIcon","twMerge","canBeSkippedTo","aria-current","StepNavButtons","leftIcon","left","isLoading","Spinner","noMargin","ChevronLeft","Button","variant","disabled","label","rightIcon","right","ChevronRight","skip","ChevronsRight","HardwareSelection","partialPrinterConfiguration","serializedPrinterConfiguration","advancedSteppers","setAdvancedSteppers","selectedControllerFan","selectedBoard","selectedPrinter","performanceMode","setPerformanceMode","stealthchop","setStealthchop","standstillStealth","setStandstillStealth","selectedPrinterRails","setSelectedControllerFan","setControllerFan","parsedPrinterConfiguration","usePrinterConfiguration","errors","formattedErrors","success","error","format","railErrors","rails","rail","ri","railError","PrinterAxis","extruder","extruder1","includes","axis","motorSlot","concat","toUpperCase","_errors","flatten","formErrors","message","some","e","path","h3","p","AnimatedContainer","ErrorMessage","AnimatePresence","motion","exit","opacity","scale","y","initial","animate","toolheads","th","React","fallback","ToolheadSettings","toolOrAxis","DropdownWithPrinterQuery","query","vars","config","onSelect","value","Toggle","onLabel","onChange","speedLimits","performance","LayoutGroup","id","defaultRail","defaults","find","errorCount","Object","keys","reduce","acc","keyErrors","count","Array","isArray","PrinterRailSettings","printerRail","printerRailDefault","deserializePrinterRailDefinition","isVisible","QueryStatus","content","isError","MutationStatus","mutation","isIdle","isPaused","InfoMessage","Banner","Icon","InformationCircleIcon","DFUFlash","data","dfuDetected","trpc","mcu","dfuDetect","useQuery","boardPath","board","toolhead","serialize","refetchInterval","flashDfuMutation","dfuFlash","useMutation","onSuccess","isFlashing","setIsFlashing","startFlash","mutate","onSettled","dfuError","boardPathUri","encodeURIComponent","instructions","dfu","index","jumperReminder","hasBoot0Jumper","h4","img","src","alt","Modal","onClose","open","setOpen","onButtonClick","onDialogClose","Transition","Root","show","as","appear","Dialog","Child","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Overlay","Title","body","button","type","buttonLabel","SDCardFlashing","compile","shutdownModalVisible","setShutdownModalVisible","moonrakerQuery","isReady","isFirmwareReady","setIsFirmwareReady","onError","shutdownMutation","mutationFn","reject","compileButton","PlayIcon","manufacturer","ArrowDownTrayIcon","MCUFlashing","selectedBoardToFlash","unidentifiedBoards","forceReflash","setForceReflash","flashStrategy","setFlashStrategy","flashPath","setFlashPath","selectedControlboard","selectedToolboard","boardDetected","detect","enabled","unidentifiedDevices","boardVersion","refetchOnWindowFocus","refetchOnMount","refetchOnReconnect","klipperVersion","flashViaPath","reflash","remove","rightButton","leftButton","onFlashViaPath","ArrowPathIcon","isFetching","dfuReminder","reminder","versionMismatch","WarningMessage","CheckCircleIcon","dfuStrategyEnabled","sdCardStrategyEnabled","isToolboard","pathStrategyEnabled","flashScript","unidentifiedPathStrategyEnabled","sdCard","unidentifiedPath","dropdownItems","ub","CardSelector","selected","setSelected","_onSelect","card","RadioGroup","Label","cards","Option","checked","active","param","Description","details","MCUPicker","setSelectedBoard","isToolboardRequired","controlboard","driverCount","driverCountRequired","isBoardDetected","detected","c","_this","size","skipButton","getMotionAxis","x","MCUSteps","getToolCommand","getDescription","renderScreen","react","createElement","MCUPreparation","boardsQuery","_controlBoard","_setControlboard","setToolhead","useToolheadConfiguration","boards","boardFilters","keepPreviousData","useMemo","filter","b","disableAutoFlash","Cpu","getToolboard","getConfig","toolboard","newBoard","Toolboard","parse","Board","CardSelectorWithOptions","selectedOption","setSelectedOption","selectedRef","parent","useAutoAnimate","optionValue","options","onSelectOption","option","ref","badgeBackgroundColorStyle","badgeBorderColorStyle","ShowWhenReady","queryErrors","showErrors","PrinterSelection","selectedCard","printerQuery","printer","printers","boardQuery","useRecoilValue","LoadablePrinterState","selectedPrinterOption","PrinterSizeState","slice","sort","a","indexOf","localeCompare","printerImgUri","Image","width","height","values","sizes","entries","volume","selectedPrinterOptionFromCard","o","z","onSelectPrinter","useRecoilCallback","set","reset","snapshot","console","oldToolheads","getPromise","PrinterToolheadsState","oldControllerBoard","ControlboardState","PrinterToolheadState","toolNumber","PrinterState","ToolheadHelper","getTool","PerformanceModeState","StealthchopState","StandstillStealthState","ControllerFanState","PrinterRailsState","defaultBoard","controllerFan","isFetched","parseSignal","dBm","signalIcon","SignalZero","SignalLow","SignalMedium","SignalHigh","Signal","hostnameInput","object","hostname","string","min","regex","joinInput","ssid","max","passphrase","frequencies","country","optional","hidden","boolean","WifiSetup","passwordValidation","selectedNetwork","apList","setApList","setSelectedNetwork","password","setPassword","setHostname","hostnameCompleted","setHostnameCompleted","showHidden","setShowHidden","overrideSSID","setOverrideSSID","wifi","scan","state","retry","hostnameMutation","wifiMutation","join","newList","ap","address","Math","abs","frequency","hostnameValidation","safeParse","signal","round","onSelectCard","connectToWifi","rebootMutation","reboot","rebootAndClose","mutateAsync","window","close","confirmHostname","isSuccess","TextInput","issues","val","help","fieldErrors","security","toLocaleUpperCase","subtext","pop","Boolean","org","EyeOff","Eye","TwoColumns","strokeWidth","stroke","xmlns","strokeLinecap","strokeLinejoin","d","SingleColumn","proccessTokens","hunks","highlight","enhancers","markEdits","tokenize","ex","DiffModal","isOpen","setIsOpen","viewType","setViewType","files","parseDiff","diff","diffType","XMarkIcon","Diff","tokens","buttons","StateCircleVariants","cva","variants","info","warning","danger","indeterminate","plain","primary","StateCircle","ping","pingClassName","ChangedFile","addFileToIgnore","addFileToOverwrite","file","removeFileToIgnore","removeFileToOverwrite","isMarkedIgnored","isMarkedOverwritten","isDiffModalOpen","setIsDiffModalOpen","showDiffModal","wouldOtherwiseBeWritten","overwrite","isOverwritable","isIgnorable","isOverwritten","exists","needsExplicitAction","changedFromConfig","actions","fileName","ignore","write","intent","action","fileState","shouldPing","useChangeEffect","changedOnDisk","isIgnored","Menu","EllipsisVerticalIcon","Items","Item","FileChanges","filesToWrite","serializedConfig","onFilesToIgnoreChange","onFilesToOverwriteChange","filesToOverwrite","setFilesToOverwrite","filesToIgnore","setFilesToIgnore","client","useUtils","queryKey","queryFn","res","getFilesToWrite","ul","fileToWrite","CompletionSteps","ConfirmConfig","ProceedToMainsail","ConfirmToolhead","toolboardDetected","ignoreEndstopWarning","setIgnoreEndstopWarning","setToolboardEndstop","printerConfig","PrinterConfigurationState","toolboardEndstop","xEndstopOptions","serializePartialPrinterConfiguration","xEndstop","dl","hasWarnings","alternativePT1000Resistor","getThermistor","Disclosure","ChevronRightIcon","Panel","dt","dd","hotend","thermistor","yEndstop","probe","partFan","hotendFan","xAccelerometer","yAccelerometer","motionErrors","serializePrinterConfiguration","controlboardDetected","saveConfigurationMutation","saveConfiguration","overwriteFiles","skipFiles","scrollTo","useContext","requiresExplicitFileActions","f","field","motorSlots","hasDiagPin","diag_pin","isSensorless","t","tool","defaultOpen","driver","voltage","stepper","microstepping","target","rel","location","WizardComplete","makeSteps","isConfigValid","nextIndex","getNextIndex","padStart","toLocaleLowerCase","LoadScreen","SetupSteps","searchParams","useSearchParams","ths","LoadablePrinterToolheadsState","uriStep","get","parseInt","defaultStep","hasWifiInterface","isConnectedToWifi","Card","Wizard","version","ip","ipAddress","h1","setHeight","heightRef","isOverflowVisible","setIsOverflowVisible","isOverflowVisibleRef","containerRef","useResizeObserver","entry","contentRect","onComplete","onStart","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","containerClassName","style","onAnimationComplete","onAnimationStart","buttonVariants","outline","true","sm","lg","default","compoundVariants","class","defaultVariants","forwardRef","forwardProps","buttonClasses","Link","ChevronDownIcon","item","cardVariants","XCircleIcon","FullLoadScreen","NoSSR","isClient","useIsClient","DynamicImport","lazy","Switch","Group","passive","setErrors","setToolheadField","updated","getChangeSet","ret","getHotend","stringToTitleObject","Dropdown","getNozzle","nozzle","Nozzle","shape","Values","diameter","inputMode","getExtruder","getProbe","getXEndstop","getYEndstop","getPartFan","getHotendFan","getXAccelerometer","getYAccelerometer","ExclamationCircleIcon","deps","clearAfter","resetTimeoutOnChange","hasChanged","setHasChanged","lastDeps","changed","dep","clear","timeout","useDelayedChangeEffect","changeCount","setChangeCount","trigger","lastMessage","passThroughUpdateMethods","klippyReadyState","setKlippyReadyState","queryKlippyState","serverInfo","klippy_state","method"],"sourceRoot":""}