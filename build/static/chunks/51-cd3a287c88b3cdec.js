"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[51],{88192:function(e,t,r){r.r(t),r.d(t,{Card:function(){return Card}});var i=r(72612),l=r(73918);r(39164);var a=r(73790);let n=(0,l.j)(["relative rounded-lg  bg-white dark:bg-zinc-900/60","shadow-[0px_0px_0px_1px_rgba(9,9,11,0.07),0px_2px_2px_0px_rgba(9,9,11,0.05)] dark:shadow-[0px_0px_0px_1px_rgba(255,255,255,0.05)]","dark:before:-inset-px dark:before:rounded-xl","dark:before:pointer-events-none dark:before:absolute dark:before:shadow-[0px_2px_8px_0px_rgba(0,_0,_0,_0.20),_0px_1px_0px_0px_rgba(255,_255,_255,_0.07)_inset]"]),Card=e=>(0,i.jsx)(a.E.div,{...e,className:n({className:e.className}),children:e.children})},45483:function(e,t,r){r.d(t,{B:function(){return ErrorMessage}});var i=r(72612),l=r(65826);r(39164);var a=r(63278),n=r(34471);let ErrorMessage=e=>(0,i.jsx)(n.j,{color:"red",Icon:l,title:e.title?"Error: "+e.title:"Error",className:(0,a.m6)(e.className,"whitespace-pre-wrap"),children:e.children})},8832:function(e,t,r){r.d(t,{I:function(){return FullLoadScreen}});var i=r(72612),l=r(98130),a=r(63278);let FullLoadScreen=e=>(0,i.jsx)("div",{className:(0,a.dV)("flex h-full w-full flex-1 items-center justify-center",e.className),children:(0,i.jsx)(l.$,{className:"h-8 w-8"})})},56445:function(e,t,r){r.r(t),r.d(t,{NoSSR:function(){return NoSSR}});var i=r(72612),l=r(91302),a=r(39164),n=r(8832);let NoSSR=e=>{var t;let r=(0,l.O)();return r?(0,i.jsx)(s,{children:e.children}):null!==(t=e.fallback)&&void 0!==t?t:(0,i.jsx)(n.I,{})},s=(0,a.lazy)(()=>Promise.resolve({default:e=>(0,i.jsx)(i.Fragment,{children:e.children})}))},26751:function(e,t,r){r.d(t,{o:function(){return QueryStatus}});var i=r(72612),l=r(45483),a=r(98130),n=r(34709);let QueryStatus=e=>{let t=null;if(e.isError){var r;t=(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)(l.B,{children:null===(r=e.error)||void 0===r?void 0:r.message})})}return e.isLoading&&(t=(0,i.jsx)("div",{className:"mb-4 flex items-center justify-center",children:(0,i.jsx)(a.$,{})})),(0,i.jsx)(n.i,{children:t})}},12178:function(e,t,r){r.d(t,{o:function(){return FileChanges}});var i=r(72612),l=r(39164),a=r(79293),n=r(9948),s=r(44649),o=r(56538),d=r(80849);r(85626);var c=r(17934),u=r(94809),m=r(63278);let TwoColumns=e=>(0,i.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",strokeWidth:"1.5",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:(0,m.m6)("h-6 w-6",e.className),children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M 12 4.5 L 12 19.5 M 4.125 19.5 L 19.875 19.5 C 20.496 19.5 21 18.996 21 18.375 L 21 5.625 C 21 5.004 20.496 4.5 19.875 4.5 L 4.125 4.5 C 3.504 4.5 3 5.004 3 5.625 L 3 18.375 C 3 18.996 3.504 19.5 4.125 19.5 Z"})}),SingleColumn=e=>(0,i.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",strokeWidth:"1.5",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:(0,m.m6)("h-6 w-6",e.className),children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M 4.125 19.5 L 19.875 19.5 C 20.496 19.5 21 18.996 21 18.375 L 21 5.625 C 21 5.004 20.496 4.5 19.875 4.5 L 4.125 4.5 C 3.504 4.5 3 5.004 3 5.625 L 3 18.375 C 3 18.996 3.504 19.5 4.125 19.5 Z"})}),proccessTokens=e=>{if(!e)return;let t={highlight:!1,enhancers:[(0,d.BF)(e,{type:"block"})]};try{return(0,d.wS)(e,t)}catch(e){return}},DiffModal=e=>{var t;let{isOpen:r,setIsOpen:a}=e,[n,p]=(0,l.useState)("unified"),x=(0,l.useCallback)(()=>{a(!1)},[a]),f=(0,l.useMemo)(()=>(0,d.z2)(e.diff),[e.diff]),v="changed"===e.state?"modify":"created"===e.state?"add":"delete";return(0,i.jsx)(s.u.Root,{show:r,as:l.Fragment,appear:!0,children:(0,i.jsx)(o.V,{as:"div",className:"git-diff fixed inset-0 z-50 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600",onClose:x,children:(0,i.jsxs)("div",{className:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0",children:[(0,i.jsx)(s.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,i.jsx)(o.V.Overlay,{className:"fixed inset-0 bg-zinc-500 bg-opacity-75 transition-opacity dark:bg-zinc-950 dark:bg-opacity-75"})}),(0,i.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",children:"â€‹"}),(0,i.jsx)(s.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,i.jsxs)("div",{className:"relative inline-flex max-h-[80vh] max-w-screen-2xl transform flex-col overflow-hidden rounded-lg bg-white py-4 text-left align-bottom shadow-xl transition-all dark:bg-zinc-800 sm:my-8 sm:w-full sm:py-6 sm:align-middle",children:[(0,i.jsxs)(o.V.Title,{as:"h3",className:"flex items-center justify-between border-b border-zinc-200 px-4 pb-4 text-lg font-semibold leading-6 text-zinc-900 dark:border-zinc-700 dark:text-zinc-100 sm:px-6",children:[(0,i.jsx)("div",{children:e.title}),(0,i.jsxs)("div",{className:"relative flex flex-nowrap items-center space-x-2 text-zinc-500 dark:text-zinc-400",children:[(0,i.jsx)("button",{className:(0,m.dV)("unified"===n?"cursor-default text-sky-600 dark:text-sky-400":"hover:text-zinc-800 dark:hover:text-zinc-100"),onClick:()=>p("unified"),title:"Unified View",children:(0,i.jsx)(SingleColumn,{className:"h-6 w-6"})}),(0,i.jsx)("button",{className:(0,m.dV)("split"===n?"cursor-default text-sky-600 dark:text-sky-400":"hover:text-zinc-800 dark:hover:text-zinc-100"),onClick:()=>p("split"),title:"Split View",children:(0,i.jsx)(TwoColumns,{className:"h-6 w-6"})}),(0,i.jsx)("div",{className:"!ml-4 !mr-1 h-6 border-l border-l-zinc-200 dark:border-l-zinc-800"}),(0,i.jsx)("button",{className:"hover:text-zinc-800 dark:hover:text-zinc-100",onClick:x,children:(0,i.jsx)(c,{className:"h-6 w-6"})})]})]}),(0,i.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-400 scrollbar-thumb-rounded-md dark:scrollbar-thumb-zinc-600",children:f.map((e,t)=>{let{hunks:r}=e;return(0,i.jsx)(d.zI,{hunks:r,viewType:n,diffType:v,tokens:proccessTokens(r)},t)})}),(0,i.jsxs)("div",{className:"flex-end flex flex-row items-center justify-end space-x-2 border-t border-zinc-200 px-4 pt-4 dark:border-zinc-700 sm:px-6 sm:pt-6",children:[null!==(t=e.buttons)&&void 0!==t?t:null,(0,i.jsx)(u.z,{variant:"plain",onClick:x,children:"Close"})]})]})})]})})})};var p=r(3496),x=r(96722),f=r(73918);let v=(0,f.j)("flex-none rounded-full p-1 relative flex",{variants:{state:{success:"dark:text-green-400 text-green-500 bg-green-400/20",info:"dark:text-sky-400 text-sky-500 bg-sky-400/20",warning:"dark:text-yellow-400 text-yellow-500 bg-yellow-400/20",danger:"dark:text-rose-400 text-rose-500 bg-rose-400/20",indeterminate:"dark:text-zinc-400 text-zinc-500 bg-zinc-500/20",plain:"dark:text-zinc-400 text-zinc-500 bg-zinc-500/20",primary:"dark:text-brand-400 text-brand-500 bg-brand-500/20"}}}),StateCircle=e=>{var t;return(0,i.jsxs)("div",{className:v(e),children:[(0,i.jsx)("div",{title:e.title,className:(0,m.m6)("absolute inset-0 transition-all duration-700",e.ping?"opacity-100":"opacity-0",null!==(t=e.pingClassName)&&void 0!==t?t:"z-2"),children:(0,i.jsx)("div",{className:(0,m.m6)("absolute inset-0 inline-flex animate-ping rounded-full bg-current opacity-0 ease-out")})}),(0,i.jsx)("div",{className:"h-2 w-2 rounded-full bg-current"})]})};var h=r(39634),g=r(66477),b=r(30461),k=r(26751);let ChangedFile=e=>{let{addFileToIgnore:t,addFileToOverwrite:r,file:a,removeFileToIgnore:n,removeFileToOverwrite:o,isMarkedIgnored:d,isMarkedOverwritten:c}=e,[f,v]=(0,l.useState)(!1),k=(0,l.useCallback)(e=>{v(!0)},[]),j="changed"===a.state&&(a.overwrite||c)||"created"===a.state||"removed"===a.state,y="changed"===a.state,N="created"===a.state||"removed"===a.state||"changed"===a.state,w=c||a.overwrite&&a.exists,R=N&&!d&&!w&&!j&&!0===a.changedFromConfig;a.state,a.state,a.state;let C=(0,l.useMemo)(()=>{if("RatOS.cfg"===a.fileName)return[];let e=null,i=null,l=null,s=null,u=null;return w&&!d?e={title:"Skip",intent:"indeterminate",action:c?o:t}:y&&(l={title:"Overwrite",intent:"warning",action:d?n:r}),N&&!d?i={title:"Ignore",intent:R?"danger":"indeterminate",action:t}:d&&("removed"===a.state?u={title:"Delete",intent:"danger",action:n}:N&&(s={title:"Write",intent:"success",action:n})),[e,i,l,s,u].filter(Boolean)},[t,r,a.fileName,a.state,N,d,d,c,y,w,R,n,o]),S=(0,l.useMemo)(()=>R?"danger":"changed"===a.state?d&&a.overwrite||w&&!a.overwrite?"warning":w?"success":"indeterminate":"created"===a.state?d?"danger":"success":"removed"!==a.state||d?"indeterminate":"warning",[a.overwrite,a.state,d,w,R]),[z]=(0,g.S)([S],4e3);return(0,i.jsxs)("li",{className:"flex items-center justify-between gap-x-6 py-5",children:[(null==a?void 0:a.diff)!=null&&(0,i.jsx)(DiffModal,{diff:a.diff,title:"Changes to ".concat(a.fileName),state:a.state,setIsOpen:v,buttons:C.map(e=>(0,i.jsx)(u.z,{onClick:()=>{e.action(a.fileName),v(!1)},variant:e.intent,children:e.title},e.title)),isOpen:f}),(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,i.jsx)(StateCircle,{state:S,ping:z}),(0,i.jsx)("p",{className:"text-sm font-medium leading-6 text-zinc-900 dark:text-zinc-100",children:a.fileName}),(0,i.jsx)(h.Ct,{size:"sm",color:"changed"===a.state?a.changedFromConfig?"yellow":"sky":"created"===a.state?"green":"removed"===a.state?"rose":"gray",children:"changed"===a.state?a.changedFromConfig?"Pending changes":"Changed on disk":"created"===a.state?"New file":"removed"===a.state?"Deleted":"No updates"}),a.changedOnDisk&&(0,i.jsx)(h.Ct,{size:"sm",color:"sky",children:"Changed on disk"})]}),(0,i.jsx)("div",{className:"mt-1 flex items-center gap-x-2 text-xs leading-5 text-zinc-500 dark:text-zinc-400",children:(0,i.jsxs)("p",{className:"",children:["changed"===a.state&&(w&&!d?"File will be backed up and overwritten."+("RatOS.cfg"!=a.fileName?" Any changes you've made can be recovered from the backup.":""):R?"Please review the changes and make a decision.":"File will be skipped."),"created"===a.state&&(d?"File will be skipped.":"File will be created."),"removed"===a.state&&(d?"File will remain untouched.":"File will be deleted."),"unchanged"===a.state&&(a.changedOnDisk?"File has user modifications.":"File remains untouched.")]})})]}),(0,i.jsxs)("div",{className:"flex flex-none items-center gap-x-4",children:[(0,i.jsx)("div",{className:"flex flex-none items-center",children:R?(0,i.jsx)(u.z,{variant:"info",onClick:()=>k(a),children:"Review changes"}):(0,i.jsx)(b,{className:"h-5 w-5 text-green-500 dark:text-brand-500","aria-hidden":"true"})}),(0,i.jsxs)(p.v,{as:"div",className:"relative flex-none",children:[(0,i.jsxs)(p.v.Button,{className:"-m-2.5 block p-2.5 text-zinc-500 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-100",children:[(0,i.jsx)("span",{className:"sr-only",children:"Open options"}),(0,i.jsx)(x,{className:"h-5 w-5","aria-hidden":"true"})]}),(0,i.jsx)(s.u,{as:l.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,i.jsxs)(p.v.Items,{className:"absolute right-0 z-10 mt-2 w-32 origin-top-right rounded-md bg-white py-2 shadow-lg ring-1 ring-zinc-900/5 focus:outline-none dark:bg-zinc-900 dark:ring-zinc-100/5",children:[C.map(e=>(0,i.jsx)(p.v.Item,{children:t=>{let{active:r,disabled:l}=t;return(0,i.jsx)("span",{onClick:()=>e.action(a.fileName),className:(0,m.dV)(r?"bg-zinc-50 dark:bg-zinc-800":"",l?"cursor-not-allowed opacity-50":"cursor-pointer","block px-3 py-1 text-sm leading-6 text-zinc-800 dark:text-zinc-200"),children:e.title})}},e.title)),(0,i.jsx)(p.v.Item,{disabled:null==a.diff,children:e=>{let{active:t,disabled:r}=e;return(0,i.jsx)("span",{onClick:()=>k(a),className:(0,m.dV)(t?"bg-zinc-50 dark:bg-zinc-800":"",r?"cursor-not-allowed opacity-50":"cursor-pointer","block px-3 py-1 text-sm leading-6 text-zinc-800 dark:text-zinc-200"),children:"View diff"})}})]})})]})]})]},a.fileName)},FileChanges=e=>{var t;let{serializedConfig:r,onFilesToIgnoreChange:s,onFilesToOverwriteChange:o}=e,[d,c]=(0,l.useState)([]),u=(0,l.useCallback)(e=>{c(t=>t.includes(e)?t:[...t,e])},[]),m=(0,l.useCallback)(e=>{c(t=>t.includes(e)?t.filter(t=>t!==e):t)},[]),[p,x]=(0,l.useState)([]),f=(0,l.useCallback)(e=>{x(t=>t.includes(e)?t:[...t,e])},[]),v=(0,l.useCallback)(e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):t)},[]);(0,l.useEffect)(()=>{o(d)},[d,o]),(0,l.useEffect)(()=>{s(p)},[p,s]);let h=a.SX.useUtils().client,g=(0,n.a)({queryKey:["printer.filesToWrite",r],queryFn:async()=>{let e=await h.printer.getFilesToWrite.mutate({config:null!=r?r:{}});return e},enabled:null!=r});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("ul",{role:"list",className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:null===(t=g.data)||void 0===t?void 0:t.map(e=>(0,i.jsx)(ChangedFile,{file:e,isMarkedIgnored:p.includes(e.fileName),isMarkedOverwritten:d.includes(e.fileName),addFileToIgnore:f,addFileToOverwrite:u,removeFileToIgnore:v,removeFileToOverwrite:m},e.fileName))}),(0,i.jsx)(k.o,{...g})]})}},59672:function(e,t,r){r.d(t,{l:function(){return PrinterRailSettings}});var i=r(72612),l=r(34640),a=r(39164),n=r(37231),s=r(18311),o=r(39634),d=r(57137),c=r(34471),u=r(39662),m=r(69460),p=r(96588),x=r(31239),f=r(1314),v=r(21264),h=r(32342),g=r(80461),b=r(79293),k=r(63278),j=r(94594),y=r(39762),N=r(88192),w=r(73371);j.z.array(f.g6);let PrinterRailSettings=e=>{var t,r,j,R,C,S,z,D,_,F,M;let T=(0,g.YC)(),E=T.find(t=>t.getExtruderAxis()===e.printerRail.axis),L=T.every(e=>e.hasToolboard()),O=(null==E?void 0:E.getExtruderAxis())===e.printerRailDefault.axis&&(null==E?void 0:E.hasToolboard()),I=O?E.getToolboard():e.selectedBoard,[B,P]=(0,a.useState)(!!e.performanceMode),V=(0,p.Zl)((0,h.ew)(e.printerRail.axis)),W=(0,p.sJ)(h.q7),[A,Y]=(0,a.useState)(e.printerRail.motorSlot&&(null===(r=e.selectedBoard)||void 0===r?void 0:null===(t=r.motorSlots)||void 0===t?void 0:t[e.printerRail.motorSlot])?e.printerRail.motorSlot:void 0),U=(null==I?void 0:I.integratedDrivers)?null!==(S=I.integratedDrivers[null!=A?A:e.printerRail.axis.startsWith("extruder")?f.po.extruder:e.printerRail.axis])&&void 0!==S?S:I.integratedDrivers[e.printerRail.axis.startsWith("extruder")?f.po.extruder:e.printerRail.axis]:null,[Z,q]=(0,a.useState)(null!=U&&null!==(z=(0,v.Df)(U))&&void 0!==z?z:e.printerRail.driver),[Q,X]=(0,a.useState)(e.printerRail.stepper),[$,H]=(0,a.useState)(B&&null!==(D=null===(j=e.printerRailDefault.performanceMode)||void 0===j?void 0:j.homingSpeed)&&void 0!==D?D:e.printerRailDefault.homingSpeed),J=null==e.errors?0:Object.keys(e.errors).reduce((t,r)=>{var i;let l=null===(i=e.errors)||void 0===i?void 0:i[r];if(null==l)return t;let a=Array.isArray(l)?l.length:l._errors.length;return t+a},0),K=(0,a.useCallback)(t=>null!=t&&W.some(r=>{let i=T.find(e=>e.getExtruderAxis()===r.axis);return!(r.axis===e.printerRail.axis||(null==i?void 0:i.hasToolboard()))&&r.motorSlot===t}),[W,e.printerRail.axis,T]),G=b.SX.mcu.reversePinLookup.useQuery({axis:e.printerRail.axis,canUseExtruderlessConfigs:L,boardPath:null!==(_=null==I?void 0:I.path)&&void 0!==_?_:""},{enabled:!!I});(0,a.useEffect)(()=>{var e;G.data&&null==A&&(null==I?void 0:null===(e=I.motorSlots)||void 0===e?void 0:e[G.data])!=null&&Y(G.data)},[I,G.data,A,e.printerRailDefault.axis]);let ee=(0,f.Wx)(I,Z).map(e=>({...e,badge:null!=(0,s.a)(Q,Z,e.id,void 0,B)?{children:"Tuned Preset",color:"sky"}:void 0})),[et,er]=(0,a.useState)(null!==(M=null!==(F=ee.find(t=>t.id===e.printerRail.voltage))&&void 0!==F?F:ee.find(t=>{var r;return t.id===(B&&(null===(r=e.printerRailDefault.performanceMode)||void 0===r?void 0:r.voltage)?e.printerRailDefault.performanceMode.voltage:e.printerRailDefault.voltage)}))&&void 0!==M?M:ee[0]),[ei,el]=(0,a.useState)(e.printerRail.current),ea=(0,a.useMemo)(()=>(0,s.a)(e.printerRailDefault.stepper,e.printerRailDefault.driver,e.printerRailDefault.voltage,e.printerRailDefault.current),[e.printerRailDefault]),en=(0,a.useMemo)(()=>(0,s.a)(Q,Z,et.id,void 0,B),[Q,Z,et,B]),es=(0,a.useMemo)(()=>(0,s.a)(Q,Z,et.id,ei,B),[Q,Z,et,B,ei]),eo=n.N.filter(e=>"UART"===e.protocol||(null==I?void 0:I.stepperSPI)!=null).map(e=>({...e,badge:null!=(0,s.a)(Q,e,et.id,void 0,B)?{children:"Tuned Preset",color:"sky"}:void 0})),ed=s.B.map(e=>({...e,badge:null!=(0,s.a)(e,Z,et.id,void 0,B)?{children:"Tuned Preset",color:"sky"}:void 0}));(0,a.useEffect)(()=>{if((0,f.R_)(e.printerRail,e.printerRailDefault,!e.performanceMode)){var t,r,i;e.performanceMode&&e.printerRailDefault.performanceMode?(H(null!==(t=e.printerRailDefault.performanceMode.homingSpeed)&&void 0!==t?t:e.printerRail.homingSpeed),null!=e.printerRailDefault.performanceMode.voltage&&er(null!==(r=ee.find(t=>{var r,i;return t.id===(null!==(i=null===(r=e.printerRailDefault.performanceMode)||void 0===r?void 0:r.voltage)&&void 0!==i?i:e.printerRailDefault.voltage)}))&&void 0!==r?r:ee[0]),null!=e.printerRailDefault.performanceMode.current&&el(e.printerRailDefault.performanceMode.current)):(H(e.printerRailDefault.homingSpeed),er(null!==(i=ee.find(t=>t.id===e.printerRailDefault.voltage))&&void 0!==i?i:ee[0]),el(e.printerRailDefault.current))}P(!!e.performanceMode)},[e.performanceMode]),(0,a.useEffect)(()=>{let e=ee.find(e=>e.id===et.id);if(!e){var t;er(en&&null!==(t=ee.find(e=>e.id===en.voltage))&&void 0!==t?t:ee[0]),en&&el(en.run_current)}},[ee,et,en]),(0,a.useEffect)(()=>{let t={axis:e.printerRail.axis,axisDescription:e.printerRail.axisDescription,rotationDistance:e.printerRail.rotationDistance,homingSpeed:$,motorSlot:A,driver:Z,voltage:et.id,stepper:Q,current:ei},r=(0,v.Yz)(t),i=(0,v.Yz)(e.printerRail),l=Object.keys(r).some(e=>r[e]!==i[e]);l&&V(r)},[ei,Z,e.printerRail,$,V,Q,et.id,A]);let ec=en&&en.run_current===ei,eu="extruder"===e.printerRail.axis?"Extruder T0":e.printerRail.axis===f.po.extruder1?"Extruder T1":"Stepper "+e.printerRail.axis.toLocaleUpperCase(),em=(null==I?void 0:I.motorSlots)!=null&&Object.keys(I.motorSlots).length>0?Object.keys(I.motorSlots).map(t=>{var r,i,l,a;if((null===(r=I.motorSlots)||void 0===r?void 0:r[t].title)==null)return null;let n=(null===(i=I.motorSlots)||void 0===i?void 0:i[t].diag_pin)!=null,s=(null===(l=I.motorSlots)||void 0===l?void 0:l[t].endstop_pin)!=null,o=K(t),d=(e.printerRailDefault.axis.startsWith("x")||e.printerRailDefault.axis.startsWith("y"))&&!n;return{id:t,title:null===(a=I.motorSlots)||void 0===a?void 0:a[t].title,disabled:d,badge:[n?void 0:{children:"No diag pin",color:d?"red":"gray"},s?void 0:{children:"No endstop pin",color:"gray"},!0===o?{children:"In use",color:"orange"}:void 0].filter(Boolean)}}).filter(Boolean):null,ep=(0,a.useMemo)(()=>{var t,r;if(null==A||(null==I?void 0:null===(t=I.motorSlots)||void 0===t?void 0:t[A].title)==null)return;let i=(null===(r=I.motorSlots)||void 0===r?void 0:r[A].diag_pin)!=null,l=(e.printerRailDefault.axis.startsWith("x")||e.printerRailDefault.axis.startsWith("y"))&&!i;return!i&&l?{children:"No diag pin",color:"red"}:void 0},[I,A,e.printerRailDefault.axis]);return(0,i.jsx)(y.M,{children:e.isVisible&&(0,i.jsxs)(N.Card,{exit:{opacity:0,scale:.9,y:-40},initial:{opacity:0,scale:.9,y:40},animate:{opacity:1,scale:1,y:0},className:(0,k.m6)("break-inside-avoid-column",J>0&&(0,o.iA)({color:"red"}),J>0&&(0,o.xU)({color:"red"})),children:[(0,i.jsxs)(w.Ol,{className:"",children:[(0,i.jsx)(w.ll,{className:(0,k.m6)(J>0&&"text-red-900/80 dark:text-red-100"),children:eu}),(0,i.jsx)(w.SZ,{className:(0,k.m6)(J>0&&"text-red-800/80 dark:text-red-100/60"),children:e.printerRail.axisDescription})]}),(0,i.jsxs)(w.aY,{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[em&&(0,i.jsx)("div",{className:"col-span-2",children:(0,i.jsx)(l.Lt,{label:"Motor Slot",options:em,error:null===(C=e.errors)||void 0===C?void 0:null===(R=C.motorSlot)||void 0===R?void 0:R._errors.join("\n"),onSelect:e=>{var t,r;Y(e.id),(null==I?void 0:null===(t=I.integratedDrivers)||void 0===t?void 0:t[e.id])!=null&&q(null!==(r=(0,v.Df)(I.integratedDrivers[e.id]))&&void 0!==r?r:Z)},value:A?em.find(e=>e.id===A):void 0,badge:ep})}),(0,i.jsx)("div",{className:"col-span-2",children:(0,i.jsx)(l.Lt,{label:"Driver",options:eo,onSelect:q,value:Z,disabled:null!=U,badge:[null!=U?{children:"Integrated",color:"sky"}:void 0,O?{children:"Toolboard",color:"yellow"}:void 0].filter(Boolean)})}),(0,i.jsx)("div",{className:"col-span-2",children:(0,i.jsx)(l.Lt,{label:"Stepper",options:ed,onSelect:X,value:Q})}),(0,i.jsx)("div",{className:"col-span-1",children:(0,i.jsx)(l.Lt,{label:"Voltage",options:ee,onSelect:er,value:et})}),(0,i.jsx)("div",{className:"col-span-1",children:(0,i.jsx)(d.o,{type:"number",label:"Current",value:ei,onChange:el,inputMode:"decimal",step:"any",min:0,max:Z.maxCurrent})}),Q.maxPeakCurrent/1.41<ei&&(0,i.jsxs)(c.j,{Icon:x,color:"yellow",title:"Stepper overcurrent!",className:"col-span-2",children:["Your stepper motor is rated for ",Math.floor(100*Q.maxPeakCurrent/1.41)/100,"A RMS, but you are using ",ei,"A."]}),null!=es&&(0,i.jsx)(c.j,{Icon:u,color:"brand",title:"Driver tuning applied!",className:"col-span-2",children:"RatOS preset applied automatically."}),(null==es?void 0:es.run_current)!==(null==ea?void 0:ea.run_current)&&en&&!ec&&(0,i.jsxs)(c.j,{Icon:m,color:"sky",title:"Recommended tuning preset available at different current",className:"col-span-2",children:["RatOS has a recommended preset for your current settings at ",en.run_current,"A. You can"," ",(0,i.jsxs)("span",{className:"cursor-pointer font-bold underline hover:no-underline",onClick:()=>el(en.run_current),children:["change the current to ",en.run_current,"A"]})," ","to apply the preset automatically."]})]})]},e.printerRail.axis)})}},73371:function(e,t,r){r.d(t,{Ol:function(){return n},SZ:function(){return o},aY:function(){return d},eW:function(){return c},ll:function(){return s}});var i=r(72612),l=r(39164),a=r(64929);let n=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...l})});n.displayName="CardHeader";let s=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,i.jsx)("h3",{ref:t,className:(0,a.cn)("font-semibold leading-none tracking-tight",r),...l})});s.displayName="CardTitle";let o=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,i.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...l})});o.displayName="CardDescription";let d=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...l})});d.displayName="CardContent";let c=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...l})});c.displayName="CardFooter"},66477:function(e,t,r){r.d(t,{I:function(){return useDelayedChangeEffect},S:function(){return useChangeEffect}});var i=r(39164);let useChangeEffect=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],[l,a]=(0,i.useState)(0),n=(0,i.useRef)([...e]);(0,i.useEffect)(()=>{let t=!1;n.current.forEach((r,i)=>{r!==e[i]&&(t=!0)}),t&&a(e=>r?e+1:1),n.current=[...e]},[...e]);let s=(0,i.useCallback)(()=>{a(0)},[]);return(0,i.useEffect)(()=>{if(null!=t&&l>0){let e=setTimeout(()=>{a(0)},t);return()=>{clearTimeout(e)}}},[t,l]),[l>0,s]},useDelayedChangeEffect=function(e,t,r){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],[a,n]=(0,i.useState)(0),s=(0,i.useRef)([...e]),o=(0,i.useRef)(null);(0,i.useEffect)(()=>{let r=!1;if(s.current.forEach((t,i)=>{t!==e[i]&&(r=!0)}),r){let trigger=()=>n(e=>l?e+1:1);o.current=window.setTimeout(()=>{trigger(),o.current=null},t)}s.current=[...e]},[...e]),(0,i.useEffect)(()=>()=>{o.current&&clearTimeout(o.current)},[]);let[d,c]=useChangeEffect([a],r,l);return[d,c]}}}]);
//# sourceMappingURL=51-cd3a287c88b3cdec.js.map