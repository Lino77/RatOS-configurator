"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9817],{43955:function(e,t,r){r.d(t,{DN:function(){return h},NI:function(){return f}});var n=r(38188),a=r.n(n),o=r(13558),i=r.n(o),s=r(78478),l=r(85982),u=r.n(l),c=r(33619),d=r.n(c),p={darkMode:"class",content:["./pages/**/*.{js,ts,jsx,tsx}","./components/**/*.{js,ts,jsx,tsx}","./helpers/**/*.{js,ts,jsx,tsx}","./app/**/*.{js,ts,jsx,tsx}","./data/**/*.{js,ts,jsx,tsx}"],theme:{container:{center:!0,padding:"2rem",screens:{"2xl":"1400px"}},extend:{fontFamily:{sans:["var(--inter-font)",...i().fontFamily.sans]},keyframes:{ping:{"0%":{opacity:"100"},"75%, 100%":{transform:"scale(2)",opacity:"0"}},"accordion-down":{from:{height:"0"},to:{height:"var(--radix-accordion-content-height)"}},"accordion-up":{from:{height:"var(--radix-accordion-content-height)"},to:{height:"0"}}},animation:{"spin-fast":"spin 0.5s linear infinite","accordion-down":"accordion-down 0.2s ease-out","accordion-up":"accordion-up 0.2s ease-out"},colors:{brand:{50:"#f2ffe1",100:"#deffcc",200:"#bdff99",300:"#9cff66",400:"#7bff33",500:"#5aff00",600:"#48cc00",700:"#369900",800:"#246600",900:"#123300"},border:"hsl(var(--border))",input:"hsl(var(--input))",ring:"hsl(var(--ring))",background:"hsl(var(--background))",foreground:"hsl(var(--foreground))",primary:{DEFAULT:"hsl(var(--brand-400) / 50%)",foreground:"hsl(var(--white))"},secondary:{DEFAULT:"hsl(var(--secondary))",foreground:"hsl(var(--white))"},destructive:{DEFAULT:"hsl(var(--red-400))",foreground:"hsl(var(--black))"},muted:{DEFAULT:"hsl(var(--muted))",foreground:"hsl(var(--muted-foreground))"},accent:{DEFAULT:"hsl(var(--accent))",foreground:"hsl(var(--white))"},popover:{DEFAULT:"hsl(var(--popover))",foreground:"hsl(var(--popover-foreground))"},card:{DEFAULT:"hsl(var(--card))",foreground:"hsl(var(--card-foreground))"}},borderRadius:{lg:"var(--radius)",md:"calc(var(--radius) - 2px)",sm:"calc(var(--radius) - 4px)"},fontSize:{"2xs":"0.6rem",s:"0.8125rem"},containers:{"2xs":"340px","screen-sm":"640px","screen-md":"768px","screen-lg":"1024px","screen-xl":"1280px","screen-2xl":"1536px"}}},plugins:[r(98750),r(61123),r(83980),r(87224)({nocompatible:!0}),function(e){let{addBase:t,theme:r}=e;t({":root":Object.fromEntries(Object.entries((0,s.default)(r("colors"))).map(e=>{let[t,r]=e,n=u().hex.hsl(r);return["--".concat(t),r.startsWith("#")?"".concat(n[0]," ").concat(n[1],"% ").concat(n[2],"%"):r]}))})},function(e){let{matchUtilities:t,theme:r}=e;t({"bg-grid":e=>({backgroundImage:'url("'.concat(d()('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32" fill="none" stroke="'.concat(e,'"><path d="M0 .5H31.5V32"/></svg>')),'")')}),"bg-grid-small":e=>({backgroundImage:'url("'.concat(d()('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="8" height="8" fill="none" stroke="'.concat(e,'"><path d="M0 .5H31.5V32"/></svg>')),'")')}),"bg-dot":e=>({backgroundImage:'url("'.concat(d()('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="16" height="16" fill="none"><circle fill="'.concat(e,'" id="pattern-circle" cx="10" cy="10" r="1.6257413380501518"></circle></svg>')),'")')})},{values:(0,s.default)(r("backgroundColor")),type:"color"})}]};let m=a()(p),f=m.theme.colors,h=Object.fromEntries(Object.keys(f).filter(e=>{let t=f[e];return null!=t&&"string"!=typeof t&&!("DEFAULT"in t)}).map(e=>[e,f[e]]))},13938:function(e,t,r){r.d(t,{AQ:function(){return o},G0:function(){return i}});var n,a,o,i,s=r(10158),l=r(23377),u=r(58905),c=r(62434),d=r(20295),p=r(55044),m=r(68131),f=r(24189),h=r(64772),g=r(85092),b=r(31533),y=r(48308),A=r(53692),x=r(73875),S=r(67864),w=r(71708),T=r(72366),v=r(8526),D=r(26478);let C=[100,200,400,800,1600,3200,6400,12800,25600,51200],createSignalBuffers=async e=>{let t=await (0,f.z)(e.pipe((0,S.P)(),(0,h.U)(e=>(0,x.Z)(e.data[0][0]).decimalPlaces(0,x.Z.ROUND_FLOOR).toNumber()))),r=new Date().getTime(),n=(0,u.x)(e,m.z).pipe((0,w.b)(e=>(0,u.x)((0,c.D)(e.data),m.z)),(0,h.U)(e=>{let[r,n,a,o]=e;return[(0,x.Z)(r).minus(t).shiftedBy(3),n,a,o]}),(0,g.B)()),a=n.pipe((0,T.e)(1e3),(0,h.U)(e=>e.length<1?1:Math.floor(e.length/e[e.length-1][0].minus(e[0][0]).shiftedBy(-3).toNumber())),(0,v.x)(),(0,g.B)()),o=n.pipe((0,w.b)(e=>{let t=new Date().getTime()-r,n=e[0].toNumber();return t<n?(0,u.x)((0,d.of)(e).pipe((0,D.g)(n-t)),m.z):(0,d.of)(e)}),(0,g.B)()),i=a.pipe((0,h.U)(e=>C.reduce((t,r)=>Math.abs(r-e)<Math.abs(t-e)?r:t,C[0])),(0,v.x)(),(0,g.B)());return{timeStamp:t,signal$:n,timeMappedSignal$:o,specSampleRate$:i,sampleRate$:a}};var E=r(98948),R=r(46126),N=r(73105);let L=0,getSensorEndpoint=e=>{switch(e.type){case"adxl345":return"adxl345/dump_adxl345";case"beacon":return"beacon/dump_accel";case"lis2dw":return"lis2dw/dump_lis2dw";default:throw Error("Sensor type not supported. Must be 'adxl345', 'beacon', or 'lis2dw'")}},isSuccessResponse=e=>null!=e&&"object"==typeof e&&!("error"in e),isKlipperAccelSubscriptionResponse=e=>R.NI.safeParse(e).success,isKlipperAccelSubscriptionData=e=>isSuccessResponse(e)&&null!=e.params&&"data"in e.params&&null!=e.params&&Array.isArray(e.params.data)&&Array.isArray(e.params.data[0])&&4===e.params.data[0].length,detrendFloatSignal=e=>{let t=e.reduce((e,t)=>e+t,0)/e.length;for(let r=0;r<e.length;r++)e[r]-=t;return e},detrendBatch=e=>{let t=detrendFloatSignal(e.map(e=>e[1])),r=detrendFloatSignal(e.map(e=>e[2])),n=detrendFloatSignal(e.map(e=>e[3]));return e.map((e,a)=>[e[0],t[a],r[a],n[a]])},createADXL345Stream=(e,t)=>{let r=(0,N.j)({url:e,deserializer:e=>{try{return JSON.parse(e.data,(e,t,r)=>"0"===e&&"number"==typeof t&&(null==r?void 0:r.source)!=null?(0,x.Z)(t):t)}catch(e){return(0,E.j)().error(e,"Error parsing JSON from klipper socket"),null}}}),n=r.multiplex(()=>({jsonrpc:"2.0",method:getSensorEndpoint(t),params:{sensor:t.name,response_template:{}},id:++L}),()=>null,e=>{if("result"in e&&isKlipperAccelSubscriptionResponse(e.result))return e.result.header,!1;if(isKlipperAccelSubscriptionData(e))return!0;if(!isSuccessResponse(e))throw(0,E.j)().error(e,"Error in response from adxl345 subscription on klipper socket"),Error("".concat(e.error.error,": ").concat(e.error.message));return!1}).pipe((0,g.B)(),(0,b.h)(e=>isKlipperAccelSubscriptionData(e)),(0,h.U)(e=>({...e.params,data:detrendBatch(e.params.data)})),(0,g.B)());return n.subscribe(),{dataStream$:n,close:()=>{r.complete.bind(r)()}}};(n=o||(o={})).START="START",n.STOP="STOP",n.START_ACCUMULATION="START_ACCUMULATION",n.STOP_ACCUMULATION="STOP_ACCUMULATION",(a=i||(i={})).STARTED="STARTED",a.STOPPED="STOPPED",a.ACCUMULATING="ACCUMULATING",a.ACCUMULATED="ACCUMULATED",a.SIGNAL="SIGNAL",a.PSD="PSD",a.RX_RATE="RX_RATE",a.SAMPLE_RATE="SAMPLE_RATE",a.SPEC_SAMPLE_RATE="SPEC_SAMPLE_RATE";let mapToWorkerOutput=e=>(0,h.U)(e),k=new l.x,z=(0,s.p)(()=>new Worker(r.tu(new URL(r.p+r.u(5330),r.b))),k).pipe((0,g.B)()),M=z.pipe((0,b.h)(e=>"psd"===e.type),mapToWorkerOutput(e=>({type:"PSD",payload:e.psd})),(0,g.B)());(0,s.YX)(class{work(e){return e.pipe((0,y.z)(e=>{switch(e.type){case"START":{if(null!=this.stream)throw Error("Stream already started");this.stream=createADXL345Stream(e.payload.url,e.payload.sensor);let setup=async()=>{if(null==this.stream)throw Error("Stream not initialized");this.signalProcessor=await createSignalBuffers(this.stream.dataStream$),this.signalProcessor.signal$.subscribe(e=>k.next({command:"sampleInput",payload:[e[0].toNumber(),e[1],e[2],e[3]]})),this.signalProcessor.specSampleRate$.subscribe(e=>k.next({command:"specSampleRateInput",payload:e}));let e=(0,u.x)((0,c.D)([(0,d.of)({type:"STARTED",payload:this.signalProcessor.timeStamp}),this.signalProcessor.timeMappedSignal$.pipe(mapToWorkerOutput(e=>{let t=new Float64Array([e[0].toNumber(),...e.slice(1)]);return{type:"SIGNAL",payload:t.buffer}})),this.signalProcessor.sampleRate$.pipe(mapToWorkerOutput(e=>({type:"SAMPLE_RATE",payload:e}))),this.signalProcessor.specSampleRate$.pipe(mapToWorkerOutput(e=>({type:"SPEC_SAMPLE_RATE",payload:e}))),this.psdSubscribed?p.E:M]),m.z).pipe((0,A.J)());return this.psdSubscribed||(this.psdSubscribed=!0),e};return(0,c.D)(setup()).pipe((0,A.J)())}case"STOP":return null!=this.stream&&(this.stream.close(),this.stream=null),(0,d.of)({type:"STOPPED"});case"START_ACCUMULATION":if(null==this.signalProcessor)throw Error("Stream not initialized");if(null==z)throw Error("PSD worker not initialized");return k.next({command:"accumulate",payload:!0}),(0,u.x)((0,c.D)([(0,d.of)({type:"ACCUMULATING"}),(0,u.x)((0,c.D)((0,f.z)(z.pipe((0,b.h)(e=>"accumulation_finished"===e.type)))).pipe(mapToWorkerOutput(e=>({type:"ACCUMULATED",payload:e.psd}))),m.z)]),m.z).pipe((0,A.J)());case"STOP_ACCUMULATION":if(null==z)throw Error("Stream not initialized");if(null==z)throw Error("PSD process not initialized");return k.next({command:"accumulate",payload:!1}),p.E;default:var t;throw null===(t=this.stream)||void 0===t||t.close(),this.stream=null,Error("Invalid command")}}))}selectTransferables(e){switch(e.type){case"SIGNAL":return[e.payload];case"PSD":case"ACCUMULATED":return[e.payload.x.estimates.buffer,e.payload.x.frequencies.buffer,e.payload.y.estimates.buffer,e.payload.y.frequencies.buffer,e.payload.z.estimates.buffer,e.payload.z.frequencies.buffer,e.payload.total.estimates.buffer,e.payload.total.frequencies.buffer];default:return[]}}constructor(){this.stream=null,this.signalProcessor=null,this.psdSubscribed=!1}})},315:function(e,t,r){r.d(t,{b:function(){return ChartTheme}});var n=r(68995);let ChartTheme=class ChartTheme extends n.SciChartJSDarkv2Theme{constructor(){super(),this.sciChartBackground="transparent",this.loadingAnimationBackground="transparent",this.axisBandsFill="#20212333",this.majorGridLineBrush="#AAAAAA37",this.minorGridLineBrush="#77777719",this.strokePalette=["#F48420","#AE408E","#209FD9","#264B93"],this.fillPalette=["#F4842077","#AE408E77","#209FD977","#264B9377"],this.isLightBackground=!1,this.loadingAnimationForeground="transparent"}}},29817:function(e,t,r){r.d(t,{Mg:function(){return isXyDataSeries},OH:function(){return g},QR:function(){return useADXLSignalChart},ZA:function(){return usePSDChart},as:function(){return h},ck:function(){return f},jh:function(){return isXyyDataSeries},to:function(){return getPSDTooltipLegendTemplate}});var n=r(68995),a=r(30742),o=r(315),i=r(48488),s=r.n(i),l=r(43955),u=r(39164);n.SciChartSurface.configure({wasmUrl:"/configure/scichart2d.wasm",dataUrl:"/configure/scichart2d.data"}),n.SciChartSurface.UseCommunityLicense();let c=new o.b,d="signal",p="history",m="amplitude",isXyyDataSeries=e=>e.type===n.EDataSeriesType.Xyy,isXyDataSeries=e=>e.type===n.EDataSeriesType.Xy,getAxisColorName=e=>{switch(e){case"x":return"yellow";case"y":return"sky";case"z":return"rose";default:return"brand"}},getAxisColor=e=>l.NI[getAxisColorName(e)];new n.NumberRange(-1e4,1e4);let useADXLSignalChart=e=>(0,a.Q8)(null,(0,u.useCallback)(t=>{let r=getAxisColor(e),a=new n.NumericAxis(t.webAssemblyContext2D,{id:d+e,autoRange:n.EAutoRange.Always,maxAutoTicks:128,drawLabels:!1,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,drawMinorGridLines:!1,drawMajorGridLines:!1});t.xAxes.add(a);let o=new n.NumericAxis(t.webAssemblyContext2D,{id:p+e,autoRange:n.EAutoRange.Always,drawLabels:!1,drawMinorGridLines:!1,drawMajorTickLines:!1});t.xAxes.add(o);let i=new n.NumericAxis(t.webAssemblyContext2D,{autoRange:n.EAutoRange.Never,visibleRange:new n.NumberRange(-5e3,5e3),drawLabels:!1,id:m+e,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,drawMinorGridLines:!1,drawMajorGridLines:!1,axisAlignment:n.EAxisAlignment.Left});t.yAxes.add(i);let s=new n.XyDataSeries(t.webAssemblyContext2D,{fifoCapacity:128,containsNaN:!1,isSorted:!0,dataSeriesName:e.toLocaleUpperCase(),dataIsSortedInX:!0,xValues:Array(128).fill(0).map((e,t)=>t),yValues:Array(128).fill(0)}),l=new n.FastLineRenderableSeries(t.webAssemblyContext2D,{xAxisId:d+e,yAxisId:m+e,stroke:r[400],strokeThickness:2,dataSeries:s,effect:new n.GlowEffect(t.webAssemblyContext2D,{intensity:1,range:1})});t.renderableSeries.add(l);let u=new n.XyDataSeries(t.webAssemblyContext2D,{fifoCapacity:25600,containsNaN:!1,isSorted:!0,dataSeriesName:e.toLocaleUpperCase()+" History",dataIsSortedInX:!0,xValues:Array(25600).fill(0).map((e,t)=>3.2*t),yValues:Array(25600).fill(0)}),c=new n.FastLineRenderableSeries(t.webAssemblyContext2D,{stroke:r[500]+"22",strokeThickness:1,opacity:.6,yAxisId:m+e,xAxisId:p+e,dataSeries:u});return t.renderableSeries.add(c),l.animation=new n.WaveAnimation({duration:500}),c.animation=new n.WaveAnimation({duration:500}),{signalData:s,signalSeries:l,historyData:u,historySeries:c,xAxis:a,xHistoryAxis:o,yAxis:i}},[e])),f="amplitude",h=new n.NumberRange(0,1500),g={surface:{theme:c,padding:n.Thickness.fromNumber(0)},xAxes:[{type:n.EAxisType.NumericAxis,options:{visibleRange:new n.NumberRange(0,200),labelStyle:{...s().style,fontSize:13,fontWeight:"600",padding:new n.Thickness(15,15,15,15)},labelPostfix:"Hz",drawMinorGridLines:!0,minorsPerMajor:10,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1}}],yAxes:[{type:n.EAxisType.NumericAxis,options:{id:f,axisAlignment:n.EAxisAlignment.Left,growBy:new n.NumberRange(0,.1),visibleRange:h,labelFormat:n.ENumericFormat.Exponential,labelStyle:{...s().style,fontSize:13,fontWeight:"600",padding:new n.Thickness(15,15,15,15)},autoRangeAnimation:{duration:140,animateInitialRanging:!1,animateSubsequentRanging:!0,easing:n.easing.inOutCubic},drawMinorGridLines:!0,drawMinorTickLines:!1,drawMajorTickLines:!1,drawMajorBands:!1,axisTitleStyle:{fontSize:10}}}]},b={...g,series:[{type:n.ESeriesType.MountainSeries,options:{id:"total",yAxisId:f,strokeThickness:3,fill:l.NI.brand[500]+"22",stroke:l.NI.brand[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,t)=>Math.floor(t/128*200)),yValues:Array(128).fill(0).map((e,t)=>0)}},{type:n.ESeriesType.LineSeries,options:{id:"z",yAxisId:f,strokeThickness:3,stroke:getAxisColor("z")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,t)=>Math.floor(t/128*200)),yValues:Array(128).fill(0).map((e,t)=>0)}},{type:n.ESeriesType.LineSeries,options:{id:"y",yAxisId:f,strokeThickness:3,stroke:getAxisColor("y")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,t)=>Math.floor(t/128*200)),yValues:Array(128).fill(0).map((e,t)=>0)}},{type:n.ESeriesType.LineSeries,options:{id:"x",yAxisId:f,strokeThickness:3,stroke:getAxisColor("x")[400]},xyData:{containsNaN:!1,isSorted:!0,xValues:Array(128).fill(0).map((e,t)=>Math.floor(t/128*200)),yValues:Array(128).fill(0).map((e,t)=>0)}}]},getPSDTooltipLegendTemplate=(e,t)=>{let r="",a=32,o=[];e.forEach((e,t)=>{let i=e.renderableSeries.rolloverModifierProps.tooltipColor;if(o.push("".concat(e.renderableSeries.rolloverModifierProps.tooltipTitle).concat(":"," ").concat((e.yValue/1e3).toFixed(2)," g^2/Hz @ ").concat(e.formattedXValue)),r+='<text x="'.concat(16,'" y="').concat(a,'" class="text-sm text-medium font-sans" fill="').concat(l.DN[i][400],'">\n		<tspan class="font-bold">').concat(e.renderableSeries.rolloverModifierProps.tooltipTitle,"</tspan>").concat(":"," ").concat((e.yValue/1e3).toFixed(2),' g<tspan y="').concat(a-4,'" class="sup">2</tspan><tspan y=').concat(a,">/Hz</tspan> @ ").concat(e.formattedXValue,"\n		</text>"),a+=20,e.dataSeriesType===n.EDataSeriesType.Xyy){let t=e.renderableSeries.rolloverModifierProps1.tooltipColor;o.push("".concat(e.renderableSeries.rolloverModifierProps1.tooltipTitle).concat(":"," ").concat((e.y1Value/1e3).toFixed(2)," g^2/Hz @ ").concat(e.formattedXValue)),r+='<text x="'.concat(16,'" y="').concat(a,'" class="text-sm text-medium font-sans" fill="').concat(l.DN[t][400],'">\n				<tspan class="font-bold">').concat(e.renderableSeries.rolloverModifierProps1.tooltipTitle,"</tspan>").concat(":"," ").concat((e.y1Value/1e3).toFixed(2),' g<tspan y="').concat(a-4,'" class="sup">2</tspan><tspan y=').concat(a,">/Hz</tspan> @ ").concat(e.formattedXValue,"\n			</text>"),a+=20,r+='<text x="'.concat(16,'" y="').concat(a,'" class="text-sm text-medium font-sans" fill="').concat(l.DN.zinc[400],'">\n				<tspan class="font-bold">Amplitude Difference</tspan>').concat(":"," ").concat(Math.abs((e.y1Value-e.yValue)/1e3).toFixed(2),' g<tspan y="').concat(a-4,'" class="sup">2</tspan><tspan y=').concat(a,">/Hz</tspan>\n			</text>"),a+=20}});let i=0===e.length?0:16+1.7*calcTooltipWidth(o.reduce(function(e,t){return t.length>e?t.length:e},0)),s=0===e.length?0:a;return'<svg width="'.concat(i,'" height="').concat(s,'">\n				<rect rx="8" ry="8" width="100%" height="100%" class="stroke-zinc-400/10 fill-zinc-900/70 stroke-1" />\n                ').concat(r,"\n            </svg>")},psdRolloverTooltipTemplate=(e,t,r)=>{let a="",o=r.tooltipProps,i=o.tooltipTitle,s=o.tooltipColor,u=l.NI[s][100],c=(0,n.parseColorToTArgb)(l.NI[s][400]),d=(0,n.parseColorToTArgb)(l.NI[s][600]),p=o.tooltipLabelX,m=o.tooltipLabelY,f=l.NI[s][900];c.opacity=Math.round(204),d.opacity=Math.round(51);let h=null!==(x=r.tooltipProps.tooltipDataTemplate)&&void 0!==x?x:r.tooltipProps.rolloverModifier.tooltipDataTemplate,g=h(t,i,p,m),b=null!==(S=o.width)&&void 0!==S?S:calcTooltipWidth(g.reduce(function(e,t){return t.length>e?t.length:e},0)),y=null!==(w=o.height)&&void 0!==w?w:calcTooltipHeight(g.length);r.updateSize(b,y),g.forEach(function(e,t){a+='<tspan x="8" dy="1.2em">'.concat(e,"</tspan>")});let A='<feGaussianBlur result="blurOut" in="offOut" stdDeviation="3" />';if(void 0!==f){var x,S,w,T=(0,n.parseColorToTArgb)(f);A='\n			<feColorMatrix result="matrixOut" in="offOut" type="matrix"\n				values="0 0 0 0 \n				'.concat(T.red/255,"\n				0 0 0 0\n				").concat(T.green/255,"\n				0 0 0 0\n				").concat(T.blue/255,"\n				0 0 0 \n				").concat(T.opacity/255,'\n				0 0" \n			/>\n			<feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="3" />')}return'\n		<svg class="scichart__rollover-tooltip transition-all" width="'.concat(b,'" height="').concat(y,'">\n			<defs>\n				<filter id="').concat(e,'" x="0" y="0" width="200%" height="200%">\n					<feOffset result="offOut" in="SourceAlpha" dx="3" dy="3" />\n						\n						').concat(A,'\n					<feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n				</filter>\n			</defs>\n			<rect rx="8" ry="8" width="100%" height="100%" fill="').concat((0,n.parseTArgbToHtmlColor)(d),'" stroke="').concat((0,n.parseTArgbToHtmlColor)(c),'" stroke-width="2"  filter="url(#').concat(e,'" />\n			<svg width="100%">\n				<text x="8" y="3" class="text-sm font-sans font-semibold" dy="0" fill="').concat(u,'">\n				').concat(a,"\n				</text>\n			</svg>\n		</svg>")},usePSDChart=()=>(0,a.Q8)(b,(0,u.useCallback)(e=>{let t=new n.XyDataSeries(e.webAssemblyContext2D,{id:"xAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(t);let r=new n.XyDataSeries(e.webAssemblyContext2D,{id:"yAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(r);let a=new n.XyDataSeries(e.webAssemblyContext2D,{id:"zAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});e.addDeletable(a);let o=new n.XyDataSeries(e.webAssemblyContext2D,{id:"totalAnimationSeries",containsNaN:!1,isSorted:!0,dataIsSortedInX:!0});return e.addDeletable(o),e.renderableSeries.asArray().forEach(e=>{e.rolloverModifierProps.tooltipColor=getAxisColorName(e.id),e.rolloverModifierProps.tooltipTemplate=psdRolloverTooltipTemplate,e.rolloverModifierProps.tooltipTitle=e.id.substring(0,1).toUpperCase()+e.id.substring(1)+" Power Spectral Density",e.animation=new n.WaveAnimation({duration:500})}),e.chartModifiers.add(new n.CursorModifier({crosshairStroke:l.NI.sky[400],crosshairStrokeThickness:1,showXLine:!0,showYLine:!0,showTooltip:!1,tooltipLegendTemplate:getPSDTooltipLegendTemplate,tooltipLegendOffsetX:16,tooltipLegendOffsetY:16,yAxisId:f,axisLabelFill:l.NI.zinc[900],axisLabelStroke:l.NI.zinc[100]})),{animationSeries:{x:t,y:r,z:a,total:o}}},[]));var calcTooltipWidth=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e*t+20},calcTooltipHeight=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return t*e+16}},30742:function(e,t,r){r.d(t,{Q8:function(){return useChart},Tv:function(){return useDynamicAxisRange},ck:function(){return useWorker}});var n=r(72612),a=r(39164),o=r(68995),i=r(315),s=r(63278),l=r(8832),u=r(18954),c=r(96588),d=r(32342),p=r(80461),m=r(13938),f=r(10158),h=r(23377),g=r(85092),b=r(31533),y=r(64772),A=r(76877),x=r(72531),S=r(24189),w=r(54957),T=r(81446);function transformPSD(e){let t={frequencies:Array.from(e.frequencies),estimates:Array.from(e.estimates),powerRange:e.powerRange};return t}let getWsURL=()=>{let e=(0,T.X)();return null==e||""==e.trim()?null:"ws://".concat(e,":7125/klippysocket")},v=new h.x,D=(0,f.p)(()=>new Worker(r.tu(new URL(r.p+r.u(3938),r.b))),v).pipe((0,g.B)()),C=D.pipe((0,b.h)(e=>e.type===m.G0.SIGNAL),(0,y.U)(e=>new Float64Array(e.payload)),(0,A.f)((0,x.R)()),(0,b.h)(e=>e.length>0),(0,y.U)(e=>{let t=new Float64Array(e.length),r=new Float64Array(e.length),n=new Float64Array(e.length),a=new Float64Array(e.length);return e.forEach((e,o)=>{t[o]=e[0],r[o]=e[1],n[o]=e[2],a[o]=e[3]}),[t,r,n,a]}),(0,g.B)()),E=D.pipe((0,b.h)(e=>e.type===m.G0.PSD),(0,y.U)(e=>e.payload),(0,g.B)()),useWorker=(e,t,r,n,o)=>{let i=useAccelerometerWithType(t),[s,l]=(0,a.useState)(getWsURL()),u=(0,a.useRef)(!1),c=(0,a.useRef)(!1),d=(0,a.useRef)(r);d.current=r;let p=(0,a.useRef)(n);p.current=n;let f=(0,a.useCallback)(async()=>{if(c.current)throw Error("Already accumulating");let e=(0,S.z)(D.pipe((0,b.h)(e=>e.type===m.G0.PSD),(0,w.V)(5e3))),t=(0,S.z)(D.pipe((0,b.h)(e=>e.type===m.G0.ACCUMULATING),(0,y.U)(()=>!0),(0,w.V)(5e3)));await e,v.next({type:m.AQ.START_ACCUMULATION}),await t},[]),h=(0,a.useCallback)(async()=>{if(!c.current)throw Error("Not accumulating, cannot stop");let e=(0,S.z)(D.pipe((0,b.h)(e=>e.type===m.G0.ACCUMULATED),(0,y.U)(e=>({x:transformPSD(e.payload.x),y:transformPSD(e.payload.y),z:transformPSD(e.payload.z),total:transformPSD(e.payload.total)})),(0,w.V)(6e4)));return v.next({type:m.AQ.STOP_ACCUMULATION}),await e},[]),g=(0,a.useCallback)(async()=>{if(await new Promise(e=>setTimeout(e,10)),u.current)return;let e=(0,S.z)(D.pipe((0,b.h)(e=>e.type===m.G0.STARTED),(0,w.V)(5e3)));await e},[]);return(0,a.useEffect)(()=>{l(getWsURL())},[]),(0,a.useEffect)(()=>{let e=C.subscribe(e=>{d.current(e)}),t=E.subscribe(e=>{p.current(e)});return()=>{e.unsubscribe(),t.unsubscribe()}},[]),(0,a.useEffect)(()=>{if(e&&null!=s){let e=D.subscribe({next:e=>{switch(e.type){case m.G0.STARTED:u.current=!0;break;case m.G0.STOPPED:u.current=!1;break;case m.G0.ACCUMULATING:c.current=!0;break;case m.G0.ACCUMULATED:c.current=!1;case m.G0.SAMPLE_RATE:case m.G0.SPEC_SAMPLE_RATE:}},error:o});return v.next({type:m.AQ.START,payload:{url:s,sensor:i}}),()=>{u.current=!1,v.next({type:m.AQ.STOP}),e.unsubscribe()}}},[e,o,i,t,s]),{streamStarted:g,startAccumulation:f,stopAccumulation:h}},useAccelerometerWithType=e=>{let t=(0,c.sJ)(d.OS),r=(0,p.YC)(),n="adxl345";if("controlboard"===e&&((null==t?void 0:t.ADXL345SPI)!=null&&(n="adxl345"),(null==t?void 0:t.LIS2DW)!=null&&(n="lis2dw")),"toolboard_t0"===e||"toolboard_t1"===e){var o;let t=null===(o=r.find(t=>t.getToolboardName()===e))||void 0===o?void 0:o.getToolboard();if(null==t)throw Error("No toolboard found for T0");null!=t.ADXL345SPI&&(n="adxl345"),null!=t.LIS2DW&&(n="lis2dw")}return"beacon"===e&&(n="beacon"),(0,a.useMemo)(()=>u.U9.parse({name:e,type:n}),[e,n])},R=new i.b,useChart=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=(0,a.useRef)(null),[u,c]=(0,a.useState)(!1),d=(0,a.useRef)(null);return(0,a.useMemo)(()=>({forwardProps:{initChart:async n=>{let a=null;if(null!=e){var s,l,u,c,p;let t=null===(s=e.surface)||void 0===s?void 0:s.padding,i={...e,surface:{...e.surface,padding:new o.Thickness(null!==(l=null==t?void 0:t.top)&&void 0!==l?l:0,null!==(u=null==t?void 0:t.right)&&void 0!==u?u:0,null!==(c=null==t?void 0:t.bottom)&&void 0!==c?c:0,(null!==(p=null==t?void 0:t.left)&&void 0!==p?p:0)+(r?300:0))}};a=await (0,o.build2DChart)(n,i)}else a=await o.SciChartSurface.createSingle(n,{theme:R,padding:new o.Thickness(0,0,0,r?300:0)});return a.sciChartSurface.watermarkPosition=o.EWatermarkPosition.BottomLeft,a.sciChartSurface.watermarkRelativeToCanvas=!0,i.current=a.sciChartSurface,t&&(d.current=t(a.sciChartSurface)),{sciChartSurface:a.sciChartSurface}},onInit:()=>c(!0),style:{marginLeft:r?-300:0},fallback:(0,n.jsx)(l.I,{className:(0,s.dV)(r&&"ml-[150px]","bg-zinc-900")})},surface:i,isInitialized:u,data:d}),[r,u,e,t])},maximumRangeUnion=e=>Array.isArray(e)?e.reduce((e,t)=>{if(null==t)return e;let r=t.getMaximumRange();return e.union(r)},new o.NumberRange):e.getMaximumRange(),visibleRangeUnion=e=>Array.isArray(e)?e.reduce((e,t)=>{if(null==t)return e;let r=t.visibleRange;return e.union(r)},new o.NumberRange):e.visibleRange,growByUnion=e=>Array.isArray(e)?e.reduce((e,t)=>{var r;if(null==t)return e;let n=null!==(r=t.growBy)&&void 0!==r?r:new o.NumberRange;return e.union(n)},new o.NumberRange):e.growBy;function useDynamicAxisRange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.NumberRange(0,0),r=arguments.length>2?arguments[2]:void 0,n=(0,a.useRef)(e?maximumRangeUnion(e):null),i=(0,a.useRef)(new Date().getTime()),s=(0,a.useRef)(new Date().getTime()),l=(0,a.useCallback)(function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;if(null==e)return;let l=Array.isArray(e)?e:[e];null==n.current&&(n.current=visibleRangeUnion(e));let u=new Date().getTime()-i.current,c=new Date().getTime()-s.current;i.current=new Date().getTime();let d=maximumRangeUnion(e);a&&(d=d.union(a));let p=growByUnion(e);p&&d.growBy(p);let m=null,f=null;if(d.max>n.current.max&&(m=d.max),d.min<n.current.min&&(f=d.min),(null!=m||null!=f)&&c>u){let e=Math.min(null!=f?f:n.current.min,t.min),a=Math.max(null!=m?m:n.current.max,t.max);(e!==n.current.min||a!==n.current.max)&&(n.current=new o.NumberRange(e,a),l.forEach(t=>{if(null==n.current||null==t)return;let i=new o.NumberRange(e,a);t.animateVisibleRange(i,null!=r?r:u,o.easing.inOutQuad)}),s.current=new Date().getTime())}if(c>3e3){d.max<n.current.max&&(m=n.current.max-(n.current.max-d.max)),d.min>n.current.min&&(f=n.current.min+(d.min-n.current.min));let e=Math.min(null!=f?f:n.current.min,t.min),r=Math.max(null!=m?m:n.current.max,t.max);if(r!=n.current.max||e!=n.current.min){l.forEach(t=>{if(null==n.current||null==t)return;let a=new o.NumberRange(e,r);t.animateVisibleRange(a,c/2,o.easing.inOutQuad)}),n.current=new o.NumberRange(e,r),s.current=new Date().getTime();return}}},[r,e,t]);return l}},61946:function(e,t,r){r.d(t,{Jt:function(){return a},uo:function(){return xEndstopOptions}});var n=r(1314);let xEndstopOptions=(e,t)=>{let r=[];if((null==t?void 0:t.toolboard)!=null&&r.push({id:"endstop-toolboard",title:"Physical Endstop",badge:[{color:"sky",children:"".concat(t.toolboard.name).concat(null!=t.toolNumber&&" T".concat(t.toolNumber))}]}),(null==t?void 0:t.axis)===n.po.x){var a,o,i,s;r.push({id:"endstop",title:"Physical Endstop",badge:[{color:"purple",children:null!==(i=null==e?void 0:null===(a=e.controlboard)||void 0===a?void 0:a.name)&&void 0!==i?i:"Control Board"}]}),r.push({id:"sensorless",title:"Sensorless Homing",badge:[{color:"purple",children:null!==(s=null==e?void 0:null===(o=e.controlboard)||void 0===o?void 0:o.name)&&void 0!==s?s:"Control Board"}]})}return r},a={id:"endstop",title:"Physical Endstop",badge:[{color:"purple",children:"Control Board"}]}},80461:function(e,t,r){r.d(t,{YC:function(){return useToolheads},yk:function(){return useToolheadConfiguration}});var n=r(11974),a=r(21264),o=r(96588),i=r(39164),s=r(32342),l=r(65667),u=r(22595),c=r(61946),d=r(4840);let useToolheads=()=>{let e=(0,o.sJ)(l.$T),t=(0,i.useMemo)(()=>null==e?void 0:e.filter(Boolean).map(e=>new n.D(e)),[e]);return t},useToolheadConfiguration=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=(0,o.sJ)(l.wm),p=(0,i.useRef)(r);p.current!==r&&r.length>0&&(p.current=r.slice());let m=(0,i.useMemo)(()=>{var r;let a=null===(r=p.current)||void 0===r?void 0:r.filter(Boolean).map(e=>new n.D(e)),o=null==a?void 0:a.find(t=>t.getTool()===e||t.getMotionAxis()===e||t.getExtruderAxis()===e);if(null==o&&t)throw Error("Toolhead with number or axis ".concat(e," not found"));return null!=o?o:null},[t,e,p.current]),[f,h]=(0,i.useState)(!1),g=(0,o._8)(e=>{let{set:t,snapshot:r}=e;return async e=>{var o,i,p,m;let g=new n.D(e),b=await r.getPromise((0,l.AF)(g.getTool()));if(null==b)throw Error("Toolhead ".concat(g.getToolCommand()," not found"));let y=new n.D(b);if(e.extruder.id!=y.getExtruder().id&&null!=e.extruder.stepper){let r=(0,a.WZ)(e.extruder.stepper);null!=r&&t((0,s.ew)(g.getExtruderAxis()),t=>{var n;return null==t?null:{...t,stepper:r.id,current:null!==(n=e.extruder.current)&&void 0!==n?n:.71*r.maxPeakCurrent}})}if((null===(o=e.toolboard)||void 0===o?void 0:o.id)!==(null===(i=y.getToolboard())||void 0===i?void 0:i.id)){if(null==e.toolboard&&"endstop-toolboard"===e.xEndstop.id&&(e.xEndstop=c.Jt),null===(p=e.partFan)||void 0===p?void 0:p.id.endsWith("-toolboard")){let t=(0,d.gL)(null,e).shift();if(null==t)throw Error("No part fan options available for current T".concat(e.toolNumber," configuration"));e.partFan=t}if(null===(m=e.hotendFan)||void 0===m?void 0:m.id.endsWith("-toolboard")){let t=(0,d.Yo)(null,e).shift();if(null==t)throw Error("No hotend fan options available for current T".concat(e.toolNumber," configuration"));e.hotendFan=t}}e.thermistor!==y.getThermistor()&&e.thermistor!==e.hotend.thermistor?h(!0):e.hotend.id==y.getHotend().id||f||(e.thermistor=e.hotend.thermistor);let A=u.PY.extend({toolNumber:u.Qr}).nullable().safeParse({...e,toolNumber:y.getTool()});return A.success&&t((0,l.AF)(y.getTool()),A.data),A}},[f]);return{toolhead:m,setToolhead:g}}},46126:function(e,t,r){r.d(t,{NI:function(){return i},Xz:function(){return g}});var n=r(94594),a=r(18954);let o=n.z.union([n.z.literal("time"),n.z.literal("x_acceleration"),n.z.literal("y_acceleration"),n.z.literal("z_acceleration")]),i=n.z.object({header:n.z.tuple([o,o,o,o])});n.z.object({data:n.z.array(n.z.tuple([n.z.number(),n.z.number(),n.z.number(),n.z.number()])),overflows:n.z.number().optional(),errors:n.z.number().optional()});let s=n.z.object({frequencies:n.z.array(n.z.number()),estimates:n.z.array(n.z.number()),powerRange:n.z.object({max:n.z.number(),min:n.z.number()})}),l=n.z.object({x:s,y:s,z:s,total:s}),u=n.z.string().brand("MacroID"),c=n.z.string().brand("MacroSequenceID"),d=n.z.string().brand("MacroRecordingID"),p=n.z.string().brand("MacroRecordingRunID"),m=n.z.object({capturePSD:n.z.boolean().default(!1),accelerometer:a.Yx.optional(),color:n.z.string().optional()}).superRefine((e,t)=>(e.capturePSD&&null==e.accelerometer&&t.addIssue({code:n.z.ZodIssueCode.custom,message:"Required when recording resonance data",path:["accelerometer"]}),e));n.z.object({id:d,macroRecordingRunId:p,macroId:u,sequenceId:c,startTimeStamp:n.z.number(),endTimeStamp:n.z.number(),accelerometer:a.Yx,recordingHardwareName:n.z.string(),psd:l,name:n.z.string()});let f=n.z.object({id:c,name:n.z.string(),recording:m.nullable(),gcode:n.z.string().min(2)}),h=n.z.object({id:u,name:n.z.string(),description:n.z.string(),createdAtTimeStamp:n.z.number(),updatedAtTimeStamp:n.z.number().nullable(),recordingCount:n.z.record(c,n.z.number()),sequences:n.z.array(f)}),g=h.omit({recordingCount:!0,createdAtTimeStamp:!0,updatedAtTimeStamp:!0})}}]);
//# sourceMappingURL=9817-60a9dd93be2553d8.js.map